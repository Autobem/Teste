"use strict";(self.webpackChunkBemMais2=self.webpackChunkBemMais2||[]).push([[8935],{701:(pe,oe,r)=>{r.d(oe,{e:()=>i});var o=r(1135),h=r(5598),s=r(5e3);let i=(()=>{class l{constructor(){this.servicePanelData$=new o.X(null)}prepareItemToSaveInForm(g,C){const m=new Array,v=new Array;null==g||g.forEach(M=>{var e,c;(null==M?void 0:M.isEquipment)||(null===(e=null==M?void 0:M.products)||void 0===e||e.forEach(b=>{var A;this.removeUnnecessaryProductProperties(b),M.products=null===(A=null==M?void 0:M.products)||void 0===A?void 0:A.filter(q=>null==q?void 0:q.isActivated),(null==b?void 0:b.isActivated)&&(null==m||m.push(b))}),null==m||m.map(b=>{var A;null==b||delete b.isActivated,null===(A=null==b?void 0:b.questions)||void 0===A||A.map(q=>null==q||delete q.question)}),C.form.patchValue({products:m})),(null==M?void 0:M.isEquipment)&&(this.customAndFeedEquipmentsReceived(M),this.removeUnnecessaryEquipmentProperties(M),M.products=null===(c=null==M?void 0:M.products)||void 0===c?void 0:c.filter(b=>null==b?void 0:b.isActivated),null==v||v.push(M),null==v||v.map(b=>{var A;null==b||delete b.isEquipment,null===(A=null==b?void 0:b.products)||void 0===A||A.map(q=>{var z;null==q||delete q.isActivated,null===(z=null==q?void 0:q.questions)||void 0===z||z.map(X=>{null==X||delete X.question})})}),C.form.patchValue({equipments:v}))})}specifItemPreparationToSave(g,C){const m=new Array,v=new Array;null==g||g.forEach(M=>{var e,c;(null==M?void 0:M.isEquipment)||(null===(e=null==M?void 0:M.products)||void 0===e||e.forEach(b=>{var A;this.removeUnnecessaryProductProperties(b),M.products=null===(A=null==M?void 0:M.products)||void 0===A?void 0:A.filter(q=>null==q?void 0:q.isActivated),(null==b?void 0:b.isActivated)&&(null==m||m.push(b))}),null==m||m.map(b=>{var A;null==b||delete b.isActivated,null===(A=null==b?void 0:b.questions)||void 0===A||A.map(q=>null==q||delete q.question)}),C.products=m),(null==M?void 0:M.isEquipment)&&(this.customAndFeedEquipmentsReceived(M),this.removeUnnecessaryEquipmentProperties(M),M.products=null===(c=null==M?void 0:M.products)||void 0===c?void 0:c.filter(b=>null==b?void 0:b.isActivated),null==v||v.push(M),null==v||v.map(b=>{var A;null==b||delete b.isEquipment,null===(A=null==b?void 0:b.products)||void 0===A||A.map(q=>{var z;null==q||delete q.isActivated,null===(z=null==q?void 0:q.questions)||void 0===z||z.map(X=>{null==X||delete X.question})})}),C.equipments=v)})}removeUnnecessaryProductProperties(g){return"ItemSelect"===(null==g?void 0:g.selectorType)&&(null==g||delete g.value,null==g||delete g.items),null==g||delete g.description,null==g||delete g.displayName,null==g||delete g.maximumValue,null==g||delete g.minimalValue,null==g||delete g.selectorType,g}customAndFeedEquipmentsReceived(g){var C,m,v,M,e,c,b,A,q,z,X;return g.description=null===(C=null==g?void 0:g.item)||void 0===C?void 0:C.description,g.justFound=null===(m=null==g?void 0:g.item)||void 0===m?void 0:m.justFound,g.type=null===(v=null==g?void 0:g.item)||void 0===v?void 0:v.type,g.id=(null===(M=null==g?void 0:g.item)||void 0===M?void 0:M.id)||null,g.operation=g.item.id&&!g.item.justFound?h.B.Update:h.B.Add,g.equipmentTypeId=(null===(c=null===(e=null==g?void 0:g.item)||void 0===e?void 0:e.type)||void 0===c?void 0:c.id)||(null===(b=null==g?void 0:g.item)||void 0===b?void 0:b.equipmentTypeId)||(null===(A=null==g?void 0:g.type)||void 0===A?void 0:A.id),g.serialNumber=null===(q=null==g?void 0:g.item)||void 0===q?void 0:q.serialNumber,g.equipmentId=null===(z=null==g?void 0:g.item)||void 0===z?void 0:z.equipmentId,g.declaredValue=null===(X=null==g?void 0:g.item)||void 0===X?void 0:X.declaredValue,g}removeUnnecessaryEquipmentProperties(g){var C;return null==g||delete g.label,null==g||delete g.index,null==g||delete g.selectedServicePlan,null==g||delete g.servicePlans,null==g||delete g.item,null===(C=null==g?void 0:g.products)||void 0===C||C.forEach(m=>{"ItemSelect"===(null==m?void 0:m.selectorType)&&(null==m||delete m.value,null==m||delete m.items),null==m||delete m.description,null==m||delete m.displayName,null==m||delete m.maximumValue,null==m||delete m.minimalValue,null==m||delete m.selectorType}),g}}return l.\u0275fac=function(g){return new(g||l)},l.\u0275prov=s.Yz7({token:l,factory:l.\u0275fac,providedIn:"any"}),l})()},5764:(pe,oe,r)=>{r.d(oe,{f:()=>o});var o=(()=>{return(h=o||(o={})).Normal="Normal",h.Reduced="Reduzida",h.Aggravated="Agravada",o;var h})()},5598:(pe,oe,r)=>{r.d(oe,{B:()=>o,b:()=>h});var o=(()=>{return(s=o||(o={})).None="None",s.Add="Add",s.Remove="Remove",s.Update="Update",o;var s})();class h{constructor(i){if(this.productValue=null,this.activated=!1,"ValueSelect"===i.selectorType)try{this.productValue=i.minimalValue}catch(l){throw new Error(`Produto do tipo ValueSelect sem valor m\xednimo definido: ${i.displayName}`)}if("ItemSelect"===i.selectorType)try{this.productValue=i.items[0].id||""}catch(l){throw new Error(`Produto do tipo ItemSelect sem items selecion\xe1veis: ${i.displayName}`)}}}},8004:(pe,oe,r)=>{r.d(oe,{P:()=>Q});var o=r(8663),h=r(5e3),s=r(8306),i=r(1135),l=r(7579),F=r(5698),g=r(8746),C=r(8505),m=r(829),v=r(9093),M=r(312),e=r(6539),c=r(4521),b=r(8966),A=r(3047),q=r(7751),z=r(9808),X=r(3e3);function Y(j,N){1&j&&(h.TgZ(0,"div",12)(1,"span",13),h._uU(2,"Loading..."),h.qZA()())}function D(j,N){if(1&j){const V=h.EpF();h.TgZ(0,"div")(1,"div",14)(2,"div",15),h._uU(3,"Question\xe1rio"),h.qZA(),h.TgZ(4,"div",16),h.NdJ("click",function(){return h.CHM(V),h.oxw(2).openSurvey()}),h._UZ(5,"i",17),h.qZA()()()}}function L(j,N){if(1&j){const V=h.EpF();h.ynx(0),h.TgZ(1,"div",1)(2,"span",2),h._uU(3," Cadastrar bens "),h.qZA(),h.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"app-assets-table",6),h.NdJ("onPaginator",function(S){return h.CHM(V),h.oxw().paginator=S})("loadAssetsTable$",function(S){return h.CHM(V),h.oxw().loadAssetsTable(S)})("openAssetsPanel",function(S){return h.CHM(V),h.oxw().openAssetsPanel(S)})("openServicesPanel",function(S){return h.CHM(V),h.oxw().openServicesPanel(S)})("deleteMultipleAssets",function(S){return h.CHM(V),h.oxw().deleteMultipleAssets(S)}),h.qZA()(),h._UZ(8,"div"),h.YNc(9,Y,3,0,"ng-template",null,7,h.W1O),h.qZA()(),h.YNc(11,D,6,0,"div",0),h.TgZ(12,"div",8)(13,"button",9),h.NdJ("click",function(){return h.CHM(V),h.oxw().onAction({direction:"back"})}),h._uU(14,"Voltar"),h.qZA(),h.TgZ(15,"button",10),h.NdJ("click",function(){return h.CHM(V),h.oxw().onAction({direction:"forward"})}),h._uU(16,"Pr\xf3ximo"),h.qZA()()(),h._UZ(17,"div",null,11),h.BQk()}if(2&j){const V=h.oxw();h.xp6(7),h.Q6J("spinner",V.spinner$)("assetsSet",V.assetsTableBS$)("quotationId",V.quotationId),h.xp6(4),h.Q6J("ngIf",!V.isQuotation)}}let Q=(()=>{class j{constructor(V,y,S,U){this.route=V,this.dialog=y,this.quotationService=S,this.modalService=U,this.statics$=new s.y,this.assets$=new s.y,this.spinner$=new i.X(!1),this.static$=new s.y,this.showStep=!1,this.isQuotation=!0,this.loadAssetsTable$=new l.x,this.stepAction=new h.vpe,this.loadAssetsTable=R=>this.loadAssetsTable$.next(R)}set _showStep(V){var y;this.showStep=V,V&&(this.spinner$.next(!0),this.quotationId=null===(y=this.route.parent)||void 0===y?void 0:y.snapshot.paramMap.get("id"),this.quotationService.getProponent(this.quotationId).pipe((0,F.q)(1),(0,g.x)(()=>this.spinner$.next(!1))).subscribe(S=>{this.proponent=S}),this.loadAssetsTable$.next({skip:0,take:10}),this.statics$=this.quotationService.getQuotationStatics().pipe((0,F.q)(1),(0,C.b)(S=>this._statics=S)))}ngOnInit(){}onAction(V){this.stepAction.emit(V)}openAssetsPanel(V){this.dialog.open(m.i,{height:"100vh",width:"100vw",maxWidth:"none",data:{asset:V,quotationId:this.quotationId,isQuotation:this.isQuotation},closeOnNavigation:!1,disableClose:!0}).afterClosed().subscribe(y=>{var S;Boolean(y)&&((null===(S=this.paginator)||void 0===S?void 0:S.pageIndex)&&(this.paginator.pageIndex=0),this.loadAssetsTable$.next({skip:0,take:10}),V?(this.spinner$.next(!0),this.editAsset(y)):(this.spinner$.next(!0),this.saveAsset(y)))})}openServicesPanel(V){!this.dialog.openDialogs.length&&this.dialog.open(v.k,{height:"100vh",width:"100vw",maxWidth:"none",data:{selectedAsset:V,quotationId:this.quotationId},closeOnNavigation:!1,disableClose:!0}).afterClosed().subscribe(y=>{var S;Boolean(y)&&((null===(S=this.paginator)||void 0===S?void 0:S.pageIndex)&&(this.paginator.pageIndex=0),this.spinner$.next(!0),this.editAsset(y))})}openSurvey(){this.dialog.open(e.v,{height:"100vh",width:"100vw",maxWidth:"none",disableClose:!0,closeOnNavigation:!0,data:{quotationId:this.quotationId,proponent:this.proponent}})}saveAsset({asset:V,category:y}){!V||!y||"auto"==y.toLowerCase()&&this.quotationService.saveVehicle(this.quotationId,V).pipe((0,F.q)(1)).subscribe(S=>{this.loadAssetsTable$.next({skip:0,take:10})})}editAsset({asset:V,category:y}){if(V&&y&&"auto"==y.toLowerCase()){const S=V.type===o.rQ.Aggregate?"updateAggregate":"updateVehicle";V.type===o.rQ.Aggregate&&delete Object.assign(V,{year:V.yearModel}).yearModel,this.quotationService[S](this.quotationId,V).pipe((0,F.q)(1)).subscribe(U=>{this.loadAssetsTable$.next({skip:0,take:10})})}}deleteMultipleAssets(V){var y;const S=this.modalService.open(M.z,{centered:!0});S.componentInstance.list=[`Deseja excluir os ${V.length} bens?`],S.componentInstance.title="Excluir",S.componentInstance.type="alert",S.componentInstance.confirmButtonText="Sim",S.componentInstance.cancelButtonText="N\xe3o",null===(y=S.closed)||void 0===y||y.subscribe(U=>{!0===U&&(this.spinner$.next(!0),V.forEach(R=>{this.quotationService.deleteAssets(this.quotationId,R.id,R.autoType).pipe((0,F.q)(1)).subscribe(()=>{this.paginator.pageIndex=0,this.loadAssetsTable$.next({skip:0,take:10})})}))})}}return j.\u0275fac=function(V){return new(V||j)(h.Y36(c.gz),h.Y36(b.uw),h.Y36(A.G),h.Y36(q.FF))},j.\u0275cmp=h.Xpm({type:j,selectors:[["app-assets-register"]],inputs:{_showStep:["showStep","_showStep"],assets:"assets",isQuotation:"isQuotation",assetsTableBS$:"assetsTableBS$"},outputs:{loadAssetsTable$:"loadAssetsTable$",stepAction:"stepAction"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wrapper","px-0"],[1,"content-title","mb-3"],[1,"card","table-card"],[1,"w-100","d-flex","align-items-center","justify-content-center"],[1,"w-100"],[3,"spinner","assetsSet","quotationId","onPaginator","loadAssetsTable$","openAssetsPanel","openServicesPanel","deleteMultipleAssets"],["loading",""],[1,"buttons"],[1,"btn","btn-outline-light-atb","btn-lg",3,"click"],[1,"btn","btn-primary","btn-lg",3,"click"],["toast",""],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"card","flex-row","p-4","survey-card","mt-4"],[1,"subtitle","bold-txt"],[1,"d-flex","align-items-center","pointer",3,"click"],[1,"fas","fa-chevron-right","ml-3"]],template:function(V,y){1&V&&h.YNc(0,L,19,4,"ng-container",0),2&V&&h.Q6J("ngIf",y.showStep)},directives:[z.O5,X.v],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.add-button[_ngcontent-%COMP%]{width:140px}.card[_ngcontent-%COMP%]{min-height:450px;align-items:center;justify-content:center}.no-assets-card[_ngcontent-%COMP%]{min-height:540px}.illustration-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;flex-direction:column}.buttons[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:space-between}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:156px}.survey-card[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;min-height:120px}.survey-card[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:pointer}@media screen and (max-width: 768px){.illustration[_ngcontent-%COMP%]{width:220px}}@media screen and (max-height: 850px){.no-assets-card[_ngcontent-%COMP%]{min-height:420px}.no-assets-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:150px}}"]}),j})()},2071:(pe,oe,r)=>{r.d(oe,{E:()=>F});var o=r(7258),h=r(5e3),s=r(4521),i=r(9808);function l(g,C){if(1&g){const m=h.EpF();h.ynx(0),h.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),h._uU(5),h.qZA(),h.TgZ(6,"h5"),h._uU(7,"Caso queira reenviar ou enviar pessoalmente segue as op\xe7\xf5es:"),h.qZA()(),h.TgZ(8,"div",4)(9,"button",5),h.NdJ("click",function(){return h.CHM(m),h.oxw().download()}),h._uU(10),h.qZA(),h.TgZ(11,"button",5),h.NdJ("click",function(){return h.CHM(m),h.oxw().sendEmail()}),h._uU(12," Reenviar via Email "),h.qZA(),h.TgZ(13,"button",5),h.NdJ("click",function(){return h.CHM(m),h.oxw().viewProposal()}),h._uU(14," Visualizar proposta "),h.qZA()()(),h.TgZ(15,"div",6),h._UZ(16,"img",7),h.qZA()(),h.TgZ(17,"div",8)(18,"button",9),h.NdJ("click",function(){return h.CHM(m),h.oxw().action()}),h._uU(19),h.qZA()(),h.BQk()}if(2&g){const m=h.oxw();h.xp6(5),h.Oqu(m.isProposal?"Pronto! A proposta foi gerada.":"Pronto! Cota\xe7\xe3o realizada e enviada."),h.xp6(5),h.hij(" Baixar ",m.isProposal?"proposta":"cota\xe7\xe3o"," "),h.xp6(9),h.hij(" ",m.isProposal?"Abrir vistoria":"Concluir"," ")}}let F=(()=>{class g{constructor(m,v,M){var e;this.route=m,this.router=v,this.quotationHelper=M,this.isProposal=!1,this.showStep=!1,this.id=null===(e=this.route.parent)||void 0===e?void 0:e.snapshot.paramMap.get("id")}download(){this.quotationHelper.downloadProposalPdf(this.id).subscribe()}viewProposal(){this.quotationHelper.viewProposal(this.id).subscribe()}sendEmail(){this.quotationHelper.sendEmail(this.id).subscribe()}action(){this.isProposal?this.router.navigate(["app/comercial/vistorias/detalhes",this.id]):this.quotationHelper.officialize(this.id).subscribe()}}return g.\u0275fac=function(m){return new(m||g)(h.Y36(s.gz),h.Y36(s.F0),h.Y36(o.J))},g.\u0275cmp=h.Xpm({type:g,selectors:[["app-finalize-quotation"]],inputs:{isProposal:"isProposal",showStep:"showStep"},features:[h._Bn([o.J])],decls:1,vars:1,consts:[[4,"ngIf"],[1,"card","row","container","m-3","pt-5","pl-3",2,"height","600px"],[1,"col-7","quotation-info","mt-5"],[1,"text","mt-3"],[1,"actions","row","pl-4","mt-3"],["type","button",1,"btn","btn-outline-primary","m-2",3,"click"],[1,"image","col-5","mt-5"],["src","../../../../../../../assets/img/property.svg",2,"width","300px"],[1,"row","d-flex","justify-content-end",2,"max-width","1170px"],[1,"btn","btn-primary",2,"min-width","156px",3,"click"]],template:function(m,v){1&m&&h.YNc(0,l,20,3,"ng-container",0),2&m&&h.Q6J("ngIf",v.isProposal&&v.showStep||!v.isProposal)},directives:[i.O5],styles:[".text[_ngcontent-%COMP%]{color:#707a84;font-family:Roboto,Helvetica Neue,sans-serif;text-indent:15px}"]}),g})()},7335:(pe,oe,r)=>{r.d(oe,{S:()=>s});var o=r(7622),h=r(5e3);let s=(()=>{class i{}return i.\u0275fac=function(F){return new(F||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[o.m]]}),i})()},1170:(pe,oe,r)=>{r.d(oe,{s:()=>M});var o=r(9808),h=r(7622),s=r(2594),i=r(7751),l=r(3495),F=r(1424),g=r(2145),C=r(4036),m=r(4107),v=r(5e3);let M=(()=>{class e{}return e.\u0275fac=function(b){return new(b||e)},e.\u0275mod=v.oAB({type:e}),e.\u0275inj=v.cJS({imports:[[o.ez,h.m,s.n,i.ZS,i.lQ,l.U$,F.j,g.WN,m.LD,C.kW]]}),e})()},1660:(pe,oe,r)=>{r.d(oe,{e:()=>s});var o=r(9808),h=r(5e3);let s=(()=>{class i{}return i.\u0275fac=function(F){return new(F||i)},i.\u0275mod=h.oAB({type:i}),i.\u0275inj=h.cJS({imports:[[o.ez]]}),i})()},1772:(pe,oe,r)=>{r.d(oe,{N:()=>M});var o=r(1135),h=r(7579),s=r(6367),i=r(5e3),l=r(3047),F=r(9808),g=r(7751),C=r(6517),m=r(5214);function v(e,c){if(1&e){const b=i.EpF();i.TgZ(0,"a",14),i.NdJ("click",function(){const z=i.CHM(b).$implicit;return i.oxw().selectedAssetType=z}),i._uU(1),i.qZA()}if(2&e){const b=c.$implicit;i.xp6(1),i.Oqu(b)}}let M=(()=>{class e extends s.K{constructor(b,A){super(),this.quotationService=b,this.cp=A,this.categories=["Ve\xedculos","Implementos","Im\xf3veis"],this.selectedAssetType=this.categories[0],this.checkedRows=new Array,this.length=0,this.vehicleIcons$=new o.X(null),this.dataSource$=new o.X(null),this.allCalculationEvents=new Array,this.quotationId="",this.loadCalculateTable$=new h.x,this.refreshCalculateTable=new h.x,this.columns=[{displayName:"",columnName:"autoType",hasInnerHtml:!0,cell:({autoType:q})=>this.setIcon(q),className:"flex-3"},{displayName:"Identificador",columnName:"licensePlate",hasInnerHtml:!0,cell:({licensePlate:q,chassis:z})=>this.licenseOrChassis(q,z),className:"flex-15"},{displayName:"Descri\xe7\xe3o",columnName:"model",hasInnerHtml:!0,cell:({description:q})=>`<div class="mat-column-model">${q}</div>`},{displayName:"Participa\xe7\xe3o",columnName:"participation",hasInnerHtml:!0,cell:({assetId:q,participationValue:z})=>this.updateParticipationValue(q,z),className:"flex-15",customHeaderClass:"orange-header-cell"},{displayName:"Prote\xe7\xe3o",columnName:"protection",hasInnerHtml:!0,cell:({assetId:q,protectionValue:z})=>this.updateProtectionValue(q,z),className:"flex-15",customHeaderClass:"orange-header-cell"}],this.actions=[{iconClass:"",eventName:""}],this.emitRefresh=q=>this.loadCalculateTable$.next(q||{skip:0,take:10}),this.searchFinalization=q=>this.searchTableItem(q,this.quotationService,this.emitRefresh,"searchQuotationFinalization",this.dataSource$,"N\xe3o h\xe1 propostas criadas","Nenhuma proposta encontrada",[this.quotationId])}set calculateEvents(b){(null==b?void 0:b.finalized)&&(this.allCalculationEvents=null==b?void 0:b.allEvents,this.loadCalculateTable$.next({skip:0,take:10}))}set calculateTableBS$(b){null==b||b.subscribe(A=>this.dataSource$.next(A))}ngOnInit(){}updateProtectionValue(b,A){var q,z,X;const Y=null===(q=this.allCalculationEvents)||void 0===q?void 0:q.find(D=>D.AssetId==b);return this.darkerFont(Y?null===(z=this.cp.transform(Y.ProtectionValue,"BRL","symbol","1.2-2"))||void 0===z?void 0:z.toString():null===(X=this.cp.transform(A,"BRL","symbol","1.2-2"))||void 0===X?void 0:X.toString())}updateParticipationValue(b,A){var q,z,X;const Y=null===(q=this.allCalculationEvents)||void 0===q?void 0:q.find(D=>D.AssetId==b);return this.darkerFont(Y?null===(z=this.cp.transform(Y.ParticipationValue,"BRL","symbol","1.2-2"))||void 0===z?void 0:z.toString():null===(X=this.cp.transform(A,"BRL","symbol","1.2-2"))||void 0===X?void 0:X.toString())}}return e.\u0275fac=function(b){return new(b||e)(i.Y36(l.G),i.Y36(F.H9))},e.\u0275cmp=i.Xpm({type:e,selectors:[["app-calculate-table"]],inputs:{quotationId:"quotationId",calculateEvents:"calculateEvents",calculateTableBS$:"calculateTableBS$"},outputs:{loadCalculateTable$:"loadCalculateTable$",refreshCalculateTable:"refreshCalculateTable"},features:[i.qOj],decls:17,vars:12,consts:[[1,"row","w-100","m-0","table-card"],[1,"col-lg-12"],[1,"table-header","row","d-flex","align-items-center"],[1,"col-4","col-lg-8"],[1,"dropdown","d-flex","align-items-center","mt-3","mb-3"],["type","button","id","assetTypeFilter","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-transparent","dropdown-toggle","dropdown-filter"],["aria-labelledby","assetTypeFilter",1,"dropdown-menu"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"col-lg-4","d-flex"],["src","../../../../../../assets/icons/search.svg","alt","",1,"search-icon"],["type","search","placeholder","Buscar","id","atb-search",1,"form-control","search-input",3,"ngbTypeahead"],["input",""],[1,"table-container"],[3,"dataSource","totalItems","columns","spinner","indexColumn","onPaginator","page"],[1,"dropdown-item",3,"click"]],template:function(b,A){if(1&b&&(i.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),i._uU(6),i.qZA(),i.TgZ(7,"div",6),i.YNc(8,v,2,1,"a",7),i.qZA()()(),i.TgZ(9,"div",8),i._UZ(10,"img",9)(11,"input",10,11),i.qZA()(),i.TgZ(13,"div",12)(14,"atb-table",13),i.NdJ("onPaginator",function(z){return A.paginator=z})("page",function(z){return A.emitRefresh(z)}),i.ALo(15,"async"),i.ALo(16,"async"),i.qZA()()()()),2&b){let q,z;i.xp6(6),i.hij(" ",A.selectedAssetType," "),i.xp6(2),i.Q6J("ngForOf",A.categories),i.xp6(3),i.Q6J("ngbTypeahead",A.searchFinalization),i.xp6(3),i.Q6J("dataSource",null==(q=i.lcZ(15,8,A.dataSource$))?null:q.items)("totalItems",null==(z=i.lcZ(16,10,A.dataSource$))?null:z.total)("columns",A.columns)("spinner",A.spinnerTable$)("indexColumn",!0)}},directives:[F.sg,g.dR,C.oH,m.a],pipes:[F.Ov],styles:[""]}),e})()},7496:(pe,oe,r)=>{r.d(oe,{W:()=>F});var o=r(7751),h=r(9808),s=r(8279),i=r(7622),l=r(5e3);let F=(()=>{class g{}return g.\u0275fac=function(m){return new(m||g)},g.\u0275mod=l.oAB({type:g}),g.\u0275inj=l.cJS({imports:[[h.ez,s.p0,i.m,o.ZS]]}),g})()},3822:(pe,oe,r)=>{r.d(oe,{P:()=>j});var o=r(3075),h=r(1884),s=r(1094),i=r(7579),l=r(5e3),F=r(9808),g=r(6517);function C(N,V){if(1&N&&(l.TgZ(0,"option",25),l._uU(1),l.qZA()),2&N){const y=V.$implicit;l.Q6J("value",null==y?null:y.installment),l.xp6(1),l.hij(" ",(null==y?null:y.installment)+"x"," ")}}function m(N,V){if(1&N&&(l.TgZ(0,"option",25),l._uU(1),l.qZA()),2&N){const y=V.$implicit;l.Q6J("value",null==y?null:y.value),l.xp6(1),l.hij(" ",null==y?null:y.value," ")}}function v(N,V){if(1&N&&(l.TgZ(0,"div",26)(1,"span",27),l._uU(2,"Valor da ades\xe3o"),l.qZA(),l.TgZ(3,"h2",28),l._uU(4),l.ALo(5,"currency"),l.qZA()()),2&N){const y=l.oxw(2);l.xp6(4),l.hij(" ",l.xi3(5,1,null==y.installment?null:y.installment.accessionValue,"BRL")," ")}}function M(N,V){if(1&N&&(l.TgZ(0,"div",29)(1,"span",30),l._uU(2),l.qZA(),l.TgZ(3,"h2",31),l._uU(4),l.ALo(5,"currency"),l.qZA()()),2&N){const y=l.oxw(2);let S;l.xp6(2),l.AsE(" ",null!=y.installment&&y.installment.hasAccession?"":"1"," ",null!=y.installment&&y.installment.hasAccession?null==(S=y.form.get("installments"))?null:S.value:(null==(S=y.form.get("installments"))?null:S.value)>1?"+ "+((null==(S=y.form.get("installments"))?null:S.value)-1):""," de "),l.xp6(2),l.hij(" ",l.xi3(5,3,y.displayCredit,"BRL")," ")}}function e(N,V){if(1&N){const y=l.EpF();l.TgZ(0,"form",8),l.NdJ("ngSubmit",function(){return l.CHM(y),l.oxw().onSubmit()}),l.TgZ(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"label",13),l._uU(6," Parcelar em "),l.qZA(),l.TgZ(7,"select",14),l.YNc(8,C,2,2,"option",15),l.qZA()(),l.TgZ(9,"div",12)(10,"label",16),l._uU(11," Dia de vencimento "),l.qZA(),l.TgZ(12,"select",17),l.YNc(13,m,2,2,"option",15),l.qZA()()()(),l.TgZ(14,"div",18),l.YNc(15,v,6,4,"div",19),l.qZA(),l.TgZ(16,"div",20)(17,"span",21),l._uU(18,"Valor da parcela"),l.qZA(),l.YNc(19,M,6,6,"div",22),l.qZA(),l.TgZ(20,"div",23)(21,"button",24),l._uU(22," Confirmar "),l.qZA()()()()}if(2&N){const y=l.oxw();let S;l.Q6J("formGroup",y.form),l.xp6(8),l.Q6J("ngForOf",null==y.installment?null:y.installment.availableInstallments),l.xp6(5),l.Q6J("ngForOf",y.days),l.xp6(1),l.ekj("border-left",null==y.installment?null:y.installment.hasAccession),l.xp6(1),l.Q6J("ngIf",null==y.installment?null:y.installment.hasAccession),l.xp6(4),l.Q6J("ngIf",null==(S=y.form.get("installments"))?null:S.value)}}function c(N,V){if(1&N&&(l.ynx(0),l.TgZ(1,"td"),l._uU(2,"\xc0 vista"),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.ALo(5,"currency"),l.qZA(),l.BQk()),2&N){const y=l.oxw().$implicit;l.xp6(4),l.Oqu(l.xi3(5,1,y.value,"BRL"))}}function b(N,V){if(1&N&&(l.ynx(0),l.TgZ(1,"td"),l._uU(2),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.ALo(5,"currency"),l.qZA(),l.BQk()),2&N){const y=l.oxw().$implicit;l.xp6(2),l.hij(" ",null!=y&&y.hasAccession?y.installment:"1 + "+(y.installment-1)," "),l.xp6(2),l.Oqu(l.xi3(5,2,y.value,"BRL"))}}function A(N,V){if(1&N&&(l.TgZ(0,"tr"),l.YNc(1,c,6,4,"ng-container",32),l.YNc(2,b,6,5,"ng-container",32),l.qZA()),2&N){const y=V.index;l.Q6J("@popupAnim",void 0),l.xp6(1),l.Q6J("ngIf",0===y),l.xp6(1),l.Q6J("ngIf",y>0)}}function q(N,V){if(1&N&&(l.ynx(0),l.TgZ(1,"td"),l._uU(2,"\xc0 vista"),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.ALo(5,"currency"),l.qZA(),l.BQk()),2&N){const y=l.oxw().$implicit;l.xp6(4),l.Oqu(l.xi3(5,1,y.value,"BRL"))}}function z(N,V){if(1&N&&(l.ynx(0),l.TgZ(1,"td"),l._uU(2),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.ALo(5,"currency"),l.qZA(),l.BQk()),2&N){const y=l.oxw().$implicit;l.xp6(2),l.hij(" ",null!=y&&y.hasAccession?y.installment:"1 + "+(y.installment-1)," "),l.xp6(2),l.Oqu(l.xi3(5,2,y.value,"BRL"))}}function X(N,V){if(1&N&&(l.TgZ(0,"tr"),l.YNc(1,q,6,4,"ng-container",32),l.YNc(2,z,6,5,"ng-container",32),l.qZA()),2&N){const y=V.index;l.Q6J("@popupAnim",void 0),l.xp6(1),l.Q6J("ngIf",0===y),l.xp6(1),l.Q6J("ngIf",y>0&&y<6)}}function Y(N,V){if(1&N&&(l.ynx(0),l.TgZ(1,"td"),l._uU(2),l.qZA(),l.TgZ(3,"td"),l._uU(4),l.ALo(5,"currency"),l.qZA(),l.BQk()),2&N){const y=l.oxw().$implicit;l.xp6(2),l.hij(" ",null!=y&&y.hasAccession?y.installment:"1 + "+(y.installment-1)," "),l.xp6(2),l.Oqu(l.xi3(5,2,y.value,"BRL"))}}function D(N,V){if(1&N&&(l.TgZ(0,"tr"),l.YNc(1,Y,6,5,"ng-container",32),l.qZA()),2&N){const y=V.index;l.Q6J("@popupAnim",void 0),l.xp6(1),l.Q6J("ngIf",y>5)}}function L(N,V){if(1&N&&(l.TgZ(0,"div",33)(1,"table",2)(2,"thead")(3,"tr")(4,"th",3),l._uU(5,"Prazo"),l.qZA(),l.TgZ(6,"th",3),l._uU(7,"Valor da parcela"),l.qZA()()(),l.TgZ(8,"tbody"),l.YNc(9,D,2,2,"tr",4),l.qZA()()()),2&N){const y=l.oxw();l.Q6J("@popupAnim",void 0),l.xp6(9),l.Q6J("ngForOf",y.availableInstallments)}}const Q=function(N){return{"col-lg-12":N}};let j=(()=>{class N{constructor(y){this.formBuilder=y,this.form=this.formBuilder.group({installments:[null,[o.kI.required]],dueDay:[null,[o.kI.required]],hasGroupingSlips:[!0,[o.kI.required]]}),this.readOnly=!1,this.updateInstallments=new i.x,this.displayCredit=0,this.availableInstallments=[],this.days=[{value:5},{value:6},{value:7},{value:8},{value:9},{value:10},{value:11},{value:12},{value:13},{value:14},{value:15},{value:16},{value:17},{value:18},{value:19},{value:20},{value:21},{value:22},{value:23},{value:24},{value:25}],this.updateCreditValue=S=>{var U;return null===(U=this.availableInstallments.find(R=>R.installment==S))||void 0===U?void 0:U.value},this.onSubmit=()=>this.form.valid&&this.updateInstallments.next(this.form.value)}set proponentCredit(y){}set _installment(y){y&&(this.installment=y,this.availableInstallments=null==y?void 0:y.availableInstallments,this.displayCredit=this.updateCreditValue(Number(y.installments)),this.form.patchValue({installments:y.installments||null,dueDay:y.dueDay||null}))}ngOnInit(){var y;null===(y=this.form.get("installments"))||void 0===y||y.valueChanges.pipe((0,h.x)()).subscribe(S=>this.displayCredit=this.updateCreditValue(S))}}return N.\u0275fac=function(y){return new(y||N)(l.Y36(o.qu))},N.\u0275cmp=l.Xpm({type:N,selectors:[["app-installment-simulation-table"]],inputs:{proponentCredit:"proponentCredit",_installment:["installment","_installment"],readOnly:"readOnly"},outputs:{updateInstallments:"updateInstallments"},decls:24,vars:7,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],[1,"d-block","d-lg-none"],[1,"table"],["scope","col"],[4,"ngFor","ngForOf"],[1,"row","d-none","d-lg-flex"],[1,"col-lg-6",3,"ngClass"],["class","col-lg-6",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"row","mb-5"],[1,"col-md-4","col-xl-3","d-flex","mb-3","mb-xl-0","pr-0"],[1,"row","w-100"],[1,"form-group","col-lg-6","pr-2","pr-md-0","mb-0"],["for","installments",1,"subtitle-sm","text-black-light","text-nowrap"],["formControlName","installments","id","installments",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],["for","dueDay",1,"subtitle-sm","text-black-light","text-nowrap"],["formControlName","dueDay","id","dueDay",1,"form-control"],[1,"installment","col-md-8","col-xl-3","mb-3","mb-xl-0","d-flex","align-items-center"],["class","bg-gray-100 rounded p-3 w-100",4,"ngIf"],[1,"info","col-md-8","col-xl-5","mb-3","mb-lg-0","d-flex","flex-column","justify-content-end"],[1,"subtitle-sm","text-black-txt","mb-3"],["class","d-flex flex-wrap align-items",4,"ngIf"],[1,"col-md-4","col-xl-1","d-flex","align-items-end","justify-content-end"],["type","submit",1,"btn","btn-success-atb","w-100"],[3,"value"],[1,"bg-gray-100","rounded","p-3","w-100"],[1,"subtitle-sm","mb-1"],[1,"text-blue-400"],[1,"d-flex","flex-wrap","align-items"],[1,"subtitle-sm","black-txt","mr-2","d-flex","align-items-end","mb-1"],[1,"mb-0","text-blue-400"],[4,"ngIf"],[1,"col-lg-6"]],template:function(y,S){1&y&&(l.ynx(0),l.YNc(1,e,23,7,"form",0),l.TgZ(2,"div",1)(3,"table",2)(4,"thead")(5,"tr")(6,"th",3),l._uU(7,"Prazo"),l.qZA(),l.TgZ(8,"th",3),l._uU(9,"Valor da parcela"),l.qZA()()(),l.TgZ(10,"tbody"),l.YNc(11,A,3,3,"tr",4),l.qZA()()(),l.TgZ(12,"div",5)(13,"div",6)(14,"table",2)(15,"thead")(16,"tr")(17,"th",3),l._uU(18,"Prazo"),l.qZA(),l.TgZ(19,"th",3),l._uU(20,"Valor da parcela"),l.qZA()()(),l.TgZ(21,"tbody"),l.YNc(22,X,3,3,"tr",4),l.qZA()()(),l.YNc(23,L,10,2,"div",7),l.qZA(),l.BQk()),2&y&&(l.xp6(1),l.Q6J("ngIf",!S.readOnly),l.xp6(10),l.Q6J("ngForOf",S.availableInstallments),l.xp6(2),l.Q6J("ngClass",l.VKq(5,Q,(null==S.availableInstallments?null:S.availableInstallments.length)<7)),l.xp6(9),l.Q6J("ngForOf",S.availableInstallments),l.xp6(1),l.Q6J("ngIf",(null==S.availableInstallments?null:S.availableInstallments.length)>6))},directives:[F.O5,o._Y,o.JL,o.sg,g.MU,g.HK,o.EJ,g.oH,o.JJ,o.u,F.sg,o.YN,o.Kr,F.mk],pipes:[F.H9],styles:[".table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:none;padding:10px 0}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{background-color:#dbeefd;color:#70b9d8;font-weight:500;font-size:16px;letter-spacing:.25px;text-align:center}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{background-color:#70b9d8;color:#fff;font-weight:500;font-size:16px;letter-spacing:.25px;text-align:center}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(even){background-color:#f7f7f7}.table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:14px;font-weight:400;letter-spacing:.25px;color:#707a84;text-align:center}@media (max-width: 768px){.border-left.installment[_ngcontent-%COMP%]{border:none!important}}"],data:{animation:[s.bA]}}),N})()},9694:(pe,oe,r)=>{r.d(oe,{Q:()=>Fe});var o=r(1135),h=r(8306),s=r(7579),i=r(5e3),l=r(9808),F=r(3075),g=r(4004),C=r(5698),m=r(8966),v=r(8279);function M(k,ae){1&k&&(i.TgZ(0,"th",19),i._uU(1,"Bem"),i.qZA())}function e(k,ae){if(1&k&&(i.TgZ(0,"td",20),i._uU(1),i.qZA()),2&k){const T=ae.$implicit;i.xp6(1),i.Oqu(null==T?null:T.description)}}function c(k,ae){1&k&&(i.TgZ(0,"th",19),i._uU(1,"Identificador"),i.qZA())}function b(k,ae){if(1&k&&(i.TgZ(0,"td",20),i._uU(1),i.qZA()),2&k){const T=ae.$implicit;i.xp6(1),i.Oqu(null==T?null:T.identifier)}}function A(k,ae){1&k&&(i.TgZ(0,"th",21),i._uU(1,"Valor atual"),i.qZA())}function q(k,ae){if(1&k&&(i.TgZ(0,"td",20),i._uU(1),i.ALo(2,"currency"),i.qZA()),2&k){const T=ae.$implicit;i.xp6(1),i.hij(" ",i.xi3(2,1,null==T?null:T.currentValue,"BRL")," ")}}function z(k,ae){1&k&&(i.TgZ(0,"th",22),i._uU(1,"Valor atualizado"),i.qZA())}function X(k,ae){if(1&k&&(i.TgZ(0,"td",23),i._uU(1),i.ALo(2,"currency"),i.qZA()),2&k){const T=ae.$implicit;i.xp6(1),i.hij(" ",i.xi3(2,1,null==T?null:T.newValue,"BRL")," ")}}function Y(k,ae){1&k&&i._UZ(0,"tr",24)}function D(k,ae){1&k&&i._UZ(0,"tr",25)}let L=(()=>{class k{constructor(T,ee){this.data=T,this.dialogRef=ee,this.displayedColumns=["Bem","Identificador","Valor atual","Valor atualizado"]}submit(){this.dialogRef.close()}}return k.\u0275fac=function(T){return new(T||k)(i.Y36(m.WI),i.Y36(m.so))},k.\u0275cmp=i.Xpm({type:k,selectors:[["app-update-fipe-modal"]],decls:28,vars:4,consts:[[1,"modal-header","d-flex","justify-content-start","align-items-center"],[1,"modal-icon","mr-2"],["src","../../../../assets/icons/modal-info.svg","alt",""],[1,"modal-title","pull-left","text-gray-600","mb-0"],[1,"table-container"],["mat-table","",1,"mat-elevation-z0",3,"dataSource"],["matColumnDef","Bem"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Identificador"],["matColumnDef","Valor atual"],["mat-header-cell","","style","width: 20%; white-space: nowrap;",4,"matHeaderCellDef"],["matColumnDef","Valor atualizado"],["mat-header-cell","","style","width: 20%; padding-right: 0; white-space: nowrap;",4,"matHeaderCellDef"],["mat-cell","","style","font-weight: 500",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"button","d-flex","justify-content-end"],[1,"btn","btn-success",3,"click"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",2,"width","20%","white-space","nowrap"],["mat-header-cell","",2,"width","20%","padding-right","0","white-space","nowrap"],["mat-cell","",2,"font-weight","500"],["mat-header-row",""],["mat-row",""]],template:function(T,ee){1&T&&(i.TgZ(0,"div",0)(1,"div",1),i._UZ(2,"img",2),i.qZA(),i.TgZ(3,"h5",3),i._uU(4," Atualiza\xe7\xe3o do registro de refer\xeancia "),i.qZA()(),i.TgZ(5,"mat-dialog-content")(6,"div",4)(7,"table",5),i.ynx(8,6),i.YNc(9,M,2,0,"th",7),i.YNc(10,e,2,1,"td",8),i.BQk(),i.ynx(11,9),i.YNc(12,c,2,0,"th",7),i.YNc(13,b,2,1,"td",8),i.BQk(),i.ynx(14,10),i.YNc(15,A,2,0,"th",11),i.YNc(16,q,3,4,"td",8),i.BQk(),i.ynx(17,12),i.YNc(18,z,2,0,"th",13),i.YNc(19,X,3,4,"td",14),i.BQk(),i.YNc(20,Y,1,0,"tr",15),i.YNc(21,D,1,0,"tr",16),i.qZA()()(),i.TgZ(22,"footer")(23,"p"),i._uU(24," Para prosseguir com o c\xe1lculo, ser\xe1 necess\xe1rio atualizar os registros de refer\xeancia (FIPE) dos ve\xedculos acima listados. "),i.qZA(),i.TgZ(25,"div",17)(26,"button",18),i.NdJ("click",function(){return ee.submit()}),i._uU(27,"Confirmar"),i.qZA()()()),2&T&&(i.xp6(7),i.Q6J("dataSource",ee.data),i.xp6(13),i.Q6J("matHeaderRowDef",ee.displayedColumns)("matHeaderRowDefSticky",!0),i.xp6(1),i.Q6J("matRowDefColumns",ee.displayedColumns))},directives:[m.xY,v.BZ,v.w1,v.fO,v.ge,v.Dz,v.ev,v.as,v.XQ,v.nj,v.Gk],pipes:[l.H9],styles:[""]}),k})();var Q=r(2610),j=r(5764),N=r(4351),V=r(97),y=r(8746),S=r(1884),U=r(1520),R=r(312),le=r(262),ne=r(2290),de=r(7258),fe=r(3047),he=r(7751),ue=r(6517),ye=r(1470),Me=r(2953),Pe=r(6055);function B(k,ae){if(1&k&&(i.TgZ(0,"option",28),i._uU(1),i.qZA()),2&k){const T=ae.$implicit;i.Q6J("value",null==T?null:T.value),i.xp6(1),i.hij(" ",null==T?null:T.displayName," ")}}function J(k,ae){if(1&k&&(i.TgZ(0,"option",28),i._uU(1),i.qZA()),2&k){const T=ae.$implicit;i.Q6J("value",null==T?null:T.value),i.xp6(1),i.hij(" ",null==T?null:T.displayName," ")}}function x(k,ae){if(1&k&&(i.TgZ(0,"span"),i._uU(1),i.ALo(2,"periodDataPipe"),i.qZA()),2&k){const T=i.oxw(2);i.xp6(1),i.hij(" ",i.lcZ(2,1,T.dataPeriod)," dias ")}}function _(k,ae){if(1&k&&(i.TgZ(0,"span"),i._uU(1),i.ALo(2,"periodDataPipe"),i.qZA()),2&k){const T=i.oxw(2);i.xp6(1),i.hij(" ",i.lcZ(2,1,T.dataPeriod)," meses ")}}function I(k,ae){1&k&&(i.TgZ(0,"span"),i._uU(1,"1 m\xeas"),i.qZA())}function H(k,ae){if(1&k&&(i.TgZ(0,"span",29),i.YNc(1,x,3,3,"span",26),i.YNc(2,_,3,3,"span",26),i.YNc(3,I,2,0,"span",26),i.qZA()),2&k){const T=i.oxw();i.xp6(1),i.Q6J("ngIf",T.dataPeriod<1),i.xp6(1),i.Q6J("ngIf",T.dataPeriod>1),i.xp6(1),i.Q6J("ngIf",1==T.dataPeriod)}}function re(k,ae){if(1&k&&(i.ynx(0),i._uU(1),i.ALo(2,"currency"),i.BQk()),2&k){const T=i.oxw();i.xp6(1),i.hij(" ",i.xi3(2,1,T.totalProtectionValue,"BRL")," ")}}function ge(k,ae){1&k&&(i.ynx(0),i.TgZ(1,"div",30),i._uU(2,"Calcule"),i.qZA(),i.BQk())}function me(k,ae){1&k&&(i.TgZ(0,"div",31)(1,"div",32)(2,"span",33),i._uU(3,"Loading..."),i.qZA()()())}function Te(k,ae){1&k&&(i.ynx(0),i._uU(1," Erro no c\xe1lculo "),i.BQk())}let Ee=(()=>{class k{constructor(T,ee,P,K,d,E){var O;this.formBuilder=T,this.dialog=ee,this.toastrService=P,this.commercialFacade=K,this.quotationService=d,this.modalService=E,this.arrowUp=!1,this.availableCreditMessage=new String,this.quotationId="",this.useCredit=!1,this.calculateForm=this.formBuilder.group({franchiseType:["",F.kI.required],coverageDays:["",[F.kI.required]],protectionPeriodType:["",[F.kI.required]],factor:[null,F.kI.required],acceptFipeUpdate:!1}),this.periodTypes$=null===(O=this.calculateForm.get("coverageDays"))||void 0===O?void 0:O.valueChanges.pipe((0,g.U)(te=>(this.dataPeriod=te/30,this.dataPeriod))),this.calculate=new s.x,this.statics$=new h.y,this.proponentCredit$=new s.x}set calculateEvents$(T){T&&this.calculateEventsResponse(T)}ngOnInit(){this.availableCreditMessage=`Proponente possui um cr\xe9dito dispon\xedvel de R$ ${this.availableCredit||0}`,this.patchCalculateForm(),this.onProtectionPeriodTypes()}patchCalculateForm(){this.commercialFacade.loadingService.show(),this.subscription=this.calculatePanelData$.pipe((0,y.x)(()=>this.commercialFacade.loadingService.hide()),(0,N.b)(T=>{var ee;if(this.credit=T.credit,this.totalProtectionValue=T.totalProtectionValue,this.calculateForm.patchValue({coverageDays:T.coverageDays,franchiseType:T.franchiseType||this.FranchiseTypeTranslated.Normal,factor:T.factor||T.maxFactor}),null===(ee=this.calculateForm.get("factor"))||void 0===ee||ee.setValidators([F.kI.required,(0,V.rJ)(!1,T.maxFactor)]),this.calculateForm.controls.factor.updateValueAndValidity(),T.id)return this.quotationId=T.id,this.quotationService.getQuotationById(T.id)})).subscribe(T=>{var ee,P,K;switch(this.dataPeriodTypes=T.protectionPeriodType,this.calculateForm.patchValue({protectionPeriodType:T.protectionPeriodType}),T.protectionPeriodType){case"Daily":null===(ee=this.calculateForm.get("coverageDays"))||void 0===ee||ee.setValidators([F.kI.required,F.kI.max(29)]);break;case"Monthly":null===(P=this.calculateForm.get("coverageDays"))||void 0===P||P.setValidators(F.kI.compose([F.kI.min(30),F.kI.max(59)]));break;default:null===(K=this.calculateForm.get("coverageDays"))||void 0===K||K.setValidators(F.kI.compose([F.kI.min(365),F.kI.max(730)]))}this.calculateForm.controls.coverageDays.updateValueAndValidity()})}get loading$(){return this.commercialFacade.calculateLoading$}get disableCalculate$(){return this.commercialFacade.disableCalculate$}get FranchiseTypeTranslated(){return j.f}onProtectionPeriodTypes(){var T;null===(T=this.calculateForm.get("protectionPeriodType"))||void 0===T||T.valueChanges.pipe((0,S.x)(),(0,U.G)()).subscribe(([ee,P])=>{var K;P!==this.dataPeriodTypes&&(null===(K=this.calculateForm.get("protectionPeriodType"))||void 0===K||K.setValue(ee,{onlySelf:!0,emitEvent:!0}),this.openProtectionPeriodTypeModal().subscribe(d=>{!0===d&&this.updateProtectionPeriodType(P).subscribe(()=>{this.commercialFacade.setContentTitle(this.quotationId),this.patchCalculateForm()})}))})}openProtectionPeriodTypeModal(){const T=this.modalService.open(R.z,{centered:!0});return T.componentInstance.title="Mudan\xe7a de per\xedodo",T.componentInstance.type="alert",T.componentInstance.confirmButtonText="Sim",T.componentInstance.cancelButtonText="N\xe3o",T.componentInstance.list=["Essa altera\xe7\xe3o de per\xedodo ir\xe1 remover os servi\xe7os de todos os bens. Voc\xea deseja continuar?"],T.closed}updateProtectionPeriodType(T){return this.commercialFacade.loadingService.show(),this.quotationService.updateProtectionPeriodType(this.quotationId,T).pipe((0,C.q)(1),(0,le.K)(ee=>(this.commercialFacade.loadingService.hide(),ee)))}calculateContract(){this.calculateForm.valid&&(this.disableCalculate$.next(!0),this.calculate.next(this.calculateForm.value),this.commercialFacade.loadingService.show(),this.loading$.next(!0))}openUpdateFipeModal(T){!this.dialog.openDialogs.length&&this.dialog.open(L,{height:"max-content",disableClose:!0,panelClass:"UpdateFipeModal",data:T}).beforeClosed().subscribe(()=>{const ee=this.calculateForm.value;ee.acceptFipeUpdate=!0,this.calculate.next(ee)})}calculateEventsResponse(T){var ee;(null==T?void 0:T.data.Status)===Q.$.Success&&(this.calculateEvents=T,this.proponentCredit$.next(null===(ee=this.calculateForm.get("credit"))||void 0===ee?void 0:ee.value),this.calculateEvents.finalized&&setTimeout(()=>{this.totalProtectionValue=T.totalValue,this.disableCalculate$.next(!1),this.commercialFacade.loadInstallments(this.quotationId),this.loading$.next(!1)},500)),(null==T?void 0:T.data.status)===Q.$.Fail&&this.openUpdateFipeModal(T.data.assets),T&&this.commercialFacade.loadingService.hide(),(null==T?void 0:T.data.Status)===Q.$.Fail&&(this.toastrService.show(`${T.data.Message}`,"Erro",{toastClass:"alert-toast"}),this.loading$.next(!1),this.disableCalculate$.next(!1))}ngOnDestroy(){var T;null===(T=this.subscription)||void 0===T||T.unsubscribe()}}return k.\u0275fac=function(T){return new(T||k)(i.Y36(F.qu),i.Y36(m.uw),i.Y36(ne._W),i.Y36(de.J),i.Y36(fe.G),i.Y36(he.FF))},k.\u0275cmp=i.Xpm({type:k,selectors:[["app-credit-panel"]],inputs:{calculatePanelData$:"calculatePanelData$",statics$:"statics$",availableCredit:"availableCredit",calculateEvents$:"calculateEvents$",participations$:"participations$"},outputs:{calculate:"calculate",proponentCredit$:"proponentCredit$"},decls:45,vars:26,consts:[[1,"card","table-card","mb-3"],[1,"row","container-fluid","p-3","justify-content-between","align-items-end"],[1,"calculation-form","col","mb-2","input-group","align-items-end",3,"formGroup","ngSubmit"],[1,"col-xl-2","border-xl-right"],["for","protectionPeriodType"],["formControlName","protectionPeriodType","id","protectionPeriodType","type","dropdown",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[1,"col-xl-3"],["for","franchiseType"],["formControlName","franchiseType","id","franchiseType","type","dropdown",1,"form-control"],[1,"col-xl-3","ml-0","form-group","mb-0"],["for",""],[1,"input-group"],["formControlName","coverageDays","type","text","aria-describedby","coverage-days","placeholder","180 dias","mask","000",1,"form-control",3,"validation"],[1,"input-group-append"],["class","input-group-text","id","protection-time",4,"ngIf"],[1,"col-xl-2","form-group","mb-0"],["className","form-control percentage-width","formControlName","factor",3,"separator"],[1,"col-xl-2"],["type","submit",1,"form-control","btn","btn-success","mt-3","mt-xl-0",3,"disabled"],[1,"info","col-xl-3","border-left"],[1,"col","d-flex","flex-row","flex-xl-column","justify-content-start"],[1,"d-flex","align-items-center","mr-3","mr-xl-0"],[1,"subtitle-sm"],["placement","top",1,"fas","fa-info-circle","info-icon","ml-3","text-gray-300",3,"ngbTooltip"],[1,"label-total-value"],[4,"ngIf"],["style","transition: 0.4s ease-in-out;",4,"ngIf"],[3,"value"],["id","protection-time",1,"input-group-text"],[1,"col-lg"],[2,"transition","0.4s ease-in-out"],["role","status",1,"spinner-border","text-primary","ml-4",2,"height","20px","width","20px","font-size","15px","transition","0.2s ease-in-out"],[1,"sr-only"]],template:function(T,ee){if(1&T&&(i.TgZ(0,"div",0)(1,"div",1)(2,"form",2),i.NdJ("ngSubmit",function(){return ee.calculateContract()}),i.TgZ(3,"div",3)(4,"label",4),i._uU(5,"Per\xedodo"),i.qZA(),i.TgZ(6,"select",5),i.YNc(7,B,2,2,"option",6),i.ALo(8,"async"),i.qZA()(),i.TgZ(9,"div",7)(10,"label",8),i._uU(11,"Participa\xe7\xe3o"),i.qZA(),i.TgZ(12,"select",9),i.YNc(13,J,2,2,"option",6),i.ALo(14,"async"),i.qZA()(),i.TgZ(15,"div",10)(16,"label",11),i._uU(17,"Tempo de prote\xe7\xe3o"),i.qZA(),i.TgZ(18,"div",12),i._UZ(19,"input",13),i.TgZ(20,"div",14),i.YNc(21,H,4,3,"span",15),i.ALo(22,"async"),i.qZA()()(),i.TgZ(23,"div",16)(24,"label",11),i._uU(25,"Fator"),i.qZA(),i._UZ(26,"app-percent-input",17),i.qZA(),i.TgZ(27,"div",18)(28,"button",19),i.ALo(29,"async"),i._uU(30," Calcular "),i.qZA()()(),i.TgZ(31,"div",20)(32,"div",21)(33,"div",22)(34,"span",23),i._uU(35,"Valor do contrato"),i.qZA(),i._UZ(36,"i",24),i.qZA(),i.TgZ(37,"div",25),i.YNc(38,re,3,4,"ng-container",26),i.ALo(39,"async"),i.YNc(40,ge,3,0,"ng-container",26),i.ALo(41,"async"),i.YNc(42,me,4,0,"div",27),i.ALo(43,"async"),i.YNc(44,Te,2,0,"ng-container",26),i.qZA()()()()()),2&T){let P;i.xp6(2),i.Q6J("formGroup",ee.calculateForm),i.xp6(5),i.Q6J("ngForOf",null==(P=i.lcZ(8,12,ee.statics$))?null:P.protectionPeriodTypes),i.xp6(6),i.Q6J("ngForOf",i.lcZ(14,14,ee.participations$)),i.xp6(6),i.Q6J("validation",!1),i.xp6(2),i.Q6J("ngIf",i.lcZ(22,16,ee.periodTypes$)),i.xp6(5),i.Q6J("separator",2),i.xp6(2),i.Q6J("disabled",i.lcZ(29,18,ee.disableCalculate$)),i.xp6(8),i.Q6J("ngbTooltip",ee.availableCreditMessage),i.xp6(2),i.Q6J("ngIf",!i.lcZ(39,20,ee.loading$)&&((null==ee.calculateEvents?null:ee.calculateEvents.finalized)||ee.totalProtectionValue)),i.xp6(2),i.Q6J("ngIf",!ee.calculateEvents&&!ee.totalProtectionValue&&!i.lcZ(41,22,ee.loading$)),i.xp6(2),i.Q6J("ngIf",i.lcZ(43,24,ee.loading$)),i.xp6(2),i.Q6J("ngIf","Fail"===(null==ee.calculateEvents||null==ee.calculateEvents.data?null:ee.calculateEvents.data.Status))}},directives:[F._Y,F.JL,F.sg,ue.MU,F.EJ,ue.oH,F.JJ,F.u,l.sg,F.YN,F.Kr,ue.HK,F.Fj,ye.hx,l.O5,Me.t,he._L],pipes:[l.Ov,Pe.Y,l.H9],styles:["#indicator-name[_ngcontent-%COMP%]{border:none}#discount[_ngcontent-%COMP%]{max-width:60px}.confirm-btn[_ngcontent-%COMP%]{min-height:40px;max-height:40px;font-size:16px}.contract-value[_ngcontent-%COMP%]{border-left:1px solid #e5e5e5;padding:0 2rem}.contract-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:700;font-size:32px;display:flex;align-items:center;color:#0683f9;white-space:nowrap}.contract-value[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{cursor:pointer}.credit-value[_ngcontent-%COMP%]{display:flex;align-items:center;white-space:nowrap;font-size:16px;color:#000}.credit-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#5cb85c}  bfv-messages>.invalid-feedback{right:1rem}@media screen and (min-width: 1200px){.border-xl-right[_ngcontent-%COMP%]{border-right:1px solid #E5E5E5}}@media screen and (max-height: 850px){.confirm-btn[_ngcontent-%COMP%]{min-height:35px;max-height:35px;font-size:14px}.contract-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:26px}.credit-value[_ngcontent-%COMP%]{font-size:14px}.credit-value[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:18px}}.label-total-value[_ngcontent-%COMP%]{color:#0683f9;font-size:2rem}"]}),k})();var Ie=r(1772),Oe=r(3822),we=r(1125);function Ze(k,ae){1&k&&(i.TgZ(0,"div",15)(1,"span",16),i._uU(2,"Loading..."),i.qZA()())}function qe(k,ae){if(1&k){const T=i.EpF();i.TgZ(0,"div",17)(1,"h5",18),i._uU(2,"Parcelamento"),i.qZA(),i.TgZ(3,"app-installment-simulation-table",19),i.NdJ("updateInstallments",function(P){return i.CHM(T),i.oxw(2).updateInstallments.next(P)}),i.qZA()()}if(2&k){const T=i.oxw(2);i.xp6(3),i.Q6J("proponentCredit",T.proponentCredit$)("installment",T.installment)}}function De(k,ae){if(1&k&&(i.TgZ(0,"div")(1,"mat-accordion")(2,"mat-expansion-panel",20)(3,"mat-expansion-panel-header",21),i._uU(4," Simula\xe7\xe3o de parcelamento "),i.qZA(),i.TgZ(5,"div"),i._UZ(6,"app-installment-simulation-table",22),i.qZA()()()()),2&k){const T=i.oxw(2);i.xp6(6),i.Q6J("installment",T.installment)("readOnly",!0)}}function Se(k,ae){if(1&k){const T=i.EpF();i.ynx(0),i.TgZ(1,"div",1)(2,"span",2),i._uU(3," Gerar cota\xe7\xe3o "),i.qZA(),i.TgZ(4,"app-credit-panel",3),i.NdJ("calculate",function(P){return i.CHM(T),i.oxw().calculateContract(P)})("proponentCredit$",function(P){return i.CHM(T),i.oxw().emitProponentCredit(P)}),i.qZA(),i.TgZ(5,"div",4)(6,"div",5)(7,"div",6)(8,"app-calculate-table",7),i.NdJ("loadCalculateTable$",function(P){return i.CHM(T),i.oxw().loadCalculateTable(P)}),i.qZA()(),i.YNc(9,Ze,3,0,"ng-template",null,8,i.W1O),i.qZA()(),i.YNc(11,qe,4,2,"div",9),i.YNc(12,De,7,2,"div",0),i.TgZ(13,"div",10)(14,"div",11)(15,"div",12)(16,"button",13),i.NdJ("click",function(){return i.CHM(T),i.oxw().onAction({direction:"back"})}),i._uU(17," Voltar "),i.qZA(),i.TgZ(18,"button",14),i.NdJ("click",function(){return i.CHM(T),i.oxw().finalizeQuotation()}),i._uU(19," Finalizar "),i.qZA()()()()(),i.BQk()}if(2&k){const T=i.oxw();i.xp6(4),i.Q6J("calculateEvents$",T.calculateEvents)("participations$",T.participation$)("statics$",T.statics$)("calculatePanelData$",T.calculatePanelData$),i.xp6(3),i.Q6J("ngClass",null==T.calculateEvents||!T.calculateEvents.started||null!=T.calculateEvents&&T.calculateEvents.finalized?"":"table-blocked"),i.xp6(1),i.Q6J("quotationId",T.quotationId)("calculateTableBS$",T.calculateTableBS$)("calculateEvents",T.calculateEvents),i.xp6(3),i.Q6J("ngIf",!T.isQuotation&&("Saved"===(null==T.proposal?null:T.proposal.modification)||(null==T.calculateEvents?null:T.calculateEvents.finalized))),i.xp6(1),i.Q6J("ngIf",T.isQuotation)}}let Fe=(()=>{class k{constructor(){this.proponentCredit$=new o.X(0),this.formSubject=new o.X(null),this.showStep=!1,this.quotationId="",this.statics$=new h.y,this.isQuotation=!0,this.stepAction=new s.x,this.finalize=new s.x,this.setStep=new s.x,this.calculate=new s.x,this.updateInstallments=new s.x,this.loadCalculateTable$=new s.x,this.onAction=T=>this.stepAction.next(T),this.calculateContract=T=>this.calculate.next(T),this.finalizeQuotation=()=>this.finalize.next(this.formSubject),this.emitProponentCredit=T=>this.proponentCredit$.next(T),this.loadCalculateTable=T=>this.loadCalculateTable$.next(T)}set _showStep(T){this.showStep=T,this.showStep&&this.setStep.next(2)}}return k.\u0275fac=function(T){return new(T||k)},k.\u0275cmp=i.Xpm({type:k,selectors:[["app-proposal-finalize"]],inputs:{_showStep:["showStep","_showStep"],quotationId:"quotationId",proposal:"proposal",installment:"installment",participation$:"participation$",calculatePanelData$:"calculatePanelData$",calculateTableBS$:"calculateTableBS$",contractValue:"contractValue",statics$:"statics$",calculateEvents:"calculateEvents",isQuotation:"isQuotation"},outputs:{stepAction:"stepAction",finalize:"finalize",setStep:"setStep",calculate:"calculate",updateInstallments:"updateInstallments",loadCalculateTable$:"loadCalculateTable$"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"wrapper","px-0"],[1,"content-title","mb-3"],[3,"calculateEvents$","participations$","statics$","calculatePanelData$","calculate","proponentCredit$"],[1,"card","table-card","mb-3"],[1,"w-100","d-flex","align-items-center","justify-content-center","pb-2"],[1,"w-100",3,"ngClass"],[3,"quotationId","calculateTableBS$","calculateEvents","loadCalculateTable$"],["loading",""],["class","card table-card mb-3 p-4",4,"ngIf"],[1,"buttons","row","mt-1"],[1,"col-lg-12"],[1,"d-flex","justify-content-between"],[1,"btn","btn-outline-light-atb","btn-lg",3,"click"],[1,"btn","btn-primary","btn-lg",3,"click"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"card","table-card","mb-3","p-4"],[1,"black-txt","mb-5"],[3,"proponentCredit","installment","updateInstallments"],[1,"mat-elevation-z0","card","mb-3","p-4",2,"display","flex"],["collapsedHeight","4.375rem",2,"font-weight","700"],[3,"installment","readOnly"]],template:function(T,ee){1&T&&i.YNc(0,Se,20,10,"ng-container",0),2&T&&i.Q6J("ngIf",ee.showStep)},directives:[l.O5,Ee,l.mk,Ie.N,Oe.P,we.pp,we.ib,we.yz],styles:[".wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column}.buttons[_ngcontent-%COMP%]{margin-top:1.5rem;display:flex;justify-content:space-between}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:156px}.table-blocked[_ngcontent-%COMP%]{pointer-events:none;opacity:.4}"]}),k})()},6154:(pe,oe,r)=>{r.d(oe,{Z:()=>v});var o=r(9808),h=r(7622),s=r(8966),i=r(8279),l=r(6087),F=r(7446),g=r(4847),C=r(7496),m=r(5e3);let v=(()=>{class M{}return M.\u0275fac=function(c){return new(c||M)},M.\u0275mod=m.oAB({type:M}),M.\u0275inj=m.cJS({providers:[o.H9],imports:[[o.ez,h.m,s.Is,i.p0,l.TU,F.p9,g.JX,C.W]]}),M})()},645:(pe,oe,r)=>{r.d(oe,{b:()=>F});var o=r(4521),h=r(9808),s=r(7622),i=r(2145),l=r(5e3);let F=(()=>{class g{}return g.\u0275fac=function(m){return new(m||g)},g.\u0275mod=l.oAB({type:g}),g.\u0275inj=l.cJS({imports:[[h.ez,s.m,i.WN,o.Bz]]}),g})()},6539:(pe,oe,r)=>{r.d(oe,{v:()=>V});var o=r(8505),h=r(5698),s=r(8746),i=r(1135),l=r(3075),F=r(8966),g=r(97),C=r(6367),m=r(5e3),v=r(2290),M=r(2569),e=r(3047),c=r(1299),b=r(9808),A=r(6517),q=r(3150),z=r(988),X=r(1470);function Y(y,S){if(1&y){const U=m.EpF();m.TgZ(0,"a",49),m.NdJ("click",function(){const ne=m.CHM(U).$implicit;return m.oxw().setAssetTypeSelected(ne)}),m._uU(1),m.qZA()}if(2&y){const U=S.$implicit;m.xp6(1),m.Oqu(U.displayName)}}function D(y,S){1&y&&m._UZ(0,"div",50)}function L(y,S){1&y&&m._UZ(0,"div",51)}const Q=function(){return{text:"Oficializar proposta"}},j=function(){return{text:"Question\xe1rio"}},N=function(y,S){return[y,S]};let V=(()=>{class y extends C.K{constructor(U,R,le,ne,de,fe,he){super(),this.fb=U,this.dialog=R,this.toastr=le,this.loading=ne,this.quotationService=de,this.dialogRef=fe,this.data=he,this.quotationId="",this.categories=[{displayName:"Todos os bens",value:"All"},{displayName:"Conclu\xeddas",value:"Complete"},{displayName:"Incompletas",value:"Incomplete"}],this.selectedAssetType=this.categories[0],this.cars=0,this.trucks=0,this.motorcycles=0,this.pageSize=10,this.displayedColumns=["plate"],this.proponentCheckbox=!1,this.proponent={},this.hasPlate=!0,this.spinnerSearch$=new i.X(!1),this.spinnerSubject$=new i.X(!1),this.assets$=new i.X({}),this.form=this.fb.group({assetId:[null],ownerName:[{value:"",disabled:this.proponentCheckbox},[l.kI.required,(0,g.fM)()]],autoType:["",[l.kI.required]],ownerDocument:[{value:"",disabled:this.proponentCheckbox},[l.kI.required]],renavam:["",[l.kI.required]],chassis:["",[l.kI.required,(0,g.Jw)()]]})}ngOnInit(){this.loading.show(),this.quotationId=this.data.quotationId,this.proponent=this.data.proponent,this.loadAssets(0,this.pageSize)}ngAfterViewInit(){this.paginator.page.pipe((0,o.b)(()=>this.loadAssets(this.paginator.pageIndex*this.pageSize,this.pageSize))).subscribe()}setSpinner(){this.spinnerSubject$.next(!0)}loadAssets(U,R){this.quotationService.getProposalVehicles(U,R,this.selectedAssetType.value,this.quotationId).pipe((0,h.q)(1),(0,s.x)(()=>{this.loading.hide(),this.spinnerSearch$.next(!1),this.spinnerSubject$.next(!1)})).subscribe(le=>{this.assets$.next(le),this.cars=le.items.filter(ne=>"Light"==ne.autoType).length,this.trucks=le.items.filter(ne=>"Heavy"==ne.autoType).length,this.motorcycles=le.items.filter(ne=>"Motorcycle"==ne.autoType).length,le.items.forEach(ne=>{this.checkAssetIsDone(ne)&&(ne.status="done")}),this.buildForm(le.items[0])})}searchProposalVehicle(U){if(this.spinnerSearch$.next(!0),!U||""==U)return this.spinnerSearch$.next(!1),this.loadAssets(0,this.pageSize),void(this.paginator.pageIndex=0);this.quotationService.searchProposalVehicles(U,this.quotationId).pipe((0,h.q)(1)).subscribe(R=>{var le,ne,de,fe,he;this.spinnerSearch$.next(!1),this.assets$.next({items:[R],total:[R].length}),this.cars=null===(le=this.assets$.getValue().items)||void 0===le?void 0:le.filter(ue=>"Light"==(null==ue?void 0:ue.autoType)).length,this.trucks=null===(ne=this.assets$.getValue().items)||void 0===ne?void 0:ne.filter(ue=>"Heavy"==(null==ue?void 0:ue.autoType)).length,this.motorcycles=null===(de=this.assets$.getValue().items)||void 0===de?void 0:de.filter(ue=>"Motorcycle"==(null==ue?void 0:ue.autoType)).length,R&&(null===(fe=this.assets$.value.items)||void 0===fe||fe.forEach(ue=>{this.checkAssetIsDone(ue)&&(ue.status="done")})),this.buildForm(null===(he=this.assets$.getValue().items)||void 0===he?void 0:he[0])})}buildForm(U){var R,le;U&&(this.selectedAsset=U),this.proponentCheckbox=(null===(R=this.selectedAsset)||void 0===R?void 0:R.ownerDocument)===(null===(le=this.proponent)||void 0===le?void 0:le.document),this.form.patchValue({assetId:(null==U?void 0:U.assetId)||"",ownerName:(null==U?void 0:U.ownerName)||"",autoType:(null==U?void 0:U.autoType)||"",ownerDocument:(null==U?void 0:U.ownerDocument)||"",renavam:(null==U?void 0:U.renavam)||"",chassis:(null==U?void 0:U.chassis)||""})}checkAssetIsDone(U){const R=["ownerName","autoType","ownerDocument","renavam","chassis"];for(const le of R)if(!Object.keys(U).includes(le)||!Object.values(U).every(ne=>ne))return!1;return!0}setAssetTypeSelected(U){this.paginator.pageIndex=0,this.selectedAssetType=U,this.loadAssets(10*this.paginator.pageIndex,this.pageSize)}setActiveAsset(U){this.selectedAsset=U,this.proponentCheckbox=this.selectedAsset.ownerDocument===this.proponent.document,this.form.reset({name:"",document:"",renavam:"",chassis:""}),this.buildForm(U),this.selectedAsset.status=this.form.valid?"done":"pending"}closeModal(){this.dialogRef.close()}setProponent(){this.proponentCheckbox=!this.proponentCheckbox,this.form.patchValue({ownerName:this.proponentCheckbox?this.proponent.displayName:"",ownerDocument:this.proponentCheckbox?this.proponent.document:""})}saveSurvey(){if(this.form.markAllAsTouched(),this.form.valid)return this.selectedAsset.status="done",void this.quotationService.saveProposalVehicles(this.form.value,this.quotationId).pipe((0,h.q)(1)).subscribe(U=>{var R;const le=this.assets$.getValue();le.items=null===(R=le.items)||void 0===R?void 0:R.map(ne=>(ne.renavam===U.renavam&&(ne.chassis=U.chassis,ne.ownerDocument=U.ownerDocument,ne.ownerName=U.ownerName,ne.renavam=U.renavam,this.setActiveAsset(ne),console.log([ne,U])),ne)),this.assets$.next(le),this.toastr.show("Salvo com sucesso!","title",{toastClass:"success-toast"})});this.selectedAsset.status="pending",this.toastr.show("Verifique os campos e tente novamente!","title",{toastClass:"error-toast"})}submit(){var U,R;null===(U=this.assets$.getValue().items)||void 0===U||U.forEach(le=>{le.status||(le.status="pending")}),(null===(R=this.assets$.getValue().items)||void 0===R?void 0:R.some(le=>!le.status||"done"!=le.status))?this.toastr.show("Verifique se todos os bens est\xe3o v\xe1lidos!","title",{toastClass:"error-toast"}):(this.toastr.show("Question\xe1rio salvo com sucesso!","title",{toastClass:"success-toast"}),this.closeModal())}ngOnDestroy(){}}return y.\u0275fac=function(U){return new(U||y)(m.Y36(l.qu),m.Y36(F.uw),m.Y36(v._W),m.Y36(M.b),m.Y36(e.G),m.Y36(F.so),m.Y36(F.WI))},y.\u0275cmp=m.Xpm({type:y,selectors:[["app-proposal-survey"]],features:[m.qOj],decls:72,vars:27,consts:[[1,"wrapper","px-0"],[1,"container"],[1,"d-flex","flex-column"],[3,"isModal","items","closeModal"],[1,"card","p-4","container-card"],[1,"d-flex","align-items-center","justify-content-between"],[1,"dropdown","d-flex","align-items-center"],["type","button","id","dropdownMenuButton","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-transparent","dropdown-toggle","category-dropdown","pl-0","bold-txt"],["aria-labelledby","dropdownMenuButton",1,"dropdown-menu"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"col-lg-4","d-flex","pr-0"],["src","../../../../../../assets/icons/search.svg","alt","",1,"search-icon"],["type","search","placeholder","Buscar",1,"form-control","search-input",3,"search"],["input",""],["class","ml-3 spinner-border text-primary input-loading","role","status",4,"ngIf"],[1,"card","p-0","mt-3","inner-card"],[1,"row"],[1,"col-lg-3"],[1,"box","border-right","d-flex","asset-list"],["class","spinner spinner-border text-primary","role","status",4,"ngIf"],[3,"selectedAsset","dataSource","totalItems","setActiveAsset","page","onPaginator"],[1,"col-lg"],[1,"box","d-flex","flex-column","justify-content-between"],[1,"d-flex"],[1,"d-flex","my-3","mr-4","col-lg-8","pl-0"],[3,"asset"],[1,"licensePlateItem"],[1,"mr-3"],[1,"mb-0","overflow-hidden"],[1,"form-check","form-check-inline","col-lg-4"],["type","checkbox","id","proponent","value","1",1,"form-check-input","text",3,"checked","click"],["for","proponent",1,"form-check-label","text"],[3,"formGroup"],[1,"col-lg-8"],[1,"form-group"],["for","ownerName",1,"required"],["type","text","id","ownerName","formControlName","ownerName",1,"form-control"],[1,"col-lg-4"],["for","ownerDocument",1,"required"],["mask","000.000.000-00||00.000.000/0000-00","type","text","id","ownerDocument","formControlName","ownerDocument",1,"form-control"],["for","renavam",1,"required"],["type","text","id","renavam","formControlName","renavam","mask","00000000000",1,"form-control"],["for","chassis",1,"required"],["type","text","id","chassis","formControlName","chassis",1,"form-control","text-uppercase"],[1,"action-buttons","align-self-end","mt-3"],[1,"btn","btn-success-atb","btn-lg",3,"click"],[1,"action-buttons","d-flex","align-items-center","justify-content-end","mt-5"],[1,"btn","btn-outline-light-atb","btn-lg",3,"click"],[1,"btn","btn-primary-atb","btn-lg","ml-3",3,"click"],[1,"dropdown-item",3,"click"],["role","status",1,"ml-3","spinner-border","text-primary","input-loading"],["role","status",1,"spinner","spinner-border","text-primary"]],template:function(U,R){if(1&U){const le=m.EpF();m.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-breadcrumb",3),m.NdJ("closeModal",function(){return R.dialogRef.close()}),m.qZA(),m.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"button",7),m._uU(8),m.qZA(),m.TgZ(9,"div",8),m.YNc(10,Y,2,1,"a",9),m.qZA()(),m.TgZ(11,"div",10),m._UZ(12,"img",11),m.TgZ(13,"input",12,13),m.NdJ("search",function(){m.CHM(le);const de=m.MAs(14);return R.searchProposalVehicle(de.value)}),m.qZA(),m.YNc(15,D,1,0,"div",14),m.ALo(16,"async"),m.qZA()(),m.TgZ(17,"div",15)(18,"div",16)(19,"div",17)(20,"div",18),m.YNc(21,L,1,0,"div",19),m.ALo(22,"async"),m.TgZ(23,"app-mini-assets-table",20),m.NdJ("setActiveAsset",function(de){return R.setActiveAsset(de)})("page",function(de){return R.loadAssets(de.skip,de.take)})("onPaginator",function(de){return R.paginator=de}),m.ALo(24,"async"),m.ALo(25,"async"),m.qZA()()(),m.TgZ(26,"div",21)(27,"div",22)(28,"div")(29,"div",23)(30,"div",24),m._UZ(31,"app-assets-badge",25),m.TgZ(32,"div",26)(33,"h4",27),m._uU(34),m.qZA()(),m.TgZ(35,"p",28),m._uU(36),m.qZA()(),m.TgZ(37,"div",29)(38,"input",30),m.NdJ("click",function(){return R.setProponent()}),m.qZA(),m.TgZ(39,"label",31),m._uU(40,"Proponente da proposta"),m.qZA()()(),m.TgZ(41,"form",32)(42,"div",16)(43,"div",33)(44,"div",34)(45,"label",35),m._uU(46,"Nome do propriet\xe1rio"),m.qZA(),m._UZ(47,"input",36),m.qZA()(),m.TgZ(48,"div",37)(49,"div",34)(50,"label",38),m._uU(51,"CPF/CNPJ"),m.qZA(),m._UZ(52,"input",39),m.qZA()()(),m.TgZ(53,"div",16)(54,"div",37)(55,"div",34)(56,"label",40),m._uU(57,"Renavam"),m.qZA(),m._UZ(58,"input",41),m.qZA()(),m.TgZ(59,"div",37)(60,"div",34)(61,"label",42),m._uU(62,"Chassi"),m.qZA(),m._UZ(63,"input",43),m.qZA()()()()(),m.TgZ(64,"div",44)(65,"button",45),m.NdJ("click",function(){return R.saveSurvey()}),m._uU(66," Salvar "),m.qZA()()()()()(),m.TgZ(67,"div",46)(68,"button",47),m.NdJ("click",function(){return R.closeModal()}),m._uU(69," Voltar "),m.qZA(),m.TgZ(70,"button",48),m.NdJ("click",function(){return R.submit()}),m._uU(71," Concluir "),m.qZA()()()()()()}if(2&U){let le,ne;m.xp6(3),m.Q6J("isModal",!0)("items",m.WLB(24,N,m.DdM(22,Q),m.DdM(23,j))),m.xp6(5),m.hij(" ",R.selectedAssetType.displayName," "),m.xp6(2),m.Q6J("ngForOf",R.categories),m.xp6(5),m.Q6J("ngIf",m.lcZ(16,14,R.spinnerSearch$)),m.xp6(6),m.Q6J("ngIf",m.lcZ(22,16,R.spinnerSubject$)),m.xp6(2),m.Q6J("selectedAsset",R.selectedAsset)("dataSource",null==(le=m.lcZ(24,18,R.assets$))?null:le.items)("totalItems",null==(ne=m.lcZ(25,20,R.assets$))?null:ne.total),m.xp6(8),m.Q6J("asset",R.selectedAsset),m.xp6(3),m.Oqu(null==R.selectedAsset?null:R.selectedAsset.licensePlate),m.xp6(2),m.hij(" ",null==R.selectedAsset?null:R.selectedAsset.assetDescription," "),m.xp6(2),m.Q6J("checked",R.proponentCheckbox),m.xp6(3),m.Q6J("formGroup",R.form)}},directives:[c.L,b.sg,A.oH,b.O5,q.x,z.i,l._Y,l.JL,l.sg,A.MU,A.HK,l.Fj,l.JJ,l.u,X.hx],pipes:[b.Ov],styles:['.mat-dialog-container{overflow:auto!important;padding:0}.wrapper[_ngcontent-%COMP%]{background-color:#f0f3f9;min-height:100vh;min-width:100vw;max-height:100vh;overflow-y:auto}  .cdk-overlay-pane{max-width:none!important}  .cdk-global-scrollblock{position:static;overflow:hidden!important}.container[_ngcontent-%COMP%]:first-child{padding:2rem 0}.card[_ngcontent-%COMP%]{padding:4.1rem 3.4rem}.box[_ngcontent-%COMP%]{padding:1rem;min-height:600px;max-height:600px}.asset-list[_ngcontent-%COMP%]{display:flex;flex-direction:column}.asset-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-bottom:0!important}.asset-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%], .asset-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style:none;padding:0;width:100%}.asset-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:.5rem;width:100%;border-radius:4px;cursor:pointer;margin-bottom:5px;position:relative}.asset-list[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background:#e3f2fd;color:#0683f9;font-weight:700}.asset-list[_ngcontent-%COMP%]   .editing[_ngcontent-%COMP%]:before{content:"\\f303";font-family:"Font Awesome 5 Free";display:inline-block;width:2em;font-size:24px;position:absolute;top:0;left:calc(50% - 85px)}.asset-list[_ngcontent-%COMP%]   li.done[_ngcontent-%COMP%]{color:#5cb85c;font-weight:700}.asset-list[_ngcontent-%COMP%]   li.done[_ngcontent-%COMP%]:before{content:"\\f058";font-family:"Font Awesome 5 Free";display:inline-block;width:2em;font-size:24px;position:absolute;top:0;left:calc(50% - 85px)}.asset-list[_ngcontent-%COMP%]   li.done[_ngcontent-%COMP%]:hover{background:#5cb85c19!important}.asset-list[_ngcontent-%COMP%]   li.pending[_ngcontent-%COMP%]{color:#f0ad4e;font-weight:700}.asset-list[_ngcontent-%COMP%]   li.pending[_ngcontent-%COMP%]:before{content:"\\f06a";font-family:"Font Awesome 5 Free";display:inline-block;width:2em;font-size:24px;position:absolute;top:0;left:calc(50% - 85px)}.asset-list[_ngcontent-%COMP%]   li.pending[_ngcontent-%COMP%]:hover{background:#f0ac4e18!important}.clausules[_ngcontent-%COMP%]{max-height:200px;overflow:auto}.clausules[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.1);height:3rem}.clausules[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.clausules[_ngcontent-%COMP%]   .index[_ngcontent-%COMP%]{color:#0683f9;font-weight:700;line-height:1}.check-input-lg[_ngcontent-%COMP%]{width:24px;height:24px;cursor:pointer}  thead{display:none!important}  th.mat-header-cell, td.mat-cell[_ngcontent-%COMP%], td.mat-footer-cell[_ngcontent-%COMP%]{border-bottom-style:none!important}  .mat-survey-paginator .mat-paginator-container{margin-bottom:25px}  .mat-survey-paginator .mat-paginator-container .mat-paginator-range-label{position:absolute;left:calc(50% - 50px)!important;bottom:0;margin-bottom:15px!important}.input-loading.spinner-border[_ngcontent-%COMP%]{margin-right:15px;bottom:23%}.spinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:calc(50% - 20px);z-index:999}  .mat-survey-paginator .mat-paginator-container{padding:10px 8px 0!important}  .mat-survey-paginator .mat-paginator-container .mat-paginator-range-label{position:absolute;left:0}  .mat-paginator-range-actions{justify-content:center}  .mat-paginator-navigation-next,   .mat-paginator-navigation-previous{display:none!important}li.done.chassis[_ngcontent-%COMP%]{font-size:14px!important}li.done.chassis[_ngcontent-%COMP%]:before{left:calc(50% - 112px)!important}li.pending.chassis[_ngcontent-%COMP%]{font-size:14px!important}li.pending.chassis[_ngcontent-%COMP%]:before{left:calc(50% - 112px)!important}.licensePlateItem[_ngcontent-%COMP%]{white-space:nowrap}@media screen and (max-height: 800px){.container-card[_ngcontent-%COMP%]{max-height:630px}.inner-card[_ngcontent-%COMP%]{max-height:auto}.box[_ngcontent-%COMP%]{min-height:520px!important;max-height:520px!important}}@media screen and (max-width: 1199px){li.done.chassis[_ngcontent-%COMP%]:before{left:calc(50% - 96px)!important}li.done.chassis[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:27px}li.pending.chassis[_ngcontent-%COMP%]:before{left:calc(50% - 96px)!important}li.pending.chassis[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:27px}}']}),y})()},829:(pe,oe,r)=>{r.d(oe,{i:()=>pn});var o=r(8966),h=r(8306),s=r(7579),i=r(9646),l=r(2843),F=r(5698),g=r(8505),C=r(262),m=r(8746),v=r(8663),M=r(1042),e=r(5e3),c=r(1299),b=r(9808),A=r(3075),q=r(6517);const z=function(u){return{"mt-4":u}};let X=(()=>{class u{constructor(){this.removeEquipment=new e.vpe}ngOnInit(){}onRemoveEquipment(){this.removeEquipment.emit()}}return u.\u0275fac=function(t){return new(t||u)},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-equipment-item"]],inputs:{id:"id"},outputs:{removeEquipment:"removeEquipment"},decls:23,vars:4,consts:[[1,"card-equipment",3,"ngClass"],[1,"d-flex","justify-content-between","align-items-center"],[1,"subtitle","medium-txt"],["src","../../../../../../../../assets/icons/trash-sm.svg","alt","Adicionar",1,"equip-card-icon",3,"click"],[1,"row","mt-3"],[1,"col-lg-8"],[1,"form-group"],["for",""],["type","text",1,"form-control"],[1,"col-lg-4"],[1,"row"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"span",2),e._uU(3),e.qZA(),e.TgZ(4,"img",3),e.NdJ("click",function(){return n.onRemoveEquipment()}),e.qZA()(),e.TgZ(5,"form")(6,"div",4)(7,"div",5)(8,"div",6)(9,"label",7),e._uU(10,"Modelo/Ano"),e.qZA(),e._UZ(11,"input",8),e.qZA()(),e.TgZ(12,"div",9)(13,"div",6)(14,"label",7),e._uU(15,"N\xfamero de s\xe9rie"),e.qZA(),e._UZ(16,"input",8),e.qZA()()(),e.TgZ(17,"div",10)(18,"div",9)(19,"div",6)(20,"label",7),e._uU(21,"Valor declarado"),e.qZA(),e._UZ(22,"input",8),e.qZA()()()()()),2&t&&(e.Q6J("ngClass",e.VKq(2,z,n.id>0)),e.xp6(3),e.Oqu("Equipamento "+(n.id+1)))},directives:[b.mk,A._Y,A.JL,A.F,q.HK,q.oH],styles:[".card-equipment[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1px solid #e7e7e7;box-sizing:border-box;border-radius:6px;padding:1.5rem;margin-right:1rem}.equip-card-icon[_ngcontent-%COMP%]{cursor:pointer}.equip-card-icon[_ngcontent-%COMP%]:hover{filter:brightness(.8)}"]}),u})();function Y(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"app-equipment-item",15),e.NdJ("removeEquipment",function(){const p=e.CHM(t).$implicit;return e.oxw().removeEquipment(p)}),e.qZA()}2&u&&e.Q6J("id",w.index)}const D=function(){return{text:"Cooperativas"}},L=function(){return{text:"Adicionar cooperativa"}},Q=function(u,w){return[u,w]};let j=(()=>{class u{constructor(t,n){this.dialogRef=t,this.data=n,this.equipments=[{id:M.Z()},{id:M.Z()}]}ngOnInit(){console.log(this.equipments)}closePanel(){this.dialogRef.close()}submit(){this.dialogRef.close()}addEquipment(){this.equipments=[...this.equipments,{id:M.Z()}]}removeEquipment(t){this.equipments=[...this.equipments.filter(n=>n.id!==t.id)]}}return u.\u0275fac=function(t){return new(t||u)(e.Y36(o.so),e.Y36(o.WI))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-equipments-panel"]],decls:19,vars:8,consts:[[1,"wrapper","px-0"],[1,"container"],[1,"d-flex","flex-column"],[3,"isModal","items","closeModal"],[1,"card","equip-card"],[1,"d-flex","align-items-center","justify-content-between","py-4"],[1,"bold-txt"],[1,"btn","btn-outline-primary","ml-3","add-btn",3,"click"],[1,"equip-inner-card"],[3,"id","removeEquipment",4,"ngFor","ngForOf"],[1,"row","mt-5"],[1,"col-lg-12"],[1,"d-flex","justify-content-end"],[1,"btn","btn-outline-light-atb",3,"click"],["type","button",1,"btn","btn-primary","ml-3",3,"click"],[3,"id","removeEquipment"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-breadcrumb",3),e.NdJ("closeModal",function(){return n.dialogRef.close()}),e.qZA(),e.TgZ(4,"div",4)(5,"div",5)(6,"h4",6),e._uU(7,"Cadastro de equipamentos"),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){return n.addEquipment()}),e._uU(9," + Adicionar "),e.qZA()(),e.TgZ(10,"div",8),e.YNc(11,Y,1,1,"app-equipment-item",9),e.qZA(),e.TgZ(12,"div",10)(13,"div",11)(14,"div",12)(15,"button",13),e.NdJ("click",function(){return n.closePanel()}),e._uU(16," Cancelar "),e.qZA(),e.TgZ(17,"button",14),e.NdJ("click",function(){return n.submit()}),e._uU(18," Concluir "),e.qZA()()()()()()()()),2&t&&(e.xp6(3),e.Q6J("isModal",!0)("items",e.WLB(5,Q,e.DdM(3,D),e.DdM(4,L))),e.xp6(8),e.Q6J("ngForOf",n.equipments))},directives:[c.L,b.sg,X],styles:[".mat-dialog-container{overflow:auto!important;padding:0}.wrapper[_ngcontent-%COMP%]{background-color:#f0f3f9;min-height:100vh;min-width:100vw;max-height:100vh;overflow-y:auto}  .cdk-overlay-pane{max-width:none!important}  .cdk-global-scrollblock{position:static;overflow:hidden!important}.container[_ngcontent-%COMP%]:first-child{padding:2rem 0}.equip-card[_ngcontent-%COMP%]{min-height:calc(100vh - 136px);max-height:calc(100vh - 136px);padding:15px 54px 36px 36px}.equip-inner-card[_ngcontent-%COMP%]{overflow:auto}"]}),u})();var N=r(3047),V=r(2569),y=r(312),S=r(5598),U=r(9093),R=r(1884),le=r(2498),ne=r(97),de=r(2290);let fe=(()=>{class u{constructor(t,n){this.quotationService=t,this.toastr=n}controlIsZeroKmEvents(t,n){var a;null===(a=t.get("isZeroKm"))||void 0===a||a.valueChanges.pipe((0,R.x)()).subscribe(p=>{var f,Z,W,G,ie,se,ce,ve,xe,Ce,be,Ae,Re,Je,Be,Le,Qe;Boolean(p)?(null===(f=t.get("licensePlate"))||void 0===f||f.clearValidators(),null===(Z=t.get("licensePlate"))||void 0===Z||Z.updateValueAndValidity(),null===(W=t.get("isDamaged"))||void 0===W||W.setValue(!1),null===(G=t.get("isDamaged"))||void 0===G||G.disable(),null===(ie=t.get("invoiceValue"))||void 0===ie||ie.enable(),null===(se=t.get("invoiceNumber"))||void 0===se||se.enable(),null===(ce=t.get("chassis"))||void 0===ce||ce.setValidators([A.kI.required,(0,ne.Jw)()])):(null===(ve=t.get("isDamaged "))||void 0===ve||ve.enable(),null===(xe=t.get("licensePlate"))||void 0===xe||xe.setValidators(A.kI.required),null===(Ce=t.get("licensePlate"))||void 0===Ce||Ce.setErrors({required:!0}),null===(be=t.get("invoiceValue"))||void 0===be||be.disable(),null===(Ae=t.get("invoiceNumber"))||void 0===Ae||Ae.disable(),null===(Re=t.get("invoiceValue"))||void 0===Re||Re.setValue(""),null===(Je=t.get("invoiceNumber"))||void 0===Je||Je.setValue(""),null===(Be=t.get("chassis"))||void 0===Be||Be.clearValidators(),null===(Le=t.get("chassis"))||void 0===Le||Le.setValidators((0,ne.Jw)()),null===(Qe=t.get("chassis"))||void 0===Qe||Qe.updateValueAndValidity())})}patchVehicleFormValue(t,n,a=!1){t.patchValue({id:(null==n?void 0:n.id)||null,vehicleId:(null==n?void 0:n.vehicleId)||null,type:(null==n?void 0:n.type)||null,isZeroKm:!!(null==n?void 0:n.isZeroKm),model:{description:`${null==n?void 0:n.manufacturer} - ${null==n?void 0:n.model} - ${null==n?void 0:n.yearModel}`||null,ourFipe:(null==n?void 0:n.ourFipe)||null},colorId:(null==n?void 0:n.colorId)||null,renavam:(null==n?void 0:n.renavam)||null,isDamaged:(null==n?void 0:n.isDamaged)||!1,vehicleType:null==n?void 0:n.type,aggregateTypeId:(null==n?void 0:n.aggregateTypeId)||null,coverageRegionId:(null==n?void 0:n.coverageRegionId)||null,licensingFederationUnit:(null==n?void 0:n.licensingFederationUnit)||null,protectBody:null==n?void 0:n.protectBody,bodyValue:null==n?void 0:n.bodyValue,bodyTypeId:(null==n?void 0:n.bodyTypeId)||null,protectAdditionalAxle:null==n?void 0:n.protectAdditionalAxle,additionalAxleValue:null==n?void 0:n.additionalAxleValue,securityDeviceId:(null==n?void 0:n.securityDeviceId)||null,securityDeviceCompanyName:(null==n?void 0:n.securityDeviceCompanyName)||null,securityDeviceCompanyContact:(null==n?void 0:n.securityDeviceCompanyContact)||null,ourFipe:null==n?void 0:n.ourFipe,equipments:(null==n?void 0:n.equipments)||[],products:(null==n?void 0:n.products)||[],vehicleValue:(null==n?void 0:n.vehicleValue)||null,invoiceValue:(null==n?void 0:n.invoiceValue)||null,isLocked:(null==n?void 0:n.isLocked)||!1,chassis:null==n?void 0:n.chassis,licensePlate:null==n?void 0:n.licensePlate})}patchAggregateFormValue(t,n,a=!1){t.patchValue({id:(null==n?void 0:n.id)||null,aggregateId:(null==n?void 0:n.aggregateId)||null,aggregateTypeId:null==n?void 0:n.aggregateTypeId,isZeroKm:!!(null==n?void 0:n.isZeroKm),model:null==n?void 0:n.model,year:null==n?void 0:n.yearModel,aggregateType:null==n?void 0:n.type,cargoTypeId:null==n?void 0:n.cargoTypeId,bodyTypeId:null==n?void 0:n.bodyTypeId,coverageRegionId:(null==n?void 0:n.coverageRegionId)||null,equipments:(null==n?void 0:n.equipments)||[],products:(null==n?void 0:n.products)||[],aggregateValue:(null==n?void 0:n.aggregateValue)||null,invoiceNumber:(null==n?void 0:n.invoiceNumber)||null,declaredValue:(null==n?void 0:n.declaredValue)||null,isLocked:(null==n?void 0:n.isLocked)||!1,renavam:(null==n?void 0:n.renavam)||null,chassis:null==n?void 0:n.chassis,licensePlate:null==n?void 0:n.licensePlate})}setAssetIdFromId(t,n){Object.assign(t,{[t.autoType==v.rQ.Aggregate?"aggregateId":"vehicleId"]:t.id},{id:n||null})}validityChassisAndPlate(t,n){var a,p,f;const Z=null===(a=n.asset.licensePlate)||void 0===a?void 0:a.replace("-",""),W=n.asset.chassis;null===(p=t.get("licensePlate"))||void 0===p||p.valueChanges.pipe((0,R.x)()).subscribe(G=>{7===(null==G?void 0:G.length)&&G!==Z&&this.quotationService.searchVehicle(n.quotationId,G,n.asset.assetType).pipe((0,R.x)()).subscribe(ie=>{var se;ie&&(console.log(ie),this.setAssetIdFromId(ie,null===(se=t.get("id"))||void 0===se?void 0:se.value),this.patchAssetFound(t,ie,n,"licensePlate"),ie.chassis&&t.patchValue({chassis:ie.chassis}))})}),null===(f=t.get("chassis"))||void 0===f||f.valueChanges.pipe((0,R.x)()).subscribe(G=>{var ie;"string"==G&&17===(null===(ie=null==G?void 0:G.replace(/ +/g,""))||void 0===ie?void 0:ie.length)&&G!==W&&this.quotationService.searchVehicle(n.quotationId,G,n.asset.assetType).pipe((0,R.x)()).subscribe(se=>{var ce;se&&(console.log(se),this.setAssetIdFromId(se,null===(ce=t.get("id"))||void 0===ce?void 0:ce.value),this.patchAssetFound(t,se,n,"chassis"),se.licensePlate&&t.patchValue({licensePlate:se.licensePlate}))})})}searchEquipment(t,n){return this.quotationService.searchEquipment(t,n)}patchAssetFound(t,n,a,p){const f="licensePlate"==p?"A Placa informada":"O chassi informado",Z=n.autoType==v.rQ.Aggregate?"patchAggregateFormValue":"patchVehicleFormValue";v.rQ[a.asset.autoType]==n.autoType?(t.addControl("id",new A.NI([""])),this[Z](t,n),t.markAllAsTouched(),this.toastr.show("Placa encontrada!","title",{toastClass:"success-toast"})):this.toastr.show(`${f} n\xe3o corresponde ao tipo de bem selecionado!`,"title",{toastClass:"error-toast"})}}return u.\u0275fac=function(t){return new(t||u)(e.LFG(N.G),e.LFG(de._W))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac,providedIn:"any"}),u})();var he=r(7751),ue=r(815),ye=r(1470);const Me=["mercosulPlate"],Pe=["brazilianPlate"],B=function(u){return{flip:u}};let J=(()=>{class u{constructor(t){this.cdRef=t,this._value="",this.onChange=()=>{},this.onTouched=()=>{},this.flipped=!1,this.mercosul=!1}get value(){return this._value}set value(t){t=(t=t.replace("-","")).trim(),this._value=t.toLocaleUpperCase(),this.manageManuallySetValue(),this.onChange(this._value),this.onTouched()}ngOnInit(){}manageManuallySetValue(){if(this._value.length>=5){const t=this.value.substr(4,1);0==/^\d+$/.test(t)&&(this.mercosul=!0,this.flipped=!0)}}onKeyUp(){if(this._value.length>=5){const t=this.value.substr(4,1);/^\d+$/.test(t)?(this.mercosul=!1,this.flipped=!1,this.cdRef.detectChanges(),this.brazilianPlate.nativeElement.focus()):(this.mercosul=!0,this.flipped=!0,this.cdRef.detectChanges(),this.mercosulPlate.nativeElement.focus())}this.onChange(this._value)}registerOnChange(t){this.onChange=t}writeValue(t){t&&(this.value="0"==t?"":t)}registerOnTouched(t){this.onTouched=t}}return u.\u0275fac=function(t){return new(t||u)(e.Y36(e.sBO))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-license-plate"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Me,5,e.SBq),e.Gf(Pe,5,e.SBq)),2&t){let a;e.iGM(a=e.CRH())&&(n.mercosulPlate=a.first),e.iGM(a=e.CRH())&&(n.brazilianPlate=a.first)}},inputs:{_value:["value","_value"]},features:[e._Bn([{provide:A.JU,useExisting:(0,e.Gpc)(()=>u),multi:!0}])],decls:17,vars:5,consts:[[1,"plate-container"],[1,"plate-card",3,"ngClass"],[1,"front"],[1,"little-text"],[1,"main-text"],["oninput","this.value = this.value.toUpperCase()","type","text","placeholder","ABC-1234","mask","SSS-0A00",3,"ngModel","keyup","ngModelChange"],["brazilianPlate",""],[1,"back"],[1,"little-text-mercosul"],["src","../../../../assets/icons/brazil-flag.svg","alt",""],["oninput","this.value = this.value.toUpperCase()","type","text","placeholder","ABC-1234","mask","SSS-0A00",1,"mercosul-font",3,"ngModel","keyup","ngModelChange"],["mercosulPlate",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span"),e._uU(5,"Digite a placa"),e.qZA()(),e.TgZ(6,"span",4)(7,"input",5,6),e.NdJ("keyup",function(){return n.onKeyUp()})("ngModelChange",function(p){return n.value=p}),e.qZA()()(),e.TgZ(9,"div",7)(10,"div",8)(11,"span"),e._uU(12,"Digite a placa"),e.qZA(),e._UZ(13,"img",9),e.qZA(),e.TgZ(14,"span",4)(15,"input",10,11),e.NdJ("keyup",function(){return n.onKeyUp()})("ngModelChange",function(p){return n.value=p}),e.qZA()()()()()),2&t&&(e.xp6(1),e.Q6J("ngClass",e.VKq(3,B,n.flipped)),e.xp6(6),e.Q6J("ngModel",n.value),e.xp6(8),e.Q6J("ngModel",n.value))},directives:[b.mk,ye.hx,A.Fj,A.JJ,A.On],styles:['@font-face{font-family:Mandatory;src:url(MANDATOR.05fae672a38e2e14.ttf) format("opentype")}@font-face{font-family:MercosulFont;src:url(FE-FONT.a48e87229a76cf23.TTF) format("opentype")}.little-text[_ngcontent-%COMP%]{background:#c4c4c4;border:1px solid #b3b4b7;box-sizing:border-box;border-radius:2px;display:flex;align-items:center;justify-content:center;width:283px;height:16px}.little-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.little-text-mercosul[_ngcontent-%COMP%]{position:relative;background:#01549b;width:100%;border-radius:6px 6px 0 0;display:flex;align-items:center;justify-content:center}.little-text-mercosul[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#fff;font-size:12px}.little-text-mercosul[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:10px;position:absolute;right:5px}.main-text[_ngcontent-%COMP%]{height:60px;display:flex;align-items:center;justify-content:center}.main-text[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background-color:transparent;border:none;font-size:50px;letter-spacing:.25px;font-family:Mandatory,sans-serif;max-width:280px;text-align:center}.mercosul-font[_ngcontent-%COMP%]{font-family:MercosulFont,"sans serif"!important}textarea[_ngcontent-%COMP%]:hover, input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:active, input[_ngcontent-%COMP%]:active, textarea[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:focus, button[_ngcontent-%COMP%]:active, button[_ngcontent-%COMP%]:hover, label[_ngcontent-%COMP%]:focus, .btn[_ngcontent-%COMP%]:active, .btn.active[_ngcontent-%COMP%]{outline:0px!important;-webkit-appearance:none;box-shadow:none!important}.plate-container[_ngcontent-%COMP%]{position:relative;border-radius:6px;height:88px;width:318px}.plate-card[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;transform-style:preserve-3d;transition:all .5s ease-in-out}.flip[_ngcontent-%COMP%]{transform:rotateY(180deg)}.front[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden;background:linear-gradient(180deg,#e7e7e7 0%,#999999 73.14%),linear-gradient(0deg,#c4c4c4,#c4c4c4);border-radius:6px;display:flex;align-items:center;flex-direction:column;padding:.5rem 0 1rem}.back[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(180deg);background:linear-gradient(180deg,#ffffff 0%,#f3f3f3 61.98%,#d8dbdf 100%),#c4c4c4;border-radius:6px;display:flex;align-items:center;flex-direction:column;padding:.5rem 0 1rem}']}),u})();var x=r(2387),_=r(3495),I=r(6332),H=r(9783),re=r(4036);const ge=["equipTable"];function me(u,w){if(1&u&&(e.TgZ(0,"option",66),e._uU(1),e.qZA()),2&u){const t=w.$implicit;e.Q6J("value",null==t?null:t.id),e.xp6(1),e.hij(" ",null==t?null:t.displayName," ")}}function Te(u,w){if(1&u&&(e.TgZ(0,"option",66),e._uU(1),e.qZA()),2&u){const t=w.$implicit;e.Q6J("value",null==t?null:t.id),e.xp6(1),e.hij(" ",null==t?null:t.displayName," ")}}function Ee(u,w){if(1&u&&(e.TgZ(0,"option",66),e._uU(1),e.qZA()),2&u){const t=w.$implicit;e.Q6J("value",null==t?null:t.id),e.xp6(1),e.hij(" ",null==t?null:t.displayName," ")}}function Ie(u,w){1&u&&(e.TgZ(0,"tr")(1,"th",67),e._uU(2," N\xfamero de s\xe9rie "),e.qZA(),e.TgZ(3,"th",67),e._uU(4,"Tipo"),e.qZA(),e.TgZ(5,"th",68),e._uU(6," Nome / Modelo "),e.qZA(),e.TgZ(7,"th",67),e._uU(8,"Valor"),e.qZA(),e._UZ(9,"th"),e.qZA())}const Oe=function(){return{standalone:!0}};function we(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"input",78),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.serialNumber=a})("focus",function(a){e.CHM(t);const p=e.oxw(),f=p.$implicit,Z=p.rowIndex;return e.oxw().onRowEditBegin(f,Z,a)})("blur",function(){e.CHM(t);const a=e.oxw(),p=a.$implicit,f=a.rowIndex;return e.oxw().onRowEditDone(p,f,!0)})("keydown",function(a){e.CHM(t);const p=e.oxw().$implicit;return e.oxw().manageEnterKey(a,p)})("keypress",function(a){return e.CHM(t),e.oxw(2).keyPress(a)})("change",function(){e.CHM(t);const a=e.oxw().$implicit;return a.serialNumber=a.serialNumber.trim()}),e.qZA()}if(2&u){const t=e.oxw().$implicit;e.Q6J("ngModel",t.serialNumber)("ngModelOptions",e.DdM(2,Oe))}}function Ze(u,w){if(1&u&&e._uU(0),2&u){const t=e.oxw().$implicit;e.hij(" ",null==t?null:t.serialNumber," ")}}function qe(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"p-dropdown",79),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.type=a})("onChange",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().onTypeChange(a)}),e.qZA()}if(2&u){const t=e.oxw().$implicit,n=e.oxw();e.Q6J("options",null==n.indexes?null:n.indexes.equipmentTypes)("ngModel",t.type)("ngModelOptions",e.DdM(3,Oe))}}function De(u,w){if(1&u&&e._uU(0),2&u){const t=e.oxw().rowIndex,n=e.oxw();e.hij(" ",null==n.equipments[t]||null==n.equipments[t].type?null:n.equipments[t].type.displayName," ")}}function Se(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"input",80),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.description=a})("focus",function(a){e.CHM(t);const p=e.oxw(),f=p.$implicit,Z=p.rowIndex;return e.oxw().onRowEditBegin(f,Z,a)})("blur",function(){e.CHM(t);const a=e.oxw(),p=a.$implicit,f=a.rowIndex;return e.oxw().onRowEditDone(p,f)})("keydown",function(a){e.CHM(t);const p=e.oxw().$implicit;return e.oxw().manageEnterKey(a,p)})("keypress",function(a){return e.CHM(t),e.oxw(2).keyPress(a)})("change",function(){e.CHM(t);const a=e.oxw().$implicit;return a.description=a.description.trim()}),e.qZA()}if(2&u){const t=e.oxw().$implicit;e.Q6J("ngModel",t.description)("ngModelOptions",e.DdM(2,Oe))}}function Fe(u,w){if(1&u&&(e._uU(0),e.ALo(1,"titlecase")),2&u){const t=e.oxw().$implicit;e.hij(" ",e.lcZ(1,1,null==t?null:t.description)," ")}}const k=function(){return{prefix:"R$ ",thousands:".",decimal:",",align:"left",nullable:!1}};function ae(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"input",81),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.declaredValue=a})("focus",function(a){e.CHM(t);const p=e.oxw(),f=p.$implicit,Z=p.rowIndex;return e.oxw().onRowEditBegin(f,Z,a,!0)})("blur",function(){e.CHM(t);const a=e.oxw(),p=a.$implicit,f=a.rowIndex;return e.oxw().onRowEditDone(p,f)})("keydown",function(a){e.CHM(t);const p=e.oxw().$implicit;return e.oxw().manageEnterKey(a,p)}),e.qZA()}if(2&u){const t=e.oxw().$implicit;e.Q6J("options",e.DdM(3,k))("ngModel",t.declaredValue)("ngModelOptions",e.DdM(4,Oe))}}function T(u,w){if(1&u&&(e._uU(0),e.ALo(1,"currency")),2&u){const t=e.oxw().$implicit;e.hij(" ",e.xi3(1,1,null==t?null:t.declaredValue,"BRL")," ")}}const ee=function(u){return{"row-error":u}},P=function(){return{display:"none"}},K=function(u){return{"cell-error":u}};function d(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"tr",69)(1,"td",70)(2,"p-cellEditor"),e.YNc(3,we,1,3,"ng-template",71),e.YNc(4,Ze,1,1,"ng-template",72),e.qZA()(),e.TgZ(5,"td",73)(6,"p-cellEditor"),e.YNc(7,qe,1,4,"ng-template",71),e.YNc(8,De,1,1,"ng-template",72),e.qZA()(),e.TgZ(9,"td",74)(10,"p-cellEditor"),e.YNc(11,Se,1,3,"ng-template",71),e.YNc(12,Fe,2,3,"ng-template",72),e.qZA()(),e.TgZ(13,"td",74)(14,"p-cellEditor",75),e.YNc(15,ae,1,5,"ng-template",71),e.YNc(16,T,2,4,"ng-template",72),e.qZA()(),e.TgZ(17,"td")(18,"button",76),e.NdJ("click",function(){const a=e.CHM(t),p=a.$implicit,f=a.rowIndex;return e.oxw().deleteRow(p,f)}),e._UZ(19,"i",77),e.qZA()()()}if(2&u){const t=w.$implicit,n=w.rowIndex;e.Q6J("ngClass",e.VKq(6,ee,t.error))("ngStyle","Remove"===(null==t?null:t.operation)?e.DdM(8,P):null),e.xp6(1),e.Q6J("ngClass",e.VKq(9,K,"N\xfamero de S\xe9rie"===(null==t?null:t.serialNumber))),e.xp6(8),e.Q6J("ngClass",e.VKq(11,K,"Equipamento"===t.description)),e.xp6(4),e.Q6J("ngClass",e.VKq(13,K,0===t.declaredValue)),e.xp6(1),e.Q6J("id","equipment-declared-value"+n)}}function E(u,w){1&u&&(e.TgZ(0,"tr",82)(1,"td"),e._uU(2," Clique em Adicionar para incluir um equipamento. "),e.qZA()()),2&u&&(e.xp6(1),e.uIk("colspan",4))}function O(u,w){1&u&&e._UZ(0,"img",83)}const te=function(){return{prefix:"R$ ",thousands:".",decimal:",",align:"left",nullable:!0}},_e=function(u){return{"invalid-form-item":u}},ke=function(u){return{"not-allowed":u}},He=function(u,w){return{"text-gray-300":u,"text-green-200":w}};let Ye=(()=>{class u extends le.o{constructor(t,n,a,p,f){super(t,p),this.injector=t,this.dialog=n,this.controller=a,this.modalService=p,this.toastr=f,this.showLicensePlate=!0,this.equipmentTable=[],this.selectedProducts=[],this.aggregate={},this.openServicesPanel=new e.vpe,this.openEquipmentsPanel=new e.vpe,this.formSubmitted=new e.vpe,this.canceled=new e.vpe,this.productsCount=0,this.equipmentsCount=0,this.controlInvoiceValueStateOnEdit=()=>{var Z,W,G;return(null===(Z=this.aggregate)||void 0===Z?void 0:Z.isZeroKm)&&(null===(G=null===(W=this.form)||void 0===W?void 0:W.get("invoiceNumber"))||void 0===G?void 0:G.enable())},this.disableAddEquipment=!1}set staticAssetTypes(t){null==t||t.map(n=>"Auto"===n.displayName&&(this.subType=n.subTypes))}ngOnInit(){var t;console.log("indexes",this.indexes),this.setForm(),this.countProducts(),(null===(t=this.aggregate)||void 0===t?void 0:t.id)&&this.loadForm(),this.aggregate.equipments=this.equipments,this.setEquipmentType(),this.controller.controlIsZeroKmEvents(this.form,$),this.controller.validityChassisAndPlate(this.form,this.assetData)}setForm(){this.form=this.formBuilder.group({isZeroKm:[!1],aggregateId:[null],aggregateTypeId:[null,A.kI.required],bodyTypeId:[null,A.kI.required],cargoTypeId:[null,A.kI.required],chassis:[null,(0,ne.Jw)()],invoiceNumber:[{value:null,disabled:!0},A.kI.required],licensePlate:[null,A.kI.required],model:[null,A.kI.required],year:[null,A.kI.required],products:[[],A.kI.required],equipments:[[]],renavam:[null],declaredValue:["",A.kI.required],isLocked:[!1]})}loadForm(){console.log("index",this.indexes),this.form.addControl("id",new A.NI([""])),this.controller.patchAggregateFormValue(this.form,this.aggregate),this.form.markAllAsTouched(),setTimeout(()=>{this.controlLicensePlateStateOnEdit(),this.controlInvoiceValueStateOnEdit()},500)}get equipments(){var t;return null===(t=this.form.get("equipments"))||void 0===t?void 0:t.value}checkDeclaredValue(t){var n,a;(null===(n=this.form.get("products"))||void 0===n?void 0:n.value.length)&&(null==t||t.stopPropagation(),null===(a=this.confirmChangeAssetValue())||void 0===a||a.subscribe(p=>{var f;p&&(null===(f=this.form.get("products"))||void 0===f||f.setValue([]),t.target.focus())}))}confirmChangeAssetValue(t=!1){const n=this.modalService.open(y.z,{centered:!0});return n.componentInstance.list=t?["Os servi\xe7os deste equipamento ser\xe3o removidos caso este campo seja alterado. Deseja continuar?"]:["Os servi\xe7os deste bem (com exce\xe7\xe3o dos servi\xe7os dos equipamentos) ser\xe3o removidos caso este campo seja alterado. Deseja continuar?"],n.componentInstance.title="Cuidado!",n.componentInstance.type="alert",n.componentInstance.confirmButtonText="Sim",n.componentInstance.cancelButtonText="N\xe3o",n.closed}controlIsLocked(){}controlLicensePlateStateOnEdit(){var t,n,a,p;(null===(t=this.aggregate)||void 0===t?void 0:t.isZeroKm)&&(null===(n=this.form.get("licensePlate"))||void 0===n||n.clearValidators(),null===(a=this.form.get("licensePlate"))||void 0===a||a.updateValueAndValidity(),null===(p=this.form.get("invoiceNumber"))||void 0===p||p.enable())}controlIsZeroKmEvents(){var t;null===(t=this.form.get("isZeroKm"))||void 0===t||t.valueChanges.pipe((0,R.x)()).subscribe(n=>{var a,p,f,Z,W,G,ie,se,ce;Boolean(n)?(null===(a=this.form.get("licensePlate"))||void 0===a||a.clearValidators(),null===(p=this.form.get("licensePlate"))||void 0===p||p.updateValueAndValidity(),null===(f=this.form.get("invoiceNumber"))||void 0===f||f.enable(),null===(Z=this.form.get("chassis"))||void 0===Z||Z.setValidators([A.kI.required,(0,ne.Jw)()])):(null===(W=this.form.get("invoiceNumber"))||void 0===W||W.disable(),null===(G=this.form.get("invoiceNumber"))||void 0===G||G.setValue(""),null===(ie=this.form.get("chassis"))||void 0===ie||ie.clearValidators(),null===(se=this.form.get("chassis"))||void 0===se||se.updateValueAndValidity(),null===(ce=this.form.get("licensePlate"))||void 0===ce||ce.setValidators(A.kI.required))})}countProducts(){var t,n;null===(t=this.form.get("products"))||void 0===t||t.valueChanges.subscribe(()=>{var a;const p=null===(a=this.form.get("products"))||void 0===a?void 0:a.value;this.productsCount=null==p?void 0:p.length}),null===(n=this.form.get("equipments"))||void 0===n||n.valueChanges.subscribe(()=>{const a=this.equipments;this.checkEquipmentsIsValid();let p=0;a.forEach(f=>{var Z;return f.products&&"Remove"!==f.operation&&(p+=null===(Z=f.products)||void 0===Z?void 0:Z.length)}),this.equipmentsCount=p})}keyPress(t){!(t.charCode>=45&&t.charCode<=57)&&32!=t.charCode&&!(t.charCode>=65&&t.charCode<=90||t.charCode>=97&&t.charCode<=122)&&!(t.charCode>=192&&t.charCode<=254)&&t.preventDefault()}checkEquipmentsIsValid(){var t;const n=this.equipments;null===(t=this.form.get("equipments"))||void 0===t||t.setErrors(n.every(p=>{var f;return"Remove"==p.operation||(null===(f=p.products)||void 0===f?void 0:f.length)})?null:{required:!0})}cancel(){this.canceled.emit()}onOpenServicesPanel(){this.openServicesPanel.emit()}onOpenEquipmentsPanel(){this.openEquipmentsPanel.emit()}openServicesRegistrationPanel(){this.dialog.open(U.k,{height:"100vh",width:"100vw",maxWidth:"none",data:{assetData:this.assetData,rawValueForm:this.form.getRawValue(),form:this.form,subtype:this.subType}})}deleteRow(t,n){t.id?(t.operation=S.B.Remove,t.products&&(delete t.products,this.equipmentsCount--)):this.form.patchValue({equipments:this.equipments.filter((a,p)=>p!=n)}),this.disableAddEquipment=!1,this.validateEquipment()}manageEnterKey(t,n){13===t.keyCode&&t.target.blur()}setAggregateNecessaryProperties(){this.aggregate||(this.aggregate={},this.aggregate.equipments=new Array)}addEquipment(){var t,n,a;this.disableAddEquipment=!0,this.validateEquipment();const p={serialNumber:"N\xfamero de S\xe9rie",type:this.indexes.equipmentTypes[0],equipmentTypeId:this.indexes.equipmentTypes[0].id,declaredValue:0,description:"Equipamento",operation:S.B.Add,justFound:!1};if((null===(t=this.equipments)||void 0===t?void 0:t.length)>2){const f=this.modalService.open(y.z,{centered:!0});f.componentInstance.list=["Cada bem pode ter no m\xe1ximo 3 equipamentos cadastrados."],f.componentInstance.title="Equipamentos",f.componentInstance.type="error",f.componentInstance.cancelButtonText="Fechar",null===(n=f.closed)||void 0===n||n.subscribe(()=>{var Z;return null===(Z=this.equipments)||void 0===Z?void 0:Z.splice(0,1)})}null===(a=this.equipments)||void 0===a||a.unshift(p),this.equipmentTableRef.initRowEdit(this.equipments[0]),setTimeout(()=>{var f;null===(f=document.getElementById("equip-table-first-cell"))||void 0===f||f.click()},200)}onRowEditDone(t,n,a=!1){var p,f;if((null===(p=t.description)||void 0===p?void 0:p.length)>50)return t.description=null===(f=t.description)||void 0===f?void 0:f.slice(0,49),t.error=!0,void this.toastr.show("O campo n\xe3o poder ter mais de 50 caracteres","Excesso de caracteres",{toastClass:"alert-toast"});const Z=()=>{this.validateEquipment(),t.operation=t.id&&!t.justFound?S.B.Update:S.B.Add,this.equipments[n]&&(this.equipments[n].operation=t.operation),this.setEquipmentType(),t.error||(this.disableAddEquipment=!1)};a&&!t.id?this.controller.searchEquipment(this.assetData.quotationId,t.serialNumber).pipe((0,F.q)(1)).subscribe(W=>{this.validateNewEquipment(t,W||null),Z()}):Z()}validateNewEquipment(t,n=null){n&&(t.operation=(p=>this.equipments.find(f=>(null==f?void 0:f.id)==(null==p?void 0:p.id)))(n)?"Update":"Add",t.justFound=!0,setTimeout(()=>t.id=n.id,0)),this.form.patchValue({equipments:this.equipments.filter(p=>{if(p.serialNumber!=t.serialNumber||"Remove"!=p.operation)return p})})}onTypeChange(t){var n,a;t.id&&!t.justFound?(t.operation=S.B.Update,t.equipmentTypeId=null===(n=t.type)||void 0===n?void 0:n.id):(t.operation=S.B.Add,t.equipmentTypeId=null===(a=t.type)||void 0===a?void 0:a.id)}onRowEditBegin(t,n,a,p=!1){var f,Z;if(t.declaredValue>1e8)return t.error=!0,void this.toastr.show("O valor n\xe3o pode ser superior a R$ 100.000.000,00","Valor inv\xe1lido",{toastClass:"alert-toast"});t.error=!1,this.validateEquipment(),p&&(null===(f=t.products)||void 0===f?void 0:f.length)&&(null===(Z=this.confirmChangeAssetValue(!0))||void 0===Z||Z.subscribe(W=>{W&&(delete t.products,this.equipmentsCount--,setTimeout(()=>{var G;null===(G=document.getElementById(a.target.id+n))||void 0===G||G.click()},300))}))}validateEquipment(){if(this.equipments.map(t=>t.error=!1),this.tableHasErrors=!1,this.equipments.length>1){const t=this.equipments.reduce((a,p)=>(a[p.serialNumber]=++a[p.serialNumber]||0,a),{});let n=this.equipments.filter(a=>t[a.serialNumber]);n.length>0&&(this.tableHasErrors=!0,n.map(a=>a.error=!0))}this.equipments.map(t=>{"N\xfamero de S\xe9rie"===t.serialNumber||"Equipamento"===t.description||0===t.declaredValue?(this.tableHasErrors=!0,t.error=!0):(this.tableHasErrors=!1,t.error=!1)})}setEquipmentType(){var t,n;null===(n=null===(t=this.aggregate)||void 0===t?void 0:t.equipments)||void 0===n||n.map(a=>{var p,f;const Z=null===(f=null===(p=this.indexes)||void 0===p?void 0:p.equipmentTypes)||void 0===f?void 0:f.find(W=>(null==W?void 0:W.id)===(null==a?void 0:a.equipmentTypeId));a.type=Z})}saveAggregate(){var t,n,a;this.checkEquipmentsIsValid(),this.form.invalid&&(this.form.markAllAsTouched(),this.setInvalidControlList([{chassis:"Informe o chassi do implemento."},{invoiceNumber:"Informe o n\xfamero da NF do implemento."},{licensePlate:"Informe a placa do implemento."},{model:"Informe o modelo do implemento."},{year:"Informe o ano do implemento"},{renavam:"Informe o renavam do implemento"},{bodyTypeId:"Informe o tipo de carroceria."},{cargoTypeId:"Informe o tipo de carga."},{declaredValue:"Informe o valor declarado."},{products:"Selecione ao menos um servi\xe7o."},{equipments:"Selecione ao menos um servi\xe7o para cada equipamento adicionado."}])),this.form.valid&&(""==(null===(t=this.form.get("licensePlate"))||void 0===t?void 0:t.value)||"XXX-0000"==(null===(n=this.form.get("licensePlate"))||void 0===n?void 0:n.value)?null===(a=this.form.get("licensePlate"))||void 0===a||a.setValue(null):this.form.get("licensePlate"),this.formSubmitted.emit({asset:this.form.value,assetType:v.un.Auto,autoType:v.rQ.Aggregate}))}}return u.\u0275fac=function(t){return new(t||u)(e.Y36(e.zs3),e.Y36(o.uw),e.Y36(fe),e.Y36(he.FF),e.Y36(de._W))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-aggregate-form"]],viewQuery:function(t,n){if(1&t&&e.Gf(ge,5),2&t){let a;e.iGM(a=e.CRH())&&(n.equipmentTableRef=a.first)}},inputs:{indexes:"indexes",aggregate:"aggregate",assetData:"assetData",staticAssetTypes:"staticAssetTypes"},outputs:{openServicesPanel:"openServicesPanel",openEquipmentsPanel:"openEquipmentsPanel",formSubmitted:"formSubmitted",canceled:"canceled"},features:[e._Bn([fe]),e.qOj],decls:119,vars:29,consts:[[3,"formGroup"],[1,"row"],[1,"col-lg-12"],[1,"zero-km-form"],[1,"card"],[1,"row","d-flex","align-items-center"],[1,"col-lg-2"],[1,"form-group","d-flex","flex-column"],["for","isZeroKm"],["formControlName","isZeroKm","id","isZeroKm"],[1,"col-lg-4"],[1,"form-group","mt-3","mt-lg-0"],["for","chassiInput",3,"ngClass"],["type","text","id","chassiInput","aria-describedby","chassiHelp","formControlName","chassis","autocomplete","off",1,"form-control","text-uppercase"],[1,"form-group","mt-2","mt-lg-0"],["for","NFInput",3,"ngClass"],["type","number","id","NFInput","aria-describedby","NFHelp","formControlName","invoiceNumber",1,"form-control"],["id","",1,""],[1,"assets-form","mt-5"],[1,"d-flex","align-items-center","justify-content-center"],[1,"form-group"],["for","licensePlate","hidden","true"],["formControlName","licensePlate","id","licensePlate"],[1,"row","mt-5"],["for","aggregateTypeId",1,"required"],["type","text","id","aggregateTypeId","formControlName","aggregateTypeId",1,"form-control"],["value","",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[1,"col-lg-8"],["for","model",1,"required"],["type","text","id","model","formControlName","model",1,"form-control"],["for","aggregateYear",1,"required"],["formControlName","year","type","text","mask","0000","id","aggregateYear",1,"form-control"],["for","bodyType",1,"required"],["type","text","id","bodyType","formControlName","bodyTypeId",1,"form-control"],["value",""],["for","aggregateCargoType",1,"required"],["type","text","id","aggregateCargoType","formControlName","cargoTypeId",1,"form-control"],["for","declaredValue",1,"required"],["type","text","id","declaredValue","formControlName","declaredValue","currencyMask","","autocomplete","off",1,"form-control",3,"options","focus"],["for","renavam"],[1,"d-flex","align-items-center"],["type","text","formControlName","renavam","mask","00000000000",1,"form-control","ml-1"],[1,"row","mt-5",3,"ngClass"],[1,"d-flex","align-items-end","mb-3"],[1,"content-number","text-blue-400"],[1,"content-label"],[1,"card","p-3"],["type","button",1,"btn","btn-outline-primary","mb-3",2,"width","163px",3,"disabled","click"],["appPreventArrowKey","","dataKey","id","editMode","row","tableStyleClass","editable-table",3,"value"],["equipTable",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","ml-3","src","/assets/icons/attention-form.svg","alt","",4,"ngIf"],[1,"card","p-4","service-card"],[1,"d-flex","align-items-center","justify-content-between","w-10"],[1,"subtitle","medium-txt"],[1,"links",3,"disabled","ngClass","click"],[3,"ngClass"],[1,"ml-2","fas","fa-chevron-right"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-link","btn-fipe"],[1,"d-flex"],[1,"btn","btn-outline-light-atb",3,"click"],["type","submit","form","asset-register-vehicle-form",1,"btn","btn-success-atb","ml-3",3,"click"],[3,"value"],[1,"text-nowrap","text-primary",2,"width","20%"],[1,"text-nowrap","text-primary",2,"width","30%"],[3,"ngClass","ngStyle"],["pEditableColumn","","id","equip-table-first-cell",3,"ngClass"],["pTemplate","input"],["pTemplate","output"],["pEditableColumn","","id","equip-table-first-cell"],["pEditableColumn","",3,"ngClass"],[3,"id"],[1,"action-btn","btn",3,"click"],[1,"table-action","fas","fa-trash"],["pInputText","","type","text","maxlength","40",3,"ngModel","ngModelOptions","ngModelChange","focus","blur","keydown","keypress","change"],["appendTo","body","optionLabel","displayName",3,"options","ngModel","ngModelOptions","ngModelChange","onChange"],["pInputText","","type","text","maxlength","50",3,"ngModel","ngModelOptions","ngModelChange","focus","blur","keydown","keypress","change"],["id","equipment-declared-value","pInputText","","type","text","required","","currencyMask","","maxlength","11",3,"options","ngModel","ngModelOptions","ngModelChange","focus","blur","keydown"],[1,"border"],["src","/assets/icons/attention-form.svg","alt","",1,"ml-3"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"label",8),e._uU(9,"0 KM"),e.qZA(),e._UZ(10,"toggler",9),e.qZA()(),e.TgZ(11,"div",10)(12,"div",11)(13,"label",12),e._uU(14,"Chassi"),e.qZA(),e._UZ(15,"input",13),e.qZA()(),e.TgZ(16,"div",10)(17,"div",14)(18,"label",15),e._uU(19,"n\xfamero da NF"),e.qZA(),e._UZ(20,"input",16),e.qZA()()()()()()(),e.TgZ(21,"div",17)(22,"div",1)(23,"div",2)(24,"div",18)(25,"div",19)(26,"div",20)(27,"label",21),e._uU(28,"Placa"),e.qZA(),e._UZ(29,"app-license-plate",22),e.qZA()()()()()(),e.TgZ(30,"div",23)(31,"div",10)(32,"div",20)(33,"label",24),e._uU(34,"Tipo de implemento"),e.qZA(),e.TgZ(35,"select",25)(36,"option",26),e._uU(37,"Selecione"),e.qZA(),e.YNc(38,me,2,2,"option",27),e.qZA()()(),e.TgZ(39,"div",28)(40,"div",20)(41,"label",29),e._uU(42,"Modelo"),e.qZA(),e._UZ(43,"input",30),e.qZA()()(),e.TgZ(44,"div",1)(45,"div",10)(46,"div",20)(47,"label",31),e._uU(48,"Ano"),e.qZA(),e._UZ(49,"input",32),e.qZA()(),e.TgZ(50,"div",10)(51,"div",20)(52,"label",33),e._uU(53,"Tipo de carroceria"),e.qZA(),e.TgZ(54,"select",34)(55,"option",35),e._uU(56,"Selecione"),e.qZA(),e.YNc(57,Te,2,2,"option",27),e.qZA()()(),e.TgZ(58,"div",10)(59,"div",20)(60,"label",36),e._uU(61,"Tipo de carga"),e.qZA(),e.TgZ(62,"select",37)(63,"option",26),e._uU(64," Selecione "),e.qZA(),e.YNc(65,Ee,2,2,"option",27),e.qZA()()()(),e.TgZ(66,"div",1)(67,"div",10)(68,"div",20)(69,"label",38),e._uU(70,"Valor declarado"),e.qZA(),e.TgZ(71,"input",39),e.NdJ("focus",function(p){return n.checkDeclaredValue(p)}),e.qZA()()(),e.TgZ(72,"div",10)(73,"div",20)(74,"label",40),e._uU(75,"Renavam"),e.qZA(),e.TgZ(76,"div",41),e._UZ(77,"input",42),e.qZA()()()(),e.TgZ(78,"div",43)(79,"div",2)(80,"div",44)(81,"span",45),e._uU(82,"3"),e.qZA(),e.TgZ(83,"span",46),e._uU(84,"Cadastrar equipamentos"),e.qZA()(),e.TgZ(85,"div",47)(86,"button",48),e.NdJ("click",function(){return n.addEquipment()}),e._uU(87," + Adicionar "),e.qZA(),e.TgZ(88,"p-table",49,50),e.YNc(90,Ie,10,0,"ng-template",51),e.YNc(91,d,20,15,"ng-template",52),e.YNc(92,E,3,1,"ng-template",53),e.qZA()()()(),e.TgZ(93,"div",43)(94,"div",2)(95,"div",44)(96,"span",45),e._uU(97,"4"),e.qZA(),e.TgZ(98,"span",46),e._uU(99,"Escolha os servi\xe7os"),e.qZA(),e.YNc(100,O,1,0,"img",54),e.qZA(),e.TgZ(101,"div",55)(102,"div",56)(103,"span",57),e._uU(104," Selecione o plano de servi\xe7o "),e.qZA(),e.TgZ(105,"button",58),e.NdJ("click",function(){return n.openServicesRegistrationPanel()}),e.TgZ(106,"span",59),e._uU(107),e.qZA(),e._UZ(108,"i",60),e.qZA()()()()(),e.TgZ(109,"div",23)(110,"div",2)(111,"div",61)(112,"button",62),e._uU(113," Busca FIPE manual "),e.qZA(),e.TgZ(114,"div",63)(115,"button",64),e.NdJ("click",function(){return n.cancel()}),e._uU(116," Cancelar "),e.qZA(),e.TgZ(117,"button",65),e.NdJ("click",function(){return n.saveAggregate()}),e._uU(118),e.qZA()()()()()()),2&t){let a,p,f,Z;e.Q6J("formGroup",n.form),e.xp6(13),e.Q6J("ngClass",null!=(a=n.form.get("isZeroKm"))&&a.value?"required":""),e.xp6(5),e.Q6J("ngClass",null!=(p=n.form.get("isZeroKm"))&&p.value?"required":""),e.xp6(18),e.Q6J("disabled",!0),e.xp6(2),e.Q6J("ngForOf",null==n.indexes?null:n.indexes.autoAggregateTypes),e.xp6(19),e.Q6J("ngForOf",null==n.indexes?null:n.indexes.autoBodyTypes),e.xp6(6),e.Q6J("disabled",""!==(null==n.form||null==n.form.value?null:n.form.value.autoCargoTypes)),e.xp6(2),e.Q6J("ngForOf",null==n.indexes?null:n.indexes.autoCargoTypes),e.xp6(6),e.Q6J("options",e.DdM(19,te)),e.xp6(7),e.Q6J("ngClass",e.VKq(20,_e,n.setInvalidCss("equipments"))),e.xp6(8),e.Q6J("disabled",n.disableAddEquipment),e.xp6(2),e.Q6J("value",n.equipments),e.xp6(5),e.Q6J("ngClass",e.VKq(22,_e,n.setInvalidCss("products"))),e.xp6(7),e.Q6J("ngIf",n.setInvalidCss("products")),e.xp6(5),e.Q6J("disabled",n.tableHasErrors||!(null!=(f=n.form.get("declaredValue"))&&f.value))("ngClass",e.VKq(24,ke,n.tableHasErrors||!(null!=(Z=n.form.get("declaredValue"))&&Z.value))),e.xp6(1),e.Q6J("ngClass",e.WLB(26,He,!n.productsCount&&!n.equipmentsCount,n.productsCount||n.equipmentsCount)),e.xp6(1),e.Oqu(n.productsCount||n.equipmentsCount?n.productsCount+n.equipmentsCount===1?"1 atribu\xeddo":n.productsCount+n.equipmentsCount+" atribu\xeddos":"Nenhum atribu\xeddo"),e.xp6(11),e.hij(" ",n.aggregate?"Confirmar":"Salvar"," ")}},directives:[A._Y,A.JL,A.sg,q.MU,q.HK,ue.u,A.JJ,A.u,b.mk,A.Fj,q.oH,A.wV,J,A.EJ,A.YN,A.Kr,b.sg,ye.hx,x.g1,_.iA,I.s,H.jx,b.PC,_.Wq,_.YL,A.nD,A.On,re.Lt,A.Q7,b.O5],pipes:[b.rS,b.H9],styles:[".card[_ngcontent-%COMP%]{padding:1rem}.btn[_ngcontent-%COMP%]:not(.action-btn){height:40px;min-width:136px}.btn-fipe[_ngcontent-%COMP%]{font-size:14px}.content-number[_ngcontent-%COMP%]{font-weight:700;font-size:30px;line-height:35px}.content-label[_ngcontent-%COMP%]{font-weight:500;font-size:20px;color:#707a84;line-height:28px;margin-left:.5rem}.service-card[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]{cursor:pointer;background-color:transparent;border:none}.service-card[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]:not(.not-allowed):hover{text-decoration:underline}.service-card[_ngcontent-%COMP%]   .links.not-allowed[_ngcontent-%COMP%]{cursor:not-allowed!important}@media screen and (max-width: 768px){.btn[_ngcontent-%COMP%]{min-width:auto}}"]}),u})();var We=r(8372),je=r(3900),ze=r(4004),Ge=r(590),$e=r(2340),Xe=r(8550),et=r(5871),tt=r(520);let nt=(()=>{class u{constructor(t,n){this.http=t,this.injector=n,this._http=(0,Xe.d)(this.injector,[et.n])}search(t,n){return this._http.post(`${$e.N.baseURL}/fipe/search`,{type:t,terms:n,precise:!0,skip:0,take:10})}getFipeData(t){return this._http.post(`${$e.N.baseURL}/fipe/data`,{ourFipe:t})}}return u.\u0275fac=function(t){return new(t||u)(e.LFG(tt.eN),e.LFG(e.zs3))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();var ot=r(1616);const it=["equipTable"];function lt(u,w){1&u&&e._UZ(0,"img",84)}function at(u,w){if(1&u&&e._UZ(0,"ngb-highlight",85),2&u){const n=w.term;e.Q6J("result",w.result.description)("term",n)}}const st=function(u){return{right:u}};function rt(u,w){if(1&u&&e._UZ(0,"div",86),2&u){const t=e.oxw();e.Q6J("ngStyle",e.VKq(1,st,t.form.pristine||"PENDING"==t.form.controls.model.status?"3%":"5%"))}}function ct(u,w){if(1&u&&(e.TgZ(0,"option",87),e._uU(1),e.qZA()),2&u){const t=w.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.displayName," ")}}function dt(u,w){if(1&u&&(e.TgZ(0,"option",87),e._uU(1),e.qZA()),2&u){const t=w.$implicit;e.Q6J("value",t.federationUnit),e.xp6(1),e.hij(" ",null==t?null:t.displayName," ")}}function ut(u,w){if(1&u&&(e.TgZ(0,"option",87),e._uU(1),e.qZA()),2&u){const t=w.$implicit;e.Q6J("value",null==t?null:t.id),e.xp6(1),e.hij(" ",null==t?null:t.displayName," ")}}function pt(u,w){if(1&u&&(e.TgZ(0,"div",47)(1,"label",88),e._uU(2,"Tipo de Implemento"),e.qZA(),e.TgZ(3,"select",89)(4,"option",90),e._uU(5," N\xe3o possui "),e.qZA(),e.YNc(6,ut,2,2,"option",37),e.qZA()()),2&u){const t=e.oxw();e.xp6(4),e.Q6J("ngValue",null),e.xp6(2),e.Q6J("ngForOf",null==t.indexes?null:t.indexes.autoAggregateTypes)}}function mt(u,w){if(1&u&&(e.TgZ(0,"option",87),e._uU(1),e.qZA()),2&u){const t=w.$implicit;e.Q6J("value",null==t?null:t.id),e.xp6(1),e.hij(" ",null==t?null:t.displayName," ")}}function _t(u,w){1&u&&(e.TgZ(0,"div",101)(1,"div",102)(2,"label",103),e._uU(3,"Sinistrado/REM/Leiloado"),e.qZA(),e._UZ(4,"toggler",104),e.qZA()())}const Ue=function(){return{prefix:"R$ ",thousands:".",decimal:",",align:"left",nullable:!0}};function gt(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",14)(2,"div",25)(3,"label",91),e._uU(4,"Proteger carroceria"),e.qZA(),e.TgZ(5,"div",81)(6,"toggler",92),e.NdJ("appPreventEvent",function(a){return e.CHM(t),e.oxw().checkOurFipe(a)}),e.qZA(),e._UZ(7,"input",93),e.qZA(),e.TgZ(8,"div",94)(9,"label",95),e._uU(10,"Tipo de carroceria"),e.qZA(),e.TgZ(11,"select",96)(12,"option",36),e._uU(13,"Selecione"),e.qZA(),e.YNc(14,mt,2,2,"option",37),e.qZA()()()(),e.TgZ(15,"div",97)(16,"label",91),e._uU(17,"Proteger Eixo Adicional"),e.qZA(),e.TgZ(18,"div",51)(19,"toggler",98),e.NdJ("appPreventEvent",function(a){return e.CHM(t),e.oxw().checkOurFipe(a)}),e.qZA(),e._UZ(20,"input",99),e.qZA()(),e.YNc(21,_t,5,0,"div",100),e.qZA()}if(2&u){const t=e.oxw();let n,a;e.xp6(7),e.Q6J("options",e.DdM(5,Ue)),e.xp6(5),e.Q6J("disabled",null==(n=t.form.get("bodyTypeId"))?null:n.value),e.xp6(2),e.Q6J("ngForOf",null==t.indexes?null:t.indexes.autoBodyTypes),e.xp6(6),e.Q6J("options",e.DdM(6,Ue)),e.xp6(1),e.Q6J("ngIf",!(null!=(a=t.form.get("isZeroKm"))&&a.value))}}function ht(u,w){1&u&&(e.TgZ(0,"div",101)(1,"div",102)(2,"label",103),e._uU(3,"Sinistrado/REM/Leiloado"),e.qZA(),e._UZ(4,"toggler",104),e.qZA()())}function vt(u,w){if(1&u&&(e.TgZ(0,"div",22),e.YNc(1,ht,5,0,"div",100),e.qZA()),2&u){const t=e.oxw();let n;e.xp6(1),e.Q6J("ngIf",!(null!=(n=t.form.get("isZeroKm"))&&n.value))}}function ft(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"option",105),e.NdJ("select",function(){const p=e.CHM(t).$implicit;return e.oxw().setSecurityDevice(p)}),e._uU(1),e.qZA()}if(2&u){const t=w.$implicit;e.Q6J("value",t.id),e.xp6(1),e.hij(" ",t.displayName," ")}}function xt(u,w){1&u&&(e.TgZ(0,"tr")(1,"th",106),e._uU(2," N\xfamero de s\xe9rie "),e.qZA(),e.TgZ(3,"th",106),e._uU(4,"Tipo"),e.qZA(),e.TgZ(5,"th",107),e._uU(6," Nome / Modelo "),e.qZA(),e.TgZ(7,"th",106),e._uU(8,"Valor"),e.qZA(),e._UZ(9,"th"),e.qZA())}function Ct(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"input",117),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.serialNumber=a})("focus",function(a){e.CHM(t);const p=e.oxw(),f=p.$implicit,Z=p.rowIndex;return e.oxw().onRowEditBegin(f,Z,a)})("blur",function(){e.CHM(t);const a=e.oxw(),p=a.$implicit,f=a.rowIndex;return e.oxw().onRowEditDone(p,f,!0)})("keydown",function(a){e.CHM(t);const p=e.oxw().$implicit;return e.oxw().manageEnterKey(a,p)})("keypress",function(a){return e.CHM(t),e.oxw(2).keyPress(a)})("change",function(){e.CHM(t);const a=e.oxw().$implicit;return a.serialNumber=a.serialNumber.trim()}),e.qZA()}if(2&u){const t=e.oxw().$implicit;e.Q6J("ngModel",t.serialNumber)}}function bt(u,w){if(1&u&&e._uU(0),2&u){const t=e.oxw().$implicit;e.hij(" ",null==t?null:t.serialNumber," ")}}function yt(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"p-dropdown",118),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.type=a})("onChange",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw().onTypeChange(a)}),e.qZA()}if(2&u){const t=e.oxw().$implicit,n=e.oxw();e.Q6J("options",null==n.indexes?null:n.indexes.equipmentTypes)("ngModel",t.type)}}function Tt(u,w){if(1&u&&e._uU(0),2&u){const t=e.oxw().rowIndex,n=e.oxw();e.hij(" ",null==n.equipments[t]||null==n.equipments[t].type?null:n.equipments[t].type.displayName," ")}}function At(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"input",119),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.description=a})("focus",function(a){e.CHM(t);const p=e.oxw(),f=p.$implicit,Z=p.rowIndex;return e.oxw().onRowEditBegin(f,Z,a)})("blur",function(){e.CHM(t);const a=e.oxw(),p=a.$implicit,f=a.rowIndex;return e.oxw().onRowEditDone(p,f)})("keydown",function(a){e.CHM(t);const p=e.oxw().$implicit;return e.oxw().manageEnterKey(a,p)})("keypress",function(a){return e.CHM(t),e.oxw(2).keyPress(a)})("change",function(){e.CHM(t);const a=e.oxw().$implicit;return a.description=a.description.trim()}),e.qZA()}if(2&u){const t=e.oxw().$implicit;e.Q6J("ngModel",t.description)}}function Pt(u,w){if(1&u&&(e._uU(0),e.ALo(1,"titlecase")),2&u){const t=e.oxw().$implicit;e.hij(" ",e.lcZ(1,1,null==t?null:t.description)," ")}}const Mt=function(){return{prefix:"R$ ",thousands:".",decimal:",",align:"left",nullable:!1}};function Et(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"input",120),e.NdJ("ngModelChange",function(a){return e.CHM(t),e.oxw().$implicit.declaredValue=a})("focus",function(a){e.CHM(t);const p=e.oxw(),f=p.$implicit,Z=p.rowIndex;return e.oxw().onRowEditBegin(f,Z,a,!0)})("blur",function(){e.CHM(t);const a=e.oxw(),p=a.$implicit,f=a.rowIndex;return e.oxw().onRowEditDone(p,f)})("keydown",function(a){e.CHM(t);const p=e.oxw().$implicit;return e.oxw().manageEnterKey(a,p)}),e.qZA()}if(2&u){const t=e.oxw().$implicit;e.Q6J("options",e.DdM(2,Mt))("ngModel",t.declaredValue)}}function Ot(u,w){if(1&u&&(e._uU(0),e.ALo(1,"currency")),2&u){const t=e.oxw().$implicit;e.hij(" ",e.xi3(1,1,null==t?null:t.declaredValue,"BRL")," ")}}const wt=function(u){return{"row-error":u}},It=function(){return{display:"none"}},Ne=function(u){return{"cell-error":u}};function Zt(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"tr",108)(1,"td",109)(2,"p-cellEditor"),e.YNc(3,Ct,1,1,"ng-template",110),e.YNc(4,bt,1,1,"ng-template",111),e.qZA()(),e.TgZ(5,"td",112)(6,"p-cellEditor"),e.YNc(7,yt,1,2,"ng-template",110),e.YNc(8,Tt,1,1,"ng-template",111),e.qZA()(),e.TgZ(9,"td",113)(10,"p-cellEditor"),e.YNc(11,At,1,1,"ng-template",110),e.YNc(12,Pt,2,3,"ng-template",111),e.qZA()(),e.TgZ(13,"td",113)(14,"p-cellEditor",114),e.YNc(15,Et,1,3,"ng-template",110),e.YNc(16,Ot,2,4,"ng-template",111),e.qZA()(),e.TgZ(17,"td")(18,"button",115),e.NdJ("click",function(){const a=e.CHM(t),p=a.$implicit,f=a.rowIndex;return e.oxw().deleteRow(p,f)}),e._UZ(19,"i",116),e.qZA()()()}if(2&u){const t=w.$implicit,n=w.rowIndex;e.Q6J("ngClass",e.VKq(6,wt,t.error))("ngStyle","Remove"===(null==t?null:t.operation)?e.DdM(8,It):null),e.xp6(1),e.Q6J("ngClass",e.VKq(9,Ne,"N\xfamero de S\xe9rie"===(null==t?null:t.serialNumber))),e.xp6(8),e.Q6J("ngClass",e.VKq(11,Ne,"Equipamento"===t.description)),e.xp6(4),e.Q6J("ngClass",e.VKq(13,Ne,0===t.declaredValue)),e.xp6(1),e.Q6J("id","equipment-declared-value"+n)}}function qt(u,w){1&u&&(e.TgZ(0,"tr",121)(1,"td"),e._uU(2," Clique em Adicionar para incluir um equipamento. "),e.qZA()()),2&u&&(e.xp6(1),e.uIk("colspan",4))}function Dt(u,w){1&u&&e._UZ(0,"img",84)}const Ve=function(u){return{"invalid-form-item":u}},Ke=function(u){return{required:u}},St=function(u){return{"not-allowed":u}},Ft=function(u,w){return{"text-gray-300":u,"text-green-200":w}};let Ut=(()=>{class u extends le.o{constructor(t,n,a,p,f,Z){super(t,f),this.injector=t,this.fipeService=n,this.dialog=a,this.vehicleFormFacade=p,this.modalService=f,this.toastr=Z,this.vehicle={},this.openServicesPanel=new e.vpe,this.openEquipmentsPanel=new e.vpe,this.formSubmitted=new e.vpe,this.canceled=new e.vpe,this.equipmentTable=[],this.productsCount$=new s.x,this.productsCount=0,this.equipmentsCount=0,this.controlInvoiceValueStateOnEdit=()=>{var W,G,ie;return(null===(W=this.vehicle)||void 0===W?void 0:W.isZeroKm)&&(null===(ie=null===(G=this.form)||void 0===G?void 0:G.get("invoiceValue"))||void 0===ie?void 0:ie.enable())},this.search=W=>W.pipe((0,We.b)(300),(0,R.x)(),(0,g.b)(()=>this.searching=!0),(0,je.w)(G=>""===G?(0,i.of)([]):this.fipeService.search(this._vehicleType,G).pipe((0,R.x)(),(0,g.b)(()=>this.searchFailed=!1),(0,C.K)(()=>(this.searchFailed=!0,(0,i.of)([{description:"Busca FIPE n\xe3o retornou resultados."}]))))),(0,g.b)(()=>this.searching=!1)),this.formatter=W=>W.description,this.disableAddEquipment=!1}set vehicleType(t){this._vehicleType={Light:"Cars",Heavy:"Trucks",Motorcycle:"Motorcycles"}[t]}set staticAssetTypes(t){null==t||t.map(n=>"Auto"===n.displayName&&(this.subType=n.subTypes))}ngOnInit(){var t;this.form=this.formBuilder.group({isZeroKm:[!1],vehicleId:[null],colorId:["",A.kI.required],bodyTypeId:[""],aggregateTypeId:["","Trucks"===this._vehicleType?A.kI.required:null],securityDeviceId:["",A.kI.required],licensingFederationUnit:["",A.kI.required],chassis:[null,(0,ne.Jw)()],invoiceValue:[{value:null,disabled:!0},A.kI.required],vehicleValue:[null],licensePlate:[null,A.kI.required],renavam:[null,this.assetData.isQuotation?!A.kI.required:A.kI.required],manufacturer:[null],model:[null,{validators:[A.kI.required],asyncValidators:[this.onFipeVehicleModelSelect()]}],yearModel:[null],protectAdditionalAxle:[!1],protectBody:[!1],additionalAxleValue:[{value:0,disabled:!0},A.kI.required],bodyValue:[{value:0,disabled:!0},A.kI.required],securityDeviceCompanyName:[{value:null,disabled:!0},A.kI.required],securityDeviceCompanyContact:[{value:null,disabled:!0},A.kI.required],products:[[],A.kI.required],equipments:[[]],fipeCode:[{value:null,disabled:!0},A.kI.required],fipeValue:[{value:0,disabled:!0},A.kI.required],vehicleType:[{value:null,disabled:!0},A.kI.required],isDamaged:[!1],protectTruckBody:[!1],isLocked:[!1]}),this.updateValidator(),$("#collapseBodyTypeIdAssetRegister").collapse("hide"),$("#collapseAlienatedVehicleNameAssetRegister").collapse("hide"),this.controlProtectBodySwitchEvents(),this.controlAxlValueSwitchEvents(),this.controlSecurityDeviceDetailsEvents(),this.countProducts(),this.vehicleFormFacade.controlIsZeroKmEvents(this.form,$),this.vehicleFormFacade.validityChassisAndPlate(this.form,this.assetData),(null===(t=this.vehicle)||void 0===t?void 0:t.id)&&this.loadForm(),this.vehicle.equipments=this.equipments,this.setEquipmentType()}get equipments(){var t;return null===(t=this.form.get("equipments"))||void 0===t?void 0:t.value}loadForm(){console.log(this.vehicle),this.form.addControl("id",new A.NI([""])),this.vehicleFormFacade.patchVehicleFormValue(this.form,this.vehicle),setTimeout(()=>{this.controlLicensePlateStateOnEdit(),this.controlSecurityDeviceDetailsStateOnEdit(),this.controlInvoiceValueStateOnEdit(),this.controlBodyValueOnEdit(),this.controlAditionalAxleBodyOnEdit()},500)}keyPress(t){!(t.charCode>=45&&t.charCode<=57)&&32!=t.charCode&&!(t.charCode>=65&&t.charCode<=90||t.charCode>=97&&t.charCode<=122)&&!(t.charCode>=192&&t.charCode<=254)&&t.preventDefault()}checkOurFipe(t){var n,a;(null===(n=this.form.get("products"))||void 0===n?void 0:n.value.length)&&(null==t||t.stopPropagation(),null===(a=this.confirmChangeAssetValue())||void 0===a||a.subscribe(p=>{var f;p&&(null===(f=this.form.get("products"))||void 0===f||f.setValue([]),"text"==t.target.getAttribute("type")?t.target.focus():t.target.click())}))}confirmChangeAssetValue(t=!1){const n=this.modalService.open(y.z,{centered:!0});return n.componentInstance.list=t?["Os servi\xe7os deste equipamento ser\xe3o removidos caso este campo seja alterado. Deseja continuar?"]:["Os servi\xe7os deste bem (com exce\xe7\xe3o dos servi\xe7os dos equipamentos) ser\xe3o removidos caso este campo seja alterado. Deseja continuar?"],n.componentInstance.title="Cuidado!",n.componentInstance.type="alert",n.componentInstance.confirmButtonText="Sim",n.componentInstance.cancelButtonText="N\xe3o",n.closed}controlIsLocked(){var t;null===(t=this.form.get("isLocked"))||void 0===t||t.valueChanges.pipe((0,R.x)()).subscribe(n=>{var a,p,f,Z,W,G,ie,se,ce,ve;n?(null===(a=this.form.get("colorId"))||void 0===a||a.disable(),null===(p=this.form.get("licensePlate"))||void 0===p||p.disable(),null===(f=this.form.get("ourFipe"))||void 0===f||f.disable(),null===(Z=this.form.get("renavam"))||void 0===Z||Z.disable(),null===(W=this.form.get("securityDeviceId"))||void 0===W||W.disable()):(null===(G=this.form.get("colorId"))||void 0===G||G.enable(),null===(ie=this.form.get("licensePlate"))||void 0===ie||ie.enable(),null===(se=this.form.get("ourFipe"))||void 0===se||se.enable(),null===(ce=this.form.get("renavam"))||void 0===ce||ce.enable(),null===(ve=this.form.get("securityDeviceId"))||void 0===ve||ve.enable())})}controlLicensePlateStateOnEdit(){var t,n,a,p,f;(null===(t=this.vehicle)||void 0===t?void 0:t.isZeroKm)&&(null===(n=this.form.get("isDamaged"))||void 0===n||n.setValue(!1),console.log(null===(a=this.form.get("isDamaged"))||void 0===a?void 0:a.value),null===(p=this.form.get("isDamaged"))||void 0===p||p.disable(),null===(f=this.form.get("vehicleValue"))||void 0===f||f.enable())}controlProtectBodySwitchEvents(){var t;null===(t=this.form.get("protectBody"))||void 0===t||t.valueChanges.pipe((0,R.x)()).subscribe(n=>{var a,p,f,Z;Boolean(n)?(null===(a=this.form.get("bodyValue"))||void 0===a||a.enable(),$("#collapseBodyTypeIdAssetRegister").show("toggle")):(null===(p=this.form.get("bodyValue"))||void 0===p||p.setValue(""),null===(f=this.form.get("bodyValue"))||void 0===f||f.disable(),null===(Z=this.form.get("bodyTypeId"))||void 0===Z||Z.setValue(null),$("#collapseBodyTypeIdAssetRegister").hide("toggle"))})}controlAxlValueSwitchEvents(){var t;null===(t=this.form.get("protectAdditionalAxle"))||void 0===t||t.valueChanges.pipe((0,R.x)()).subscribe(n=>{var a,p,f;n?null===(a=this.form.get("additionalAxleValue"))||void 0===a||a.enable():(null===(p=this.form.get("additionalAxleValue"))||void 0===p||p.setValue(""),null===(f=this.form.get("additionalAxleValue"))||void 0===f||f.disable())})}controlBodyValueOnEdit(){var t;this.vehicle.protectBody&&(null===(t=this.form.get("bodyValue"))||void 0===t||t.enable(),$("#collapseBodyTypeIdAssetRegister").show("show"))}controlAditionalAxleBodyOnEdit(){var t;this.vehicle.protectAdditionalAxle&&(null===(t=this.form.get("additionalAxleValue"))||void 0===t||t.enable())}controlSecurityDeviceDetailsEvents(){var t;null===(t=this.form.get("securityDeviceId"))||void 0===t||t.valueChanges.pipe((0,R.x)()).subscribe(n=>{var a,p,f,Z,W,G,ie,se;this.selectedSecurityDevice=null===(a=this.indexes)||void 0===a?void 0:a.securityDevices.filter(ce=>ce.id===n),null===(p=this.form.get("securityDeviceCompanyName"))||void 0===p||p.setValue(null),null===(f=this.form.get("securityDeviceCompanyContact"))||void 0===f||f.setValue(null),(null===(Z=this.selectedSecurityDevice[0])||void 0===Z?void 0:Z.requireDetails)?(null===(W=this.form.get("securityDeviceCompanyName"))||void 0===W||W.enable(),null===(G=this.form.get("securityDeviceCompanyContact"))||void 0===G||G.enable()):(null===(ie=this.form.get("securityDeviceCompanyName"))||void 0===ie||ie.disable(),null===(se=this.form.get("securityDeviceCompanyContact"))||void 0===se||se.disable())})}controlSecurityDeviceDetailsStateOnEdit(){var t,n,a,p,f,Z,W;const G=null===(t=this.form.get("securityDeviceId"))||void 0===t?void 0:t.value;this.selectedSecurityDevice=null===(n=this.indexes)||void 0===n?void 0:n.securityDevices.filter(ie=>ie.id===G),(null===(a=this.selectedSecurityDevice[0])||void 0===a?void 0:a.requireDetails)?(null===(p=this.form.get("securityDeviceCompanyName"))||void 0===p||p.enable(),null===(f=this.form.get("securityDeviceCompanyContact"))||void 0===f||f.enable()):(null===(Z=this.form.get("securityDeviceCompanyName"))||void 0===Z||Z.disable(),null===(W=this.form.get("securityDeviceCompanyContact"))||void 0===W||W.disable())}controlIsZeroKmEvents(){var t;null===(t=this.form.get("isZeroKm"))||void 0===t||t.valueChanges.pipe((0,R.x)()).subscribe(n=>{var a,p,f,Z,W,G,ie,se,ce,ve,xe,Ce,be;Boolean(n)?(null===(a=this.form.get("isDamaged"))||void 0===a||a.setValue(!1),null===(p=this.form.get("isDamaged"))||void 0===p||p.disable(),null===(f=this.form.get("invoiceValue"))||void 0===f||f.enable(),null===(Z=this.form.get("licensePlate"))||void 0===Z||Z.clearValidators(),null===(W=this.form.get("chassis"))||void 0===W||W.setValidators([A.kI.required,(0,ne.Jw)()]),console.log(null===(G=this.form.get("isDamaged"))||void 0===G?void 0:G.value)):(null===(ie=this.form.get("isDamaged"))||void 0===ie||ie.enable(),null===(se=this.form.get("invoiceValue"))||void 0===se||se.disable(),null===(ce=this.form.get("invoiceValue"))||void 0===ce||ce.setValue(""),null===(ve=this.form.get("licensePlate"))||void 0===ve||ve.setValidators(A.kI.required),null===(xe=this.form.get("chassis"))||void 0===xe||xe.clearValidators(),null===(Ce=this.form.get("chassis"))||void 0===Ce||Ce.setValidators((0,ne.Jw)()),null===(be=this.form.get("chassis"))||void 0===be||be.updateValueAndValidity())})}countProducts(){var t,n;null===(t=this.form.get("products"))||void 0===t||t.valueChanges.subscribe(()=>{var a;const p=null===(a=this.form.get("products"))||void 0===a?void 0:a.value;this.productsCount=null==p?void 0:p.length}),null===(n=this.form.get("equipments"))||void 0===n||n.valueChanges.subscribe(()=>{const a=this.equipments;this.checkEquipmentsIsValid();let p=0;a.forEach(f=>{var Z;return f.products&&"Remove"!==f.operation&&(p+=null===(Z=f.products)||void 0===Z?void 0:Z.length)}),this.equipmentsCount=p})}checkEquipmentsIsValid(){var t;const n=this.equipments;null===(t=this.form.get("equipments"))||void 0===t||t.setErrors(n.every(p=>{var f;return"Remove"==p.operation||(null===(f=p.products)||void 0===f?void 0:f.length)})?null:{required:!0})}setEquipmentType(){var t;null===(t=this.equipments)||void 0===t||t.map(n=>{var a,p;const f=null===(p=null===(a=this.indexes)||void 0===a?void 0:a.equipmentTypes)||void 0===p?void 0:p.find(Z=>(null==Z?void 0:Z.id)===(null==n?void 0:n.equipmentTypeId));n.type=f})}setSecurityDevice(t){this.selectedSecurityDevice=t}cancel(){this.canceled.emit()}onFipeVehicleModelSelect(){return t=>t.value.ourFipe&&""!=t.value.ourFipe?this.fipeService.getFipeData(t.value.ourFipe).pipe((0,F.q)(1),(0,g.b)(n=>{this._isDamaged={damaged:n.damagedCoverage,normal:n.normalCoverage},this.setFipeData(n)}),(0,ze.U)(n=>null),(0,Ge.P)()):(0,i.of)({invalidFipeModel:!0}).pipe((0,g.b)(()=>this.searching=!1))}setFipeData(t){this.form.patchValue({fipeCode:t.fipeCode,ourFipe:t.ourFipe,fipeValue:t.value,vehicleType:t.type,year:t.year,manufacturer:t.manufacturer,fuel:t.fuel})}openServicesRegistrationPanel(){this.dialog.open(U.k,{height:"100vh",width:"100vw",maxWidth:"none",disableClose:!0,closeOnNavigation:!0,data:{assetData:this.assetData,rawValueForm:this.form.getRawValue(),form:this.form,subtype:this.subType}})}addEquipment(){var t,n,a;this.disableAddEquipment=!0,this.validateEquipment();const p={serialNumber:"N\xfamero de S\xe9rie",type:this.indexes.equipmentTypes[0],equipmentTypeId:this.indexes.equipmentTypes[0].id,declaredValue:0,description:"Equipamento",operation:S.B.Add,justFound:!1};if((null===(t=this.equipments)||void 0===t?void 0:t.length)>2){const f=this.modalService.open(y.z,{centered:!0});f.componentInstance.list=["Cada bem pode ter no m\xe1ximo 3 equipamentos cadastrados."],f.componentInstance.title="Equipamentos",f.componentInstance.type="error",f.componentInstance.cancelButtonText="Fechar",null===(n=f.closed)||void 0===n||n.subscribe(()=>{var Z;return null===(Z=this.equipments)||void 0===Z?void 0:Z.splice(0,1)})}null===(a=this.equipments)||void 0===a||a.unshift(p),this.equipmentTableRef.initRowEdit(this.equipments[0]),setTimeout(()=>{var f;null===(f=document.getElementById("equip-table-first-cell"))||void 0===f||f.click()},200)}onRowEditBegin(t,n,a,p=!1){var f,Z;this.validateEquipment(),p&&(null===(f=t.products)||void 0===f?void 0:f.length)&&(null===(Z=this.confirmChangeAssetValue(!0))||void 0===Z||Z.subscribe(W=>{W&&(delete t.products,this.equipmentsCount--,setTimeout(()=>{var G;null===(G=document.getElementById(a.target.id+n))||void 0===G||G.click()},300))}))}onRowEditDone(t,n,a=!1){var p,f;if(t.declaredValue>1e8)return t.error=!0,void this.toastr.show("O valor n\xe3o pode ser superior a R$ 100.000.000,00","Valor inv\xe1lido",{toastClass:"alert-toast"});if((null===(p=t.description)||void 0===p?void 0:p.length)>50)return t.description=null===(f=t.description)||void 0===f?void 0:f.slice(0,49),t.error=!0,void this.toastr.show("O campo n\xe3o poder ter mais de 50 caracteres","Excesso de caracteres",{toastClass:"alert-toast"});t.error=!1;const Z=()=>{this.validateEquipment(),t.operation=t.id&&!t.justFound?S.B.Update:S.B.Add,this.equipments[n]&&(this.equipments[n].operation=t.operation),this.setEquipmentType(),t.error||(this.disableAddEquipment=!1)};a&&!t.id?this.vehicleFormFacade.searchEquipment(this.assetData.quotationId,t.serialNumber).pipe((0,F.q)(1)).subscribe(W=>{this.validateNewEquipment(t,W||null),Z()}):Z()}validateNewEquipment(t,n=null){n&&(t.operation=(p=>this.equipments.find(f=>(null==f?void 0:f.id)==(null==p?void 0:p.id)))(n)?"Update":"Add",t.justFound=!0,setTimeout(()=>t.id=n.id,0)),this.form.patchValue({equipments:this.equipments.filter(p=>{if(p.serialNumber!=t.serialNumber||"Remove"!=p.operation)return p})})}onTypeChange(t){var n,a;t.id&&!t.justFound?(t.operation=S.B.Update,t.equipmentTypeId=null===(n=t.type)||void 0===n?void 0:n.id):(t.operation=S.B.Add,t.equipmentTypeId=null===(a=t.type)||void 0===a?void 0:a.id)}manageEnterKey(t,n){13===t.keyCode&&t.target.blur()}deleteRow(t,n){t.id?(t.operation=S.B.Remove,t.products&&(delete t.products,this.equipmentsCount--)):this.form.patchValue({equipments:this.equipments.filter((a,p)=>p!=n)}),this.disableAddEquipment=!1,this.validateEquipment()}validateEquipment(){if(this.equipments.map(t=>t.error=!1),this.tableHasErrors=!1,this.equipments.length>1){const t=this.equipments.reduce((a,p)=>(a[p.serialNumber]=++a[p.serialNumber]||0,a),{});let n=this.equipments.filter(a=>t[a.serialNumber]);n.length>0&&(this.tableHasErrors=!0,n.map(a=>a.error=!0))}this.equipments.map(t=>{"N\xfamero de S\xe9rie"===t.serialNumber||"Equipamento"===t.description||0===t.declaredValue?(this.tableHasErrors=!0,t.error=!0):(this.tableHasErrors=!1,t.error=!1)})}updateValidator(){var t;"Trucks"===this._vehicleType&&(null===(t=this.form.get("aggregateTypeId"))||void 0===t||t.valueChanges.pipe((0,R.x)()).subscribe(n=>{var a,p,f;null===n?null===(a=this.form.get("aggregateTypeId"))||void 0===a||a.clearValidators():null===(p=this.form.get("aggregateTypeId"))||void 0===p||p.setValidators([A.kI.required]),null===(f=this.form.get("aggregateTypeId"))||void 0===f||f.updateValueAndValidity()}))}saveVehicle(){var t,n,a;this.checkEquipmentsIsValid(),this.form.invalid&&this.setInvalidControlList([{chassis:"Informe o chassi do ve\xedculo."},{invoiceValue:"Informe o valor da NF do ve\xedculo."},{licensePlate:"Informe a placa do ve\xedculo."},{yearModel:"Informe o modelo do ve\xedculo."},{colorId:"Informe a cor do ve\xedculo."},{renavam:"Informe o renavam"},{licensingFederationUnit:"Informe a UF de licenciamento do ve\xedculo."},{securityDeviceId:"Informe o dispositivo de seguran\xe7a do ve\xedculo."},{aggregateTypeId:"Informe o tipo de implemento do ve\xedculo."},{products:"Selecione ao menos um servi\xe7o."},{equipments:"Selecione ao menos um servi\xe7o para cada equipamento adicionado."}]),this.form.valid&&(""==(null===(t=this.form.get("licensePlate"))||void 0===t?void 0:t.value)||"XXX-0000"==(null===(n=this.form.get("licensePlate"))||void 0===n?void 0:n.value)?null===(a=this.form.get("licensePlate"))||void 0===a||a.setValue(null):this.form.get("licensePlate"),this.formSubmitted.emit({asset:this.form.value,assetType:v.un.Auto,autoType:this._vehicleType}))}ngOnDestroy(){}}return u.\u0275fac=function(t){return new(t||u)(e.Y36(e.zs3),e.Y36(nt),e.Y36(o.uw),e.Y36(fe),e.Y36(he.FF),e.Y36(de._W))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-vehicle-form"]],viewQuery:function(t,n){if(1&t&&e.Gf(it,5),2&t){let a;e.iGM(a=e.CRH())&&(n.equipmentTableRef=a.first)}},inputs:{vehicle:"vehicle",indexes:"indexes",assetData:"assetData",vehicleType:"vehicleType",staticAssetTypes:"staticAssetTypes"},outputs:{openServicesPanel:"openServicesPanel",openEquipmentsPanel:"openEquipmentsPanel",formSubmitted:"formSubmitted",canceled:"canceled"},features:[e._Bn([fe]),e.qOj],decls:157,vars:50,consts:[["id","asset-register-vehicle-form",3,"formGroup","ngSubmit"],[1,"row",3,"ngClass"],[1,"col-lg-12"],[1,"zero-km-form"],[1,"d-flex","align-items-end","mb-3"],[1,"content-number","text-blue-400"],[1,"content-label"],["class","ml-3","src","/assets/icons/attention-form.svg","alt","",4,"ngIf"],[1,"card"],[1,"row","d-flex","align-items-center"],[1,"col-lg-2"],[1,"form-group","d-flex","flex-column"],["for","0-km"],["id","0kmToggler","formControlName","isZeroKm",3,"appPreventEvent"],[1,"col-lg-4"],[1,"form-group","mt-3","mt-lg-0"],["for","chassiInput",3,"ngClass"],["type","text","id","chassiInput","aria-describedby","chassiHelp","formControlName","chassis","autocomplete","off",1,"form-control","text-uppercase"],[1,"form-group","mt-2","mt-lg-0"],["for","NFInput",3,"ngClass"],["type","text","id","NFInput","aria-describedby","NFHelp","formControlName","invoiceValue","currencyMask","","autocomplete","off",1,"form-control",3,"options","appPreventEvent"],["id","",1,""],[1,"row"],[1,"assets-form","mt-5"],[1,"d-flex","align-items-center","justify-content-center"],[1,"form-group"],["for","licensePlate","hidden","true"],["formControlName","licensePlate","id","licensePlate"],[1,"row","mt-5"],[1,"col-lg-8"],["rt",""],["for","yearModel",1,"required"],["type","text","aria-describedby","yearModelHelp","formControlName","model","autocomplete","off",1,"form-control",3,"ngbTypeahead","resultTemplate","inputFormatter","placement","selectItem","appPreventEvent"],["class","ml-2 spinner-border text-primary input-loading","role","status",3,"ngStyle",4,"ngIf"],["for","vehicleColor",1,"required"],["id","vehicleColor","aria-describedby","vehicleColorHelp","formControlName","colorId",1,"form-control"],["value","",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],["for","fipeCode"],["formControlName","fipeCode","type","text","id","fipeCode",1,"form-control"],["for","fipeValue"],["formControlName","fipeValue","type","text","id","fipeValue","currencyMask","",1,"form-control",3,"options"],["for","vehicleType"],["type","text","id","vehicleType","formControlName","vehicleType",1,"form-control"],["value","Cars"],["value","Trucks"],["value","Motocycles"],[1,"form-group","col-lg-4"],["for","licensingFederationUnit",1,"required"],["type","text","formControlName","licensingFederationUnit","id","licensingFederationUnit",1,"form-control"],["for","renavam"],[1,"d-flex","align-items-center"],["type","text","formControlName","renavam","mask","00000000000",1,"form-control","ml-1"],["class","form-group col-lg-4",4,"ngIf"],["class","row",4,"ngIf"],[1,"bold-label-sm"],[1,"card","mt-2"],["for","securityDeviceId",1,"required"],["type","text","formControlName","securityDeviceId","id","securityDeviceId",1,"form-control"],[3,"value","select",4,"ngFor","ngForOf"],["for","securityDeviceCompanyName",3,"ngClass"],["type","text","formControlName","securityDeviceCompanyName","id","securityDeviceCompanyName","autocomplete","off",1,"form-control"],["for","securityDeviceCompanyContact",3,"ngClass"],["type","text","id","securityDeviceCompanyContact","formControlName","securityDeviceCompanyContact","autocomplete","off",1,"form-control"],["id","equipments",1,"row","mt-5",3,"ngClass"],[1,"card","p-3"],["type","button",1,"btn","btn-outline-primary","mb-3",3,"disabled","click"],["appPreventArrowKey","","dataKey","id","editMode","row","tableStyleClass","editable-table",3,"value"],["equipTable",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"row","mt-5",3,"ngClass"],[1,"card","p-4","service-card"],[1,"d-flex","align-items-center","justify-content-between","w-10"],[1,"subtitle","medium-txt"],[1,"links",3,"disabled","ngClass","click"],[3,"ngClass"],[1,"ml-2","fas","fa-chevron-right"],[1,"d-flex","justify-content-between"],["type","button",1,"btn","btn-link","btn-fipe"],[1,"d-flex"],[1,"btn","btn-outline-light-atb",3,"click"],["type","submit","form","asset-register-vehicle-form",1,"btn","btn-success-atb","ml-3"],["src","/assets/icons/attention-form.svg","alt","",1,"ml-3"],[3,"result","term"],["role","status",1,"ml-2","spinner-border","text-primary","input-loading",3,"ngStyle"],[3,"value"],["for","aggregateTypeId",1,"required"],["type","text","formControlName","aggregateTypeId","id","aggregateTypeId",1,"form-control"],[3,"ngValue"],["for",""],["id","protectBody","formControlName","protectBody",3,"appPreventEvent"],["type","text","id","bodyValue","placeholder","Digite o valor","formControlName","bodyValue","autocomplete","off","currencyMask","",1,"form-control","ml-1",3,"options"],["id","collapseBodyTypeIdAssetRegister",1,"collapse","mt-2"],[1,"subtitle-sm"],["type","text","formControlName","bodyTypeId",1,"form-control"],[1,"form-group","ml-1","col-lg-4"],["id","protectAdditionalAxleToggler","formControlName","protectAdditionalAxle",3,"appPreventEvent"],["type","text","id","additionalAxleValue","placeholder","Digite o valor","formControlName","additionalAxleValue","autocomplete","off","currencyMask","",1,"form-control","ml-1",2,"margin-right","3px",3,"options"],["class","col-lg-1 mr-1",4,"ngIf"],[1,"col-lg-1","mr-1"],[1,"form-group","d-flex","align-items-start","flex-column"],["for","isDamaged"],["id","isDamagedToggler","formControlName","isDamaged"],[3,"value","select"],[1,"text-nowrap","text-primary",2,"width","20%"],[1,"text-nowrap","text-primary",2,"width","30%"],[3,"ngClass","ngStyle"],["pEditableColumn","","id","equip-table-first-cell",3,"ngClass"],["pTemplate","input"],["pTemplate","output"],["pEditableColumn","","id","equip-table-first-cell"],["pEditableColumn","",3,"ngClass"],[3,"id"],[1,"action-btn","btn",3,"click"],[1,"table-action","fas","fa-trash"],["pInputText","","type","text","maxlength","40",3,"ngModel","ngModelChange","focus","blur","keydown","keypress","change"],["appendTo","body","optionLabel","displayName",3,"options","ngModel","ngModelChange","onChange"],["pInputText","","type","text","maxlength","50",3,"ngModel","ngModelChange","focus","blur","keydown","keypress","change"],["pInputText","","id","equipment-declared-value","type","text","required","","min","0","currencyMask","","maxlength","11",3,"options","ngModel","ngModelChange","focus","blur","keydown"],[1,"border"]],template:function(t,n){if(1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return n.saveVehicle()}),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"span",5),e._uU(6," 2 "),e.qZA(),e.TgZ(7,"span",6),e._uU(8,"Cadastre o bem"),e.qZA(),e.YNc(9,lt,1,0,"img",7),e.qZA(),e.TgZ(10,"div",8)(11,"div",9)(12,"div",10)(13,"div",11)(14,"label",12),e._uU(15,"0 KM"),e.qZA(),e.TgZ(16,"toggler",13),e.NdJ("appPreventEvent",function(p){return n.checkOurFipe(p)}),e.qZA()()(),e.TgZ(17,"div",14)(18,"div",15)(19,"label",16),e._uU(20,"Chassi"),e.qZA(),e._UZ(21,"input",17),e.qZA()(),e.TgZ(22,"div",14)(23,"div",18)(24,"label",19),e._uU(25,"Valor da NF"),e.qZA(),e.TgZ(26,"input",20),e.NdJ("appPreventEvent",function(p){return n.checkOurFipe(p)}),e.qZA()()()()()()()(),e.TgZ(27,"div",21)(28,"div",22)(29,"div",2)(30,"div",23)(31,"div",24)(32,"div",25)(33,"label",26),e._uU(34,"Placa"),e.qZA(),e._UZ(35,"app-license-plate",27),e.qZA()()()()()(),e.TgZ(36,"div",28)(37,"div",29)(38,"div",25),e.YNc(39,at,1,2,"ng-template",null,30,e.W1O),e.TgZ(41,"label",31),e._uU(42,"Modelo/Ano"),e.qZA(),e.TgZ(43,"input",32),e.NdJ("selectItem",function(){return n.onFipeVehicleModelSelect()})("appPreventEvent",function(p){return n.checkOurFipe(p)}),e.qZA(),e.YNc(44,rt,1,3,"div",33),e.qZA()(),e.TgZ(45,"div",14)(46,"div",25)(47,"label",34),e._uU(48,"Cor"),e.qZA(),e.TgZ(49,"select",35)(50,"option",36),e._uU(51," Selecione "),e.qZA(),e.YNc(52,ct,2,2,"option",37),e.qZA()()()(),e.TgZ(53,"div",22)(54,"div",14)(55,"div",25)(56,"label",38),e._uU(57,"C\xf3digo FIPE"),e.qZA(),e._UZ(58,"input",39),e.qZA()(),e.TgZ(59,"div",14)(60,"div",25)(61,"label",40),e._uU(62,"Valor FIPE"),e.qZA(),e._UZ(63,"input",41),e.qZA()(),e.TgZ(64,"div",14)(65,"div",25)(66,"label",42),e._uU(67,"Tipo de Ve\xedculo"),e.qZA(),e.TgZ(68,"select",43)(69,"option",44),e._uU(70,"Leve"),e.qZA(),e.TgZ(71,"option",45),e._uU(72,"Pesado"),e.qZA(),e.TgZ(73,"option",46),e._uU(74,"Motocicleta"),e.qZA()()()()(),e.TgZ(75,"div",22)(76,"div",47)(77,"label",48),e._uU(78,"UF de Licenciamento"),e.qZA(),e.TgZ(79,"select",49)(80,"option",36),e._uU(81," Selecione "),e.qZA(),e.YNc(82,dt,2,2,"option",37),e.qZA()(),e.TgZ(83,"div",14)(84,"div",25)(85,"label",50),e._uU(86,"Renavam"),e.qZA(),e.TgZ(87,"div",51),e._UZ(88,"input",52),e.qZA()()(),e.YNc(89,pt,7,2,"div",53),e.qZA(),e.YNc(90,gt,22,7,"div",54),e.YNc(91,vt,2,1,"div",54),e.TgZ(92,"div",28)(93,"div",2)(94,"span",55),e._uU(95,"Dispositivo de seguran\xe7a"),e.qZA(),e.TgZ(96,"div",56)(97,"div",22)(98,"div",14)(99,"div",25)(100,"label",57),e._uU(101,"Tipo de equipamento"),e.qZA(),e.TgZ(102,"select",58)(103,"option",36),e._uU(104," Selecione "),e.qZA(),e.YNc(105,ft,2,2,"option",59),e.qZA()()(),e.TgZ(106,"div",14)(107,"div",25)(108,"label",60),e._uU(109,"Empresa respons\xe1vel"),e.qZA(),e._UZ(110,"input",61),e.qZA()(),e.TgZ(111,"div",14)(112,"div",25)(113,"label",62),e._uU(114,"Contato da empresa"),e.qZA(),e._UZ(115,"input",63),e.qZA()()()()()()(),e.TgZ(116,"div",64)(117,"div",2)(118,"div",4)(119,"span",5),e._uU(120,"3"),e.qZA(),e.TgZ(121,"span",6),e._uU(122,"Cadastrar equipamentos"),e.qZA()(),e.TgZ(123,"div",65)(124,"button",66),e.NdJ("click",function(){return n.addEquipment()}),e._uU(125," + Adicionar "),e.qZA(),e.TgZ(126,"p-table",67,68),e.YNc(128,xt,10,0,"ng-template",69),e.YNc(129,Zt,20,15,"ng-template",70),e.YNc(130,qt,3,1,"ng-template",71),e.qZA()()()(),e.TgZ(131,"div",72)(132,"div",2)(133,"div",4)(134,"span",5),e._uU(135,"4"),e.qZA(),e.TgZ(136,"span",6),e._uU(137,"Escolha os servi\xe7os"),e.qZA(),e.YNc(138,Dt,1,0,"img",7),e.qZA(),e.TgZ(139,"div",73)(140,"div",74)(141,"span",75),e._uU(142," Selecione o plano de servi\xe7o "),e.qZA(),e.TgZ(143,"button",76),e.NdJ("click",function(){return n.openServicesRegistrationPanel()}),e.TgZ(144,"span",77),e._uU(145),e.qZA(),e._UZ(146,"i",78),e.qZA()()()()(),e.TgZ(147,"div",28)(148,"div",2)(149,"div",79)(150,"button",80),e._uU(151," Busca FIPE manual "),e.qZA(),e.TgZ(152,"div",81)(153,"button",82),e.NdJ("click",function(){return n.cancel()}),e._uU(154," Cancelar "),e.qZA(),e.TgZ(155,"button",83),e._uU(156),e.qZA()()()()()),2&t){const a=e.MAs(40);let p,f,Z,W,G,ie;e.Q6J("formGroup",n.form),e.xp6(1),e.Q6J("ngClass",e.VKq(33,Ve,n.setInvalidCss("chassis")||(null==(p=n.form.get("isZeroKm"))?null:p.value)&&n.setInvalidCss("invoiceValue"))),e.xp6(8),e.Q6J("ngIf",n.setInvalidCss("chassis")||(null==(f=n.form.get("isZeroKm"))?null:f.value)&&n.setInvalidCss("invoiceValue")),e.xp6(10),e.Q6J("ngClass",e.VKq(35,Ke,null==(Z=n.form.get("isZeroKm"))?null:Z.value)),e.xp6(5),e.Q6J("ngClass",e.VKq(37,Ke,null==(W=n.form.get("isZeroKm"))?null:W.value)),e.xp6(2),e.Q6J("options",e.DdM(39,Ue)),e.xp6(17),e.Q6J("ngbTypeahead",n.search)("resultTemplate",a)("inputFormatter",n.formatter)("placement","bottom-left"),e.xp6(1),e.Q6J("ngIf","PENDING"==n.form.controls.model.status||n.searching&&!n.searchFailed),e.xp6(6),e.Q6J("disabled",""!==n.form.value.colorId),e.xp6(2),e.Q6J("ngForOf",n.indexes.autoColors),e.xp6(11),e.Q6J("options",e.DdM(40,Ue)),e.xp6(17),e.Q6J("disabled",""!==(null==n.form||null==n.form.value?null:n.form.value.licensingFederationUnit)),e.xp6(2),e.Q6J("ngForOf",null==n.indexes?null:n.indexes.autoLicensingFederationUnits),e.xp6(7),e.Q6J("ngIf","Trucks"===n._vehicleType),e.xp6(1),e.Q6J("ngIf","Trucks"===n._vehicleType),e.xp6(1),e.Q6J("ngIf","Cars"===n._vehicleType),e.xp6(12),e.Q6J("disabled",""!==n.form.value.securityDeviceId),e.xp6(2),e.Q6J("ngForOf",n.indexes.securityDevices),e.xp6(3),e.Q6J("ngClass",null!=n.selectedSecurityDevice&&n.selectedSecurityDevice.requireDetails?"required":""),e.xp6(5),e.Q6J("ngClass",null!=n.selectedSecurityDevice&&n.selectedSecurityDevice.requireDetails?"required":""),e.xp6(3),e.Q6J("ngClass",e.VKq(41,Ve,n.setInvalidCss("equipments"))),e.xp6(8),e.Q6J("disabled",n.disableAddEquipment),e.xp6(2),e.Q6J("value",n.equipments),e.xp6(5),e.Q6J("ngClass",e.VKq(43,Ve,n.setInvalidCss("products"))),e.xp6(7),e.Q6J("ngIf",n.setInvalidCss("products")),e.xp6(5),e.Q6J("disabled",n.tableHasErrors||!(null!=(G=n.form.get("fipeValue"))&&G.value))("ngClass",e.VKq(45,St,n.tableHasErrors||!(null!=(ie=n.form.get("fipeValue"))&&ie.value))),e.xp6(1),e.Q6J("ngClass",e.WLB(47,Ft,!n.productsCount&&!n.equipmentsCount,n.productsCount||n.equipmentsCount)),e.xp6(1),e.Oqu(n.productsCount||n.equipmentsCount?n.productsCount+n.equipmentsCount===1?"1 atribu\xeddo":n.productsCount+n.equipmentsCount+" atribu\xeddos":"Nenhum atribu\xeddo"),e.xp6(11),e.hij(" ",n.vehicle?"Confirmar":"Salvar"," ")}},directives:[A._Y,A.JL,A.sg,q.MU,b.mk,b.O5,q.HK,ue.u,A.JJ,A.u,ot.N,A.Fj,q.oH,x.g1,J,he._h,he.dR,b.PC,A.EJ,A.YN,A.Kr,b.sg,ye.hx,_.iA,I.s,H.jx,_.Wq,_.YL,A.nD,A.On,re.Lt,A.Q7],pipes:[b.rS,b.H9],styles:[".card[_ngcontent-%COMP%]{padding:1rem}.btn[_ngcontent-%COMP%]:not(.action-btn){height:40px;min-width:136px}.btn-fipe[_ngcontent-%COMP%]{font-size:14px}.slide[_ngcontent-%COMP%]{height:auto;transition:all 1s}.content-number[_ngcontent-%COMP%]{font-weight:700;font-size:30px;line-height:35px}.content-label[_ngcontent-%COMP%]{font-weight:500;font-size:20px;color:#707a84;line-height:28px;margin-left:.5rem}.service-card[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]{cursor:pointer;background-color:transparent;border:none}.service-card[_ngcontent-%COMP%]   .links[_ngcontent-%COMP%]:not(.not-allowed):hover{text-decoration:underline}.service-card[_ngcontent-%COMP%]   .links.not-allowed[_ngcontent-%COMP%]{cursor:not-allowed!important}.disabled[_ngcontent-%COMP%]{filter:opacity(30%);pointer-events:none;cursor:not-allowed!important}.btn-outline-primary[_ngcontent-%COMP%]{max-width:146px}.action-btn[_ngcontent-%COMP%]{background:transparent;height:24px;width:24px;border-radius:4px;display:flex;align-items:center;justify-content:center}.action-btn[_ngcontent-%COMP%]:hover{background:#dbeefd}.table-action[_ngcontent-%COMP%]{color:#d8dbdf;font-size:14px;cursor:pointer}@media screen and (max-width: 768px){.btn[_ngcontent-%COMP%]{min-width:auto}}  ngb-typeahead-window{width:100%!important;max-height:160px;height:auto;overflow:auto}  .dropdown-item.active,   .dropdown-item:active{color:#007bff;text-decoration:none;background-color:#cae7ff6b}"]}),u})();var kt=r(8185);const Nt=["assetTypeBtn"],Vt=["autoTypeBtn"],Rt=function(u){return{active:u}};function Jt(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"div",26,27),e.NdJ("click",function(){const p=e.CHM(t).$implicit;return e.oxw(2).onAssetTypeSelected(p)}),e.ALo(2,"async"),e.TgZ(3,"div",28),e._UZ(4,"img",29),e.qZA(),e.TgZ(5,"div",30)(6,"div",31),e._uU(7),e.qZA()()()}if(2&u){const t=w.$implicit,n=e.oxw(2);let a;e.Q6J("ngClass",e.VKq(5,Rt,(null==(a=e.lcZ(2,3,n.selectedAssetType$))?null:a.value)==(null==t?null:t.value))),e.xp6(4),e.Q6J("src",null==t?null:t.icon,e.LSH),e.xp6(3),e.hij(" ",null==t?null:t.displayName," ")}}const Bt=function(u,w){return{active:u,"mr-2":w}};function Lt(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"button",35,36),e.NdJ("click",function(){const p=e.CHM(t).$implicit;return e.oxw(4).onAutoTypeSelected(p)}),e.ALo(2,"async"),e._uU(3),e.qZA()}if(2&u){const t=w.$implicit,n=w.index,a=e.oxw(2).ngIf,p=e.oxw(2);let f;e.Q6J("disabled",p.isEditing&&(null==t?null:t.value)!==p.selectedAsset.asset.autoType)("ngClass",e.WLB(5,Bt,(null==(f=e.lcZ(2,3,p.selectedSubType$))?null:f.value)==t.value,n<(null==a?null:a.subTypes.length))),e.xp6(3),e.hij(" ",null==t?null:t.displayName," ")}}function Qt(u,w){if(1&u&&(e.TgZ(0,"div",33),e.YNc(1,Lt,4,8,"button",34),e.qZA()),2&u){const t=e.oxw().ngIf;e.xp6(1),e.Q6J("ngForOf",null==t?null:t.subTypes)}}function $t(u,w){if(1&u&&(e.ynx(0),e.YNc(1,Qt,2,1,"div",32),e.BQk()),2&u){const t=w.ngIf;e.oxw();const n=e.MAs(24);e.xp6(1),e.Q6J("ngIf",(null==t?null:t.subTypes)&&(null==t?null:t.subTypes.length)>0)("ngIfElse",n)}}function Kt(u,w){1&u&&(e.TgZ(0,"div",37),e._UZ(1,"button",38)(2,"button",38)(3,"button",39),e.qZA())}function Ht(u,w){1&u&&e._UZ(0,"div",40)}function Yt(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"div")(1,"app-aggregate-form",44),e.NdJ("openEquipmentsPanel",function(){return e.CHM(t),e.oxw(4).openEquipmentsPanel()})("formSubmitted",function(a){return e.CHM(t),e.oxw(4).save(a)})("canceled",function(){return e.CHM(t),e.oxw(4).closePanel()}),e.qZA()()}if(2&u){const t=e.oxw().ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("aggregate",n.aggregate)("assetData",n.selectedAsset)("indexes",t)}}function Wt(u,w){1&u&&(e.TgZ(0,"div"),e._uU(1,"form equipamento"),e.qZA())}function jt(u,w){1&u&&(e.TgZ(0,"div"),e._uU(1,"form motorcycle"),e.qZA())}function zt(u,w){if(1&u){const t=e.EpF();e.TgZ(0,"div")(1,"app-vehicle-form",45),e.NdJ("formSubmitted",function(a){return e.CHM(t),e.oxw(4).save(a)})("openEquipmentsPanel",function(){return e.CHM(t),e.oxw(4).openEquipmentsPanel()})("canceled",function(){return e.CHM(t),e.oxw(4).closePanel()}),e.ALo(2,"async"),e.qZA()()}if(2&u){const t=e.oxw().ngIf,n=e.oxw().ngIf,a=e.oxw(2);let p;e.xp6(1),e.Q6J("vehicle",a.vehicle)("staticAssetTypes",null==(p=e.lcZ(2,5,a.statics$))?null:p.assetTypes)("indexes",t)("assetData",a.selectedAsset)("vehicleType",null==n?null:n.value)}}const Gt=function(u){return{"fade-in":u}};function Xt(u,w){if(1&u&&(e.ynx(0),e.TgZ(1,"div",41),e.ALo(2,"async"),e.YNc(3,Yt,2,3,"div",42),e.YNc(4,Wt,2,0,"div",42),e.YNc(5,jt,2,0,"div",42),e.YNc(6,zt,3,7,"div",43),e.qZA(),e.BQk()),2&u){const t=e.oxw().ngIf,n=e.oxw(2);e.xp6(1),e.Q6J("ngSwitch",null==t?null:t.value)("ngClass",e.VKq(7,Gt,e.lcZ(2,5,n.selectedAssetType$)&&t)),e.xp6(2),e.Q6J("ngSwitchCase","Aggregate"),e.xp6(1),e.Q6J("ngSwitchCase","Equipment"),e.xp6(1),e.Q6J("ngSwitchCase","Motorcycle")}}function en(u,w){if(1&u&&(e.ynx(0),e.YNc(1,Xt,7,9,"ng-container",1),e.ALo(2,"async"),e.BQk()),2&u){const t=e.oxw(2),n=e.MAs(6);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,t.indexes$))("ngIfElse",n)}}const tn=function(){return{text:"Criar proposta"}},nn=function(){return{text:"Cadastro"}},on=function(u,w){return[u,w]},ln=function(u,w){return{"inactive-component":u,"fade-in":w}};function an(u,w){if(1&u){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",5)(2,"div",6)(3,"app-breadcrumb",7),e.NdJ("closeModal",function(){return e.CHM(t),e.oxw().dialogRef.close()}),e.qZA(),e.TgZ(4,"div",8)(5,"div",9)(6,"div",10)(7,"div",11)(8,"span",12),e._uU(9,"1"),e.qZA(),e.TgZ(10,"span",13),e._uU(11," Escolha a categoria e tipo do bem "),e.qZA()(),e.TgZ(12,"div",14)(13,"div",15)(14,"div",16)(15,"div",17),e.YNc(16,Jt,8,7,"div",18),e.qZA()(),e.TgZ(17,"div",19)(18,"div",20)(19,"span",21),e._uU(20," Tipo do bem "),e.qZA(),e.YNc(21,$t,2,2,"ng-container",1),e.ALo(22,"async"),e.YNc(23,Kt,4,0,"ng-template",null,22,e.W1O),e.qZA()()()()()(),e.TgZ(25,"div",9)(26,"div",23),e.ALo(27,"async"),e.ALo(28,"async"),e.ALo(29,"async"),e.YNc(30,Ht,1,0,"div",24),e.ALo(31,"async"),e.YNc(32,en,3,4,"ng-container",25),e.ALo(33,"async"),e.qZA()()()()(),e.BQk()}if(2&u){const t=w.ngIf,n=e.MAs(24),a=e.oxw();e.xp6(3),e.Q6J("isModal",!0)("items",e.WLB(22,on,e.DdM(20,tn),e.DdM(21,nn))),e.xp6(13),e.Q6J("ngForOf",null==t?null:t.assetTypes),e.xp6(5),e.Q6J("ngIf",e.lcZ(22,8,a.selectedAssetType$))("ngIfElse",n),e.xp6(5),e.Q6J("ngClass",e.WLB(25,ln,!e.lcZ(27,10,a.selectedSubType$),e.lcZ(28,12,a.selectedAssetType$)&&e.lcZ(29,14,a.selectedSubType$))),e.xp6(4),e.Q6J("ngIf",!e.lcZ(31,16,a.selectedSubType$)),e.xp6(2),e.Q6J("ngIf",e.lcZ(33,18,a.selectedSubType$))}}function sn(u,w){1&u&&(e.TgZ(0,"div",46)(1,"div",47)(2,"span",48),e._uU(3,"Loading..."),e.qZA()(),e.TgZ(4,"span",49),e._uU(5," Um momento... "),e.qZA()())}const rn=function(){return{height:"6px"}};function cn(u,w){1&u&&e._UZ(0,"p-progressBar",51),2&u&&e.Akn(e.DdM(2,rn))}function dn(u,w){if(1&u&&e.YNc(0,cn,1,3,"p-progressBar",50),2&u){const t=e.oxw(),n=e.MAs(8);e.Q6J("ngIf",!t.requestError)("ngIfElse",n)}}function un(u,w){1&u&&(e.TgZ(0,"h5",52),e._uU(1," Houve um erro, tente novamente em alguns minutos. "),e.qZA())}let pn=(()=>{class u{constructor(t,n,a,p,f){this.dialog=t,this.dialogRef=n,this.quotationService=a,this.loading=p,this.selectedAsset=f,this.assetTypes=[],this.subTypes=[],this.indexes$=new h.y,this.statics$=new h.y,this.selectedAssetType$=new s.x,this.selectedSubType$=new s.x,this.requestError=!1,this.isEditing=!1,this.vehicle={},this.aggregate={}}ngOnInit(){this.selectedAsset.asset&&(this.isEditing=!0),this.isEditing&&this.executeFormEvents(),this.selectedAsset.asset||(this.selectedAsset.asset={assetType:null,autoType:null}),this.statics$=this.quotationService.getQuotationStatics().pipe((0,F.q)(1),(0,g.b)(({assetTypes:t})=>{this.assetTypes=t,this.assetTypes.map(n=>{switch(n.value){case v.un.Auto:return n.icon="../../../../../../assets/icons/car-blue.svg";case v.un.Ship:return n.icon="../../../../../../assets/icons/ship-blue.svg";case v.un.Property:return n.icon="../../../../../../assets/icons/house-blue.svg";default:return n.icon="../../../../../../assets/icons/list.svg"}})})),this.selectedAssetType$.subscribe(t=>{t&&this.selectedSubType$.subscribe(n=>{n&&(this._selectedSubType=n,this._selectedAssetType=t,this.indexes$=(0,i.of)(null),t.value==v.un.Auto&&(this.indexes$=this.quotationService.getAutoTypeIndexes(this.selectedAsset.quotationId,n.value).pipe((0,F.q)(1),(0,g.b)(a=>{this.requestError=!1}),(0,C.K)(a=>(this.requestError=!0,(0,l._)(a))))))})})}filterServicePlans(){}executeFormEvents(){var t,n;const a=(null===(t=this.selectedAsset.asset)||void 0===t?void 0:t.autoType)==v.rQ.Aggregate?"getAssetAggregate":"getAssetVehicle";this.quotationService[a](this.selectedAsset.quotationId,null===(n=this.selectedAsset.asset)||void 0===n?void 0:n.id).subscribe(p=>{var f,Z;(null===(f=this.selectedAsset.asset)||void 0===f?void 0:f.autoType)==v.rQ.Aggregate?this.aggregate=p:this.vehicle=p,setTimeout(()=>{var W,G,ie,se,ce,ve,xe,Ce,be,Ae;switch(null===(W=this.selectedAsset.asset)||void 0===W?void 0:W.assetType){case v.un.Auto:null===(ie=null===(G=this.assetTypeBtn)||void 0===G?void 0:G.nativeElement)||void 0===ie||ie.click();break;case v.un.Ship:null===(ve=null===(ce=null===(se=this.assetTypeBtn)||void 0===se?void 0:se.nativeElement)||void 0===ce?void 0:ce.nextSibling)||void 0===ve||ve.click();break;case v.un.Property:null===(Ae=null===(be=null===(Ce=null===(xe=this.assetTypeBtn)||void 0===xe?void 0:xe.nativeElement)||void 0===Ce?void 0:Ce.nextSibling)||void 0===be?void 0:be.nextSibling)||void 0===Ae||Ae.click()}},700),this.selectedAssetType$.next(null===(Z=this.selectedAsset.asset)||void 0===Z?void 0:Z.assetType),setTimeout(()=>{var W,G,ie,se,ce,ve,xe,Ce,be,Ae;switch(null===(W=this.selectedAsset.asset)||void 0===W?void 0:W.autoType){case v.rQ.Light:null===(ie=null===(G=this.autoTypeBtn)||void 0===G?void 0:G.nativeElement)||void 0===ie||ie.click();break;case v.rQ.Heavy:null===(ve=null===(ce=null===(se=this.autoTypeBtn)||void 0===se?void 0:se.nativeElement)||void 0===ce?void 0:ce.nextSibling)||void 0===ve||ve.click();break;case v.rQ.Aggregate:null===(Ae=null===(be=null===(Ce=null===(xe=this.autoTypeBtn)||void 0===xe?void 0:xe.nativeElement)||void 0===Ce?void 0:Ce.nextSibling)||void 0===be?void 0:be.nextSibling)||void 0===Ae||Ae.click()}},1300)})}onAssetTypeSelected(t){this.selectedAssetType$.next(t),this.selectedSubType$.next(null),this.selectedAsset.asset.assetType=t.displayName}onAutoTypeSelected(t){this.selectedSubType$.next(t),this.selectedAsset.asset.autoType=t.value}closePanel(t){t?this.dialogRef.close({asset:t}):this.dialogRef.close()}removeUnnecessaryControls(t){var n,a;return(null===(n=t.model)||void 0===n?void 0:n.ourFipe)&&delete Object.assign(t,{ourFipe:null===(a=t.model)||void 0===a?void 0:a.ourFipe}).model,null==t||delete t.manufacturer,null==t||delete t.yearModel,null==t||delete t.vehicleValue,t}save({asset:t,assetType:n,autoType:a}){if(this.removeUnnecessaryControls(t),this.loading.show(),n===v.un.Auto){const p=this.isEditing?"updateAggregate":"saveAggregate",f=this.isEditing?"updateVehicle":"saveVehicle";this.quotationService[a==v.rQ.Aggregate?p:f](this.selectedAsset.quotationId,t).pipe((0,F.q)(1),(0,m.x)(()=>this.loading.hide())).subscribe(Z=>{this.dialogRef.close(Boolean(Z))})}}openEquipmentsPanel(){this.dialog.open(j,{height:"100vh",width:"100vw",maxWidth:"none"})}ngOnDestroy(){}}return u.\u0275fac=function(t){return new(t||u)(e.Y36(o.uw),e.Y36(o.so),e.Y36(N.G),e.Y36(V.b),e.Y36(o.WI))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-assets-panel"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Nt,5),e.Gf(Vt,5)),2&t){let a;e.iGM(a=e.CRH())&&(n.assetTypeBtn=a.first),e.iGM(a=e.CRH())&&(n.autoTypeBtn=a.first)}},decls:9,vars:4,consts:[[1,"wrapper","px-0"],[4,"ngIf","ngIfElse"],["loading",""],["progressBar",""],["requestErrorMsg",""],[1,"container"],[1,"d-flex","flex-column"],[3,"isModal","items","closeModal"],[1,"card","add-asset-panel"],[1,"row","mb-5"],[1,"col-lg-12","d-flex","flex-column"],[1,"d-flex","align-items-end","mb-3"],[1,"content-number","text-blue-400"],[1,"content-label"],[1,"card","main-card","d-flex"],[1,"row"],[1,"col-lg-6","goods"],[1,"option-cards"],["class","box-floating option-card",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"col-lg-6"],[1,"d-flex","flex-column","type-goods"],[1,"mb-3","text-gray-600","subtitle","medium-txt"],["assetTypeNotSelected",""],[1,"col-lg-12","d-flex","flex-column",3,"ngClass"],["class","empty-section card",4,"ngIf"],[4,"ngIf"],[1,"box-floating","option-card",3,"ngClass","click"],["assetTypeBtn",""],[1,"icon-wrapper"],[1,"option-card-icon",3,"src"],[1,"label-wrapper","mt-1"],[1,"option-card-label"],["class","sub-types d-flex align-items-center flex-wrap",4,"ngIf","ngIfElse"],[1,"sub-types","d-flex","align-items-center","flex-wrap"],["class","btn btn-sm mb-2",3,"disabled","ngClass","click",4,"ngFor","ngForOf"],[1,"btn","btn-sm","mb-2",3,"disabled","ngClass","click"],["autoTypeBtn",""],[1,"sub-types","d-flex","align-items-center"],[1,"btn","empty-sub-type","btn-sm","mr-2"],[1,"btn","empty-sub-type","btn-sm"],[1,"empty-section","card"],[3,"ngSwitch","ngClass"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"aggregate","assetData","indexes","openEquipmentsPanel","formSubmitted","canceled"],[3,"vehicle","staticAssetTypes","indexes","assetData","vehicleType","formSubmitted","openEquipmentsPanel","canceled"],[1,"d-flex","justify-content-center","w-100","align-items-center","h-100","wrapper","flex-column"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"mt-4","text-gray-300","subtitle-sm","regular-txt"],["mode","indeterminate",3,"style",4,"ngIf","ngIfElse"],["mode","indeterminate"],[1,"thin-txt","text-gray-300"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0),e.YNc(1,an,34,28,"ng-container",1),e.ALo(2,"async"),e.qZA(),e.YNc(3,sn,6,0,"ng-template",null,2,e.W1O),e.YNc(5,dn,1,2,"ng-template",null,3,e.W1O),e.YNc(7,un,2,0,"ng-template",null,4,e.W1O)),2&t){const a=e.MAs(4);e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,n.statics$))("ngIfElse",a)}},directives:[b.O5,c.L,b.sg,b.mk,b.RF,b.n9,Ye,b.ED,Ut,kt.k],pipes:[b.Ov],styles:[".mat-dialog-container{overflow:auto!important;padding:0}.wrapper[_ngcontent-%COMP%]{background-color:#f0f3f9;min-height:100vh;min-width:100vw;max-height:100vh;overflow-y:auto}  .cdk-overlay-pane{max-width:none!important}  .cdk-global-scrollblock{position:static;overflow:hidden!important}.container[_ngcontent-%COMP%]:first-child{padding:2rem 0}.card[_ngcontent-%COMP%]{padding:4.1rem 3.4rem}.main-card[_ngcontent-%COMP%]{max-height:-webkit-fit-content;max-height:-moz-fit-content;max-height:fit-content;padding:2rem}  .mat-dialog-container{padding:0;border-radius:0}.empty-card[_ngcontent-%COMP%]{background:#a2a2a2ad}.card.empty-section[_ngcontent-%COMP%]{height:250px;border:1px solid #17171787}.inactive-component[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{filter:opacity(.1) grayscale(80%);cursor:not-allowed}.inactive-component[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]{cursor:not-allowed}.fade-in[_ngcontent-%COMP%]{-webkit-animation:fade-in 1.2s cubic-bezier(.39,.575,.565,1) both;animation:fade-in 1.2s cubic-bezier(.39,.575,.565,1) both}@-webkit-keyframes fade-in{0%{opacity:.1}to{opacity:1}}@keyframes fade-in{0%{opacity:.1}to{opacity:1}}.content-number[_ngcontent-%COMP%]{color:#373a3c;font-weight:700;font-size:30px;line-height:35px}.content-label[_ngcontent-%COMP%]{font-weight:500;font-size:20px;color:#707a84;line-height:28px;margin-left:.5rem}.add-asset-panel[_ngcontent-%COMP%]   .option-cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin-top:2px}.add-asset-panel[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]{min-height:112px;max-height:112px;min-width:112px;max-width:112px;border:1px solid #e7e7e7;margin-bottom:16px;display:flex;align-items:center;justify-content:center;flex-direction:column;cursor:pointer}.add-asset-panel[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]:hover{box-shadow:0 6px 8px 2px #0000001a}.add-asset-panel[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{height:68px;display:flex;align-items:center;justify-content:center}.add-asset-panel[_ngcontent-%COMP%]   .option-card[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{height:28px;display:flex}.add-asset-panel[_ngcontent-%COMP%]   .option-card.active[_ngcontent-%COMP%]{border-color:transparent;box-shadow:0 0 0 2px #2195f3}.add-asset-panel[_ngcontent-%COMP%]   .option-card.active[_ngcontent-%COMP%]   .option-card-label[_ngcontent-%COMP%]{color:#2195f3}.add-asset-panel[_ngcontent-%COMP%]   .option-card-label[_ngcontent-%COMP%]{font-size:12px;color:gray;text-align:center}.add-asset-panel[_ngcontent-%COMP%]   .option-card-icon[_ngcontent-%COMP%]{height:32px}.sub-types[_ngcontent-%COMP%]{align-content:flex-start}.sub-types[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#63696d;box-shadow:0 6px 8px 2px #0000000d;border:1px solid #d8dbdf;border-radius:4px;background:#ffffff;box-sizing:border-box;width:119px;height:30px}.sub-types[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{box-shadow:0 6px 8px 2px #0000001a}.sub-types[_ngcontent-%COMP%]   button.active[_ngcontent-%COMP%]{color:#0275d8;border:2px solid #0275d8}.empty-sub-type[_ngcontent-%COMP%]{border:none!important;background:#f7f7f7!important;box-shadow:none!important;cursor:unset!important}.zero-km-form[_ngcontent-%COMP%]{margin-top:50px}.zero-km-form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:0}.type-goods[_ngcontent-%COMP%]{padding-left:59px}.goods[_ngcontent-%COMP%]{border-right:2px solid #D8DBDF}"]}),u})()},2762:(pe,oe,r)=>{r.d(oe,{V:()=>g});var o=r(5e3),h=r(801);function s(C,m){if(1&C){const v=o.EpF();o.TgZ(0,"div")(1,"app-product-item-range",3),o.NdJ("count",function(e){return o.CHM(v),o.oxw().count.next(e)}),o.qZA()()}if(2&C){const v=o.oxw();o.xp6(1),o.Q6J("product",v.product)}}function i(C,m){if(1&C){const v=o.EpF();o.TgZ(0,"div")(1,"app-product-item-dropdown",3),o.NdJ("count",function(e){return o.CHM(v),o.oxw().count.next(e)}),o.qZA()()}if(2&C){const v=o.oxw();o.xp6(1),o.Q6J("product",v.product)}}const l=function(){return{standalone:!0}};function F(C,m){if(1&C){const v=o.EpF();o.TgZ(0,"div"),o.ynx(1),o.TgZ(2,"div",4)(3,"div",5)(4,"div",6)(5,"span",7),o._uU(6),o.qZA(),o._UZ(7,"i",8),o.qZA(),o.TgZ(8,"toggler",9),o.NdJ("ngModelChange",function(e){return o.CHM(v),o.oxw().product.isActivated=e}),o.qZA()()(),o.TgZ(9,"div",10,11),o.NdJ("ngbCollapseChange",function(e){return o.CHM(v),!(o.oxw().product.isActivated=e)}),o._UZ(11,"app-questions",12),o.qZA(),o.BQk(),o.qZA()}if(2&C){const v=o.oxw();o.xp6(6),o.Oqu(null==v.product?null:v.product.displayName),o.xp6(1),o.s9C("ngbTooltip",null==v.product?null:v.product.description),o.xp6(1),o.Q6J("ngModel",v.product.isActivated)("ngModelOptions",o.DdM(6,l)),o.xp6(1),o.Q6J("ngbCollapse",!v.product.isActivated),o.xp6(2),o.Q6J("product",v.product)}}let g=(()=>{class C{constructor(){this.count=new o.vpe,this.icons={edit:h.IwR}}ngOnInit(){var v,M,e,c,b,A,q,z,X;if(this.activeProducts){const Y=this.activeProducts.find(D=>D.id===this.product.id);Y?(this.product.item=null==Y?void 0:Y.item,this.product.value=null==Y?void 0:Y.value,null===(M=null===(v=this.product)||void 0===v?void 0:v.questions)||void 0===M||M.map(D=>{var L;const Q=null===(L=null==Y?void 0:Y.questions)||void 0===L?void 0:L.find(j=>j.questionId==(null==D?void 0:D.questionId));D.isAfirmative=null==Q?void 0:Q.isAfirmative}),this.product.isActivated=!0):(null===(e=this.product)||void 0===e?void 0:e.isActivated)||(this.product.isActivated=!1)}if(this.equipments){const Y=this.currentStep-1,D=null===(b=null===(c=this.equipments[Y])||void 0===c?void 0:c.products)||void 0===b?void 0:b.find(L=>L.id===this.product.id);D?(this.product.item=null==D?void 0:D.item,this.product.value=null==D?void 0:D.value,null===(q=null===(A=this.product)||void 0===A?void 0:A.questions)||void 0===q||q.map(L=>{var Q;const j=null===(Q=null==D?void 0:D.questions)||void 0===Q?void 0:Q.find(N=>N.questionId==(null==L?void 0:L.questionId));L.isAfirmative=null==j?void 0:j.isAfirmative}),this.product.isActivated=!0):(null===(z=this.product)||void 0===z?void 0:z.isActivated)||(this.product.isActivated=!1),this.product.equipmentDeclaredValue=(null===(X=this.equipments[Y])||void 0===X?void 0:X.declaredValue)||void 0}}}return C.\u0275fac=function(v){return new(v||C)},C.\u0275cmp=o.Xpm({type:C,selectors:[["app-product-item"]],inputs:{product:"product",activeProducts:"activeProducts",equipments:"equipments",currentStep:"currentStep"},outputs:{count:"count"},decls:4,vars:3,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"product","count"],[1,"card","product-card"],[1,"d-flex","justify-content-between"],[1,"d-flex","align-items-center","label-products"],[1,"bold-label-sm","m-0"],["placement","right",1,"fas","fa-info-circle","info-icon","ml-3","text-gray-200",3,"ngbTooltip"],[3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngbCollapse","ngbCollapseChange"],["collapse","ngbCollapse"],[3,"product"]],template:function(v,M){1&v&&(o.TgZ(0,"div",0),o.YNc(1,s,2,1,"div",1),o.YNc(2,i,2,1,"div",1),o.YNc(3,F,12,7,"div",2),o.qZA()),2&v&&(o.Q6J("ngSwitch",M.product.selectorType),o.xp6(1),o.Q6J("ngSwitchCase","ValueSelect"),o.xp6(1),o.Q6J("ngSwitchCase","ItemSelect"))},styles:[".product-card[_ngcontent-%COMP%]{padding:1rem;margin-bottom:1.5rem}.label-products[_ngcontent-%COMP%]{width:400px}"]}),C})()},3421:(pe,oe,r)=>{r.d(oe,{T:()=>Pe});var o=r(9808),h=r(2762),s=r(5e3),i=r(3075),l=r(801),F=r(701),g=r(7751),C=r(815),m=r(6517),v=r(2387),M=r(1042);const e=["slider"];let c=(()=>{class B{constructor(){this.disabled=!1}ngOnInit(){!this.id&&this.generateId(),this.min||(this.min=0),this.delta=this.max-this.min,this.value||(this.value=0,this._slider.nativeElement.style.background="linear-gradient(90deg, #2479BC 0.1%, #efefef 0.1%)"),this._slider.nativeElement.style.background=this.min==this.value?"linear-gradient(90deg, #2479BC 0.1%, #efefef 0.1%)":`linear-gradient(90deg, #2479BC ${(this.value-this.min)/this.delta*100}%, #efefef ${100*(this.value-this.min/this.delta)}%)`}ngAfterViewInit(){}registerOnChange(x){this.onChange=x}writeValue(x){x&&this.updateState(x)}registerOnTouched(x){this.onTouched=x}setDisabledState(x){this.disabled=x}generateId(){this.id=`slider-${M.Z()}`}onInput(x){this.updateState(x.target.value)}updateState(x){let _=x;_>this.max&&(_=this.max),_<this.min&&(_=this.min);let I=_;_%this.step!=0&&(I+=_%this.step),this._slider.nativeElement.style.background=`linear-gradient(90deg, #2479BC ${(I-this.min)/this.delta*100}%, #efefef ${(I-this.min)/this.delta*100}%)`,this.value=Number(_),this.onChange(this.value)}onButtonClick(x){let _;"+"===x?_=Number(this.value)+this.step:"-"===x&&(_=Number(this.value)-this.step),this.updateState(_)}}return B.\u0275fac=function(x){return new(x||B)},B.\u0275cmp=s.Xpm({type:B,selectors:[["range-slider"]],viewQuery:function(x,_){if(1&x&&s.Gf(e,7),2&x){let I;s.iGM(I=s.CRH())&&(_._slider=I.first)}},inputs:{id:"id",min:"min",max:"max",step:"step"},features:[s._Bn([{provide:i.JU,useExisting:(0,s.Gpc)(()=>B),multi:!0}])],decls:16,vars:13,consts:[[1,"range"],[1,"d-flex","align-items-center"],[1,"btn","range-btn","mr-2",3,"click"],["src","../../../../assets/icons/minus.svg","alt","Subtrair"],["type","range",1,"slider",3,"min","max","value","step","input"],["slider",""],[1,"btn","range-btn","ml-2",3,"click"],["src","../../../../assets/icons/plus-sm.svg","alt","Adicionar"],[1,"d-flex","align-items-center","justify-content-between"],[1,"range-label"]],template:function(x,_){1&x&&(s.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"button",2),s.NdJ("click",function(){return _.onButtonClick("-")}),s._UZ(4,"img",3),s.qZA(),s.TgZ(5,"input",4,5),s.NdJ("input",function(H){return _.onInput(H)}),s.qZA(),s.TgZ(7,"button",6),s.NdJ("click",function(){return _.onButtonClick("+")}),s._UZ(8,"img",7),s.qZA()(),s.TgZ(9,"div",8)(10,"span",9),s._uU(11),s.ALo(12,"currency"),s.qZA(),s.TgZ(13,"span",9),s._uU(14),s.ALo(15,"currency"),s.qZA()()()()),2&x&&(s.uIk("id",_.id),s.xp6(5),s.Q6J("min",_.min)("max",_.max)("value",_.value)("step",_.step),s.xp6(6),s.Oqu(s.xi3(12,7,_.min,"BRL")),s.xp6(3),s.Oqu(s.xi3(15,10,_.max,"BRL")))},pipes:[o.H9],styles:[".range[_ngcontent-%COMP%]{display:flex;flex-direction:column}.range-btn[_ngcontent-%COMP%]{font-weight:500;font-size:16px;background:#2479bc;cursor:pointer;display:flex;align-items:center;justify-content:center;width:24px;height:24px;border:0;border-radius:50%;color:#fff}.range-btn[_ngcontent-%COMP%]:hover{filter:brightness(.8)}.slider[_ngcontent-%COMP%]{-webkit-appearance:none;width:100%;height:10px;background:linear-gradient(90deg,#efefef 60%,#efefef 60%);outline:none;opacity:.8;transition:opacity .2s;border-radius:5px;cursor:pointer}.slider[_ngcontent-%COMP%]:hover{opacity:1}.slider[_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;width:34px;height:34px;border-radius:50%;background:#2479bc;border:4px solid #fff;cursor:pointer}.slider[_ngcontent-%COMP%]::-moz-range-thumb{width:34px;height:34px;border-radius:50%;background:#2479bc;border:4px solid #fff;cursor:pointer;box-shadow:0 0 7px #0000004d}.range-label[_ngcontent-%COMP%]{color:#9ba2a8;font-weight:700;font-size:16px;margin-top:8px}"]}),B})();var b=r(7345);function A(B,J){if(1&B&&(s.TgZ(0,"span",7),s._uU(1),s.ALo(2,"firstLetterCapital"),s.qZA()),2&B){const x=s.oxw().$implicit;s.xp6(1),s.hij(" ",s.lcZ(2,1,null==x?null:x.question)," ")}}function q(B,J){if(1&B){const x=s.EpF();s.TgZ(0,"div",4),s.YNc(1,A,3,3,"span",5),s.TgZ(2,"toggler",6),s.NdJ("ngModelChange",function(I){return s.CHM(x).$implicit.isAfirmative=I}),s.qZA()()}if(2&B){const x=J.$implicit;s.xp6(1),s.Q6J("ngIf",null==x?null:x.question),s.xp6(1),s.Q6J("value",null==x?null:x.isAfirmative)("ngModel",x.isAfirmative)}}function z(B,J){if(1&B&&(s.TgZ(0,"div",1)(1,"div",2),s.YNc(2,q,3,3,"div",3),s.qZA()()),2&B){const x=s.oxw();s.xp6(2),s.Q6J("ngForOf",null==x.product?null:x.product.questions)}}let X=(()=>{class B{constructor(){}ngOnInit(){}}return B.\u0275fac=function(x){return new(x||B)},B.\u0275cmp=s.Xpm({type:B,selectors:[["app-questions"]],inputs:{product:"product"},decls:1,vars:1,consts:[["class","card mt-4 p-2",4,"ngIf"],[1,"card","mt-4","p-2"],[1,"d-flex","align-items-center","flex-column"],["style","\n          display: flex;\n          justify-content: space-between;\n          width: 95%;\n          margin: 10px 0px;\n        ",4,"ngFor","ngForOf"],[2,"display","flex","justify-content","space-between","width","95%","margin","10px 0px"],["style","color: #818a91","class","range-value align-self-center mr-2 mb-0",4,"ngIf"],[3,"value","ngModel","ngModelChange"],[1,"range-value","align-self-center","mr-2","mb-0",2,"color","#818a91"]],template:function(x,_){1&x&&s.YNc(0,z,3,1,"div",0),2&x&&s.Q6J("ngIf",null==_.product||null==_.product.questions?null:_.product.questions.length)},directives:[o.O5,o.sg,C.u,i.JJ,i.On],pipes:[b.l],styles:[""]}),B})();var Y=r(8076);const D=["productItemRangeInput"],L=["collapse"],Q=function(){return{prefix:"R$ ",thousands:".",decimal:",",align:"right",nullable:!1}};function j(B,J){if(1&B){const x=s.EpF();s.TgZ(0,"div",16)(1,"label",17),s._uU(2,"O Valor"),s.qZA(),s.TgZ(3,"input",18,19),s.NdJ("ngModelChange",function(I){return s.CHM(x),s.oxw(3).product.value=I}),s.ALo(5,"inputSize"),s.qZA(),s.TgZ(6,"i",20),s.NdJ("click",function(){s.CHM(x);const I=s.oxw(3);return(null==I.productValue?null:I.productValue.disabled)&&I.toggleInput()}),s.qZA()()}if(2&B){const x=s.oxw(3);s.xp6(3),s.Q6J("size",s.lcZ(5,3,x.product.value))("ngModel",x.product.value)("options",s.DdM(5,Q))}}function N(B,J){if(1&B){const x=s.EpF();s.TgZ(0,"form",21)(1,"div",22)(2,"label",17),s._uU(3,"O Valor"),s.qZA(),s.TgZ(4,"input",23,19),s.NdJ("blur",function(){return s.CHM(x),s.oxw(3).blurInput()})("keyup.enter",function(){return s.CHM(x),s.oxw(3).setValue()}),s.ALo(6,"inputSize"),s.qZA()()()}if(2&B){const x=s.oxw(3);s.Q6J("formGroup",x.form),s.xp6(4),s.Q6J("size",s.lcZ(6,3,x.product.value))("options",s.DdM(5,Q))}}function V(B,J){if(1&B&&(s.TgZ(0,"div",13),s.YNc(1,j,7,6,"div",14),s.YNc(2,N,7,6,"form",15),s.qZA()),2&B){const x=s.oxw(2);s.xp6(1),s.Q6J("ngIf",null==x.productValue?null:x.productValue.disabled),s.xp6(1),s.Q6J("ngIf",null==x.productValue?null:x.productValue.enabled)}}const y=function(){return{standalone:!0}};function S(B,J){if(1&B){const x=s.EpF();s.ynx(0),s.TgZ(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"span",4),s._uU(6),s.qZA(),s._UZ(7,"i",5),s.qZA(),s.TgZ(8,"toggler",6),s.NdJ("click",function(){return s.CHM(x),s.oxw().clickToggle()})("ngModelChange",function(I){return s.CHM(x),s.oxw().product.isActivated=I}),s._uU(9," > "),s.qZA()(),s.TgZ(10,"div",7,8),s.NdJ("ngbCollapseChange",function(I){return s.CHM(x),!(s.oxw().product.isActivated=I)}),s.TgZ(12,"div",9),s.YNc(13,V,3,2,"div",10),s.TgZ(14,"range-slider",11),s.NdJ("ngModelChange",function(I){return s.CHM(x),s.oxw().product.value=I}),s.qZA()(),s._UZ(15,"app-questions",12),s.qZA()()(),s.BQk()}if(2&B){const x=s.oxw();s.xp6(6),s.Oqu(null==x.product?null:x.product.displayName),s.xp6(1),s.s9C("ngbTooltip",null==x.product?null:x.product.description),s.xp6(1),s.Q6J("ngModel",x.product.isActivated)("ngModelOptions",s.DdM(12,y)),s.xp6(2),s.Q6J("ngbCollapse",!x.product.isActivated),s.xp6(3),s.Q6J("ngIf",!x.editingValue),s.xp6(1),s.Q6J("ngModel",x.product.value)("ngModelOptions",s.DdM(13,y))("max",x.max)("min",x.min)("step",x.rangeStep),s.xp6(1),s.Q6J("product",x.product)}}let U=(()=>{class B{constructor(x,_){this.formBuilder=x,this.servicePanelFacade=_,this.inputActive=!1,this.change=new s.vpe,this.count=new s.vpe,this.form=this.formBuilder.group({productValue:[""]}),this.icons={edit:l.IwR,done:l.LEp},this.slider=700,this.editingValue=!1,this.rangeStep=1,this.min=0,this.max=0,this.disabled=!1}ngOnInit(){this.servicePanelFacade.servicePanelData$.subscribe(x=>{this.max="Equipment"==this.product.autoType?Math.min(Number(this.product.equipmentDeclaredValue),this.product.maximumValue)||this.product.maximumValue:Math.min(Number(x.rawValueForm?x.rawValueForm.invoiceValue||x.rawValueForm.fipeValue||x.rawValueForm.vehicleValue||x.rawValueForm.declaredValue:x.selectedAsset.declaredValue),this.product.maximumValue)||this.product.maximumValue,this.min=this.max<this.min?this.max:this.product.minimalValue,this.disabled=this.min>this.product.equipmentDeclaredValue||this.min>(x.rawValueForm?Number(x.rawValueForm.invoiceValue||x.rawValueForm.fipeValue||x.rawValueForm.vehicleValue||x.rawValueForm.declaredValue):x.selectedAsset.declaredValue),this.count.next(!this.disabled)}),this.form=this.formBuilder.group({productValue:[{value:this.product.value,disabled:!0},[i.kI.required,i.kI.min(this.min),i.kI.max(this.max)]]})}get minValue(){return Number(this.min)}get maxValue(){return Number(this.max)}get productValue(){return this.form.get("productValue")}editValue(){this.editingValue=!0,setTimeout(()=>{this.editInput.nativeElement.focus()},100)}editValueDone(x){console.log(x)}clickToggle(){this.collapse.toggle(),this.product.value||(this.product.value=this.product.minimalValue)}toggleInput(){var x,_;this.form.markAsDirty(),this.form.markAllAsTouched(),(null===(x=this.productValue)||void 0===x?void 0:x.disable)&&this.form.patchValue({productValue:this.product.value}),this.toggleProductValue(),(null===(_=this.productValue)||void 0===_?void 0:_.enabled)&&setTimeout(()=>this.editInput.nativeElement.focus(),0)}setValue(){var x;this.form.valid?(this.toggleProductValue(),this.product.value=null===(x=this.productValue)||void 0===x?void 0:x.value):setTimeout(()=>{var _;return null===(_=this.editInput.nativeElement)||void 0===_?void 0:_.focus()},10)}blurInput(){var x;(null===(x=this.productValue)||void 0===x?void 0:x.enabled)&&(this.toggleProductValue(),this.form.patchValue({productValue:this.product.value}))}toggleProductValue(){var x,_,I;(null===(x=this.productValue)||void 0===x?void 0:x.enabled)?null===(_=this.productValue)||void 0===_||_.disable():null===(I=this.productValue)||void 0===I||I.enable()}toggleIsAffirmative(){}}return B.\u0275fac=function(x){return new(x||B)(s.Y36(i.qu),s.Y36(F.e))},B.\u0275cmp=s.Xpm({type:B,selectors:[["app-product-item-range"]],viewQuery:function(x,_){if(1&x&&(s.Gf(D,5),s.Gf(L,5)),2&x){let I;s.iGM(I=s.CRH())&&(_.editInput=I.first),s.iGM(I=s.CRH())&&(_.collapse=I.first)}},inputs:{product:"product"},outputs:{change:"change",count:"count"},decls:1,vars:1,consts:[[4,"ngIf"],["id","productComponent",1,"card","product-card"],[1,"d-flex","flex-column"],[1,"d-flex","align-items-center","justify-content-between"],[1,"bold-label-sm","m-0"],["placement","right",1,"fas","fa-info-circle","info-icon","ml-3","text-gray-300",3,"ngbTooltip"],[3,"ngModel","ngModelOptions","click","ngModelChange"],[1,"toggle-on",3,"ngbCollapse","ngbCollapseChange"],["collapse","ngbCollapse"],[1,"range","d-flex","justify-content-center","flex-column"],["class","d-flex justify-content-center w-100 align-items-center mb-4","style","transition: -0.2s ease-in-out;",4,"ngIf"],[3,"ngModel","ngModelOptions","max","min","step","ngModelChange"],[3,"product"],[1,"d-flex","justify-content-center","w-100","align-items-center","mb-4",2,"transition","-0.2s ease-in-out"],["class","form-group product-value-input d-flex align-items-center",4,"ngIf"],["class","product-value-input",3,"formGroup",4,"ngIf"],[1,"form-group","product-value-input","d-flex","align-items-center"],["hidden","","for","company-cnpj"],["disabled","","id","productValue","type","text","currencyMask","","autocomplete","off",1,"range-value","text-gray-300","align-self-end","mr-2","mb-0","form-control","input-disabled",3,"size","ngModel","options","ngModelChange"],["productItemRangeInput",""],[1,"text-gray-500","fas","fa-pen","icon-edit",3,"click"],[1,"product-value-input",3,"formGroup"],[1,"form-group","product-value-input"],["id","productValue","type","text","formControlName","productValue","currencyMask","","autocomplete","off",1,"range-value","text-gray-300","align-self-end","mr-2","mb-0","form-control","editing","bg-validation-hidden",3,"size","options","blur","keyup.enter"]],template:function(x,_){1&x&&s.YNc(0,S,16,14,"ng-container",0),2&x&&s.Q6J("ngIf",!_.disabled)},directives:[o.O5,g._L,C.u,i.JJ,i.On,g._D,m.HK,i.Fj,m.oH,v.g1,i._Y,i.JL,i.sg,m.MU,i.u,c,X],pipes:[Y.N],styles:[".product-card[_ngcontent-%COMP%]{padding:1.5rem;margin-bottom:1.5rem}.form-group.product-value-input[_ngcontent-%COMP%]{margin-bottom:0!important;position:relative}.form-group.product-value-input[_ngcontent-%COMP%]   .form-control.range-value[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content;max-width:100%;border:none;font-size:30px;font-weight:500;line-height:1.2;background-color:transparent;border-radius:0!important}.form-group.product-value-input[_ngcontent-%COMP%]   .form-control.range-value.editing[_ngcontent-%COMP%]{border-bottom:1px solid #d8d8d8;transition:ease-in-out .7ms;filter:brightness(.98)}.form-group.product-value-input[_ngcontent-%COMP%]   .form-control.range-value[_ngcontent-%COMP%]:disabled{background-color:transparent}.form-group.product-value-input[_ngcontent-%COMP%]   .form-control.range-value[_ngcontent-%COMP%]:focus{box-shadow:none}.form-group.product-value-input[_ngcontent-%COMP%]   .form-control.range-value.input-disabled[_ngcontent-%COMP%]{padding-right:calc(1.5em + .75rem)}.form-group.product-value-input[_ngcontent-%COMP%]   .icon-edit[_ngcontent-%COMP%]{cursor:pointer;margin-left:5px;position:absolute;font-size:1.2rem;top:22%;right:8%}.form-group.product-value-input[_ngcontent-%COMP%]     .invalid-feedback{text-align:left!important}.toggle-on[_ngcontent-%COMP%]{margin-top:2rem}"]}),B})();var R=r(4107),le=r(508);function ne(B,J){if(1&B&&(s.TgZ(0,"mat-option",15),s._uU(1),s.ALo(2,"titlecase"),s.qZA()),2&B){const x=J.$implicit;s.Q6J("value",null==x?null:x.id),s.xp6(1),s.hij(" ",s.lcZ(2,2,null==x?null:x.description)," ")}}function de(B,J){if(1&B&&(s.ynx(0),s.TgZ(1,"mat-select",12)(2,"mat-option",13),s._uU(3,"Selecione"),s.qZA(),s.YNc(4,ne,3,4,"mat-option",14),s.qZA(),s.BQk()),2&B){const x=s.oxw();s.xp6(2),s.Q6J("disabled",!0),s.xp6(2),s.Q6J("ngForOf",null==x.product?null:x.product.items)}}const fe=function(B){return{opacity:B}},he=function(){return{standalone:!0}};let ue=(()=>{class B{constructor(x){this.formBuilder=x,this.selectForm=this.formBuilder.group({itemSelect:["",i.kI.required]}),this.count=new s.vpe}ngOnInit(){var x;this.count.next(!0),this.product.isActivated&&this.selectForm.patchValue({itemSelect:this.product.item}),null===(x=this.selectForm.get("itemSelect"))||void 0===x||x.valueChanges.subscribe(_=>this.product.item=_)}}return B.\u0275fac=function(x){return new(x||B)(s.Y36(i.qu))},B.\u0275cmp=s.Xpm({type:B,selectors:[["app-product-item-dropdown"]],inputs:{product:"product"},outputs:{count:"count"},decls:15,vars:12,consts:[["id","productComponent",1,"card","product-card"],[1,"d-flex","flex-column"],[1,"d-flex","align-items-center","justify-content-between"],[1,"bold-label-sm","m-0"],["placement","right",1,"fas","fa-info-circle","info-icon","ml-3","text-gray-300",3,"ngbTooltip"],[1,"d-flex","align-items-center","w-50"],[1,"w-100","mb-0","mr-3",2,"transition","0.2s ease-in-out",3,"formGroup","ngStyle"],[4,"ngIf"],[3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngbCollapse","ngbCollapseChange"],["collapse","ngbCollapse"],[3,"product"],["formControlName","itemSelect",2,"border","0.1px solid","padding","0 10px","border-color","rgba(0, 0, 0, 0.4)","font-family","sans-serif","border-radius","4px"],["value","",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(x,_){1&x&&(s.ynx(0),s.TgZ(1,"div",0)(2,"div",1)(3,"div",2)(4,"div")(5,"span",3),s._uU(6),s.qZA(),s._UZ(7,"i",4),s.qZA(),s.TgZ(8,"div",5)(9,"div",6),s.YNc(10,de,5,2,"ng-container",7),s.qZA(),s.TgZ(11,"toggler",8),s.NdJ("ngModelChange",function(H){return _.product.isActivated=H}),s.qZA()()(),s.TgZ(12,"div",9,10),s.NdJ("ngbCollapseChange",function(H){return!(_.product.isActivated=H)}),s._UZ(14,"app-questions",11),s.qZA()()(),s.BQk()),2&x&&(s.xp6(6),s.Oqu(null==_.product?null:_.product.displayName),s.xp6(1),s.s9C("ngbTooltip",null==_.product?null:_.product.description),s.xp6(2),s.Q6J("formGroup",_.selectForm)("ngStyle",s.VKq(9,fe,null!=_.product&&_.product.isActivated?"1":"0")),s.xp6(1),s.Q6J("ngIf",null==_.product?null:_.product.isActivated),s.xp6(1),s.Q6J("ngModel",_.product.isActivated)("ngModelOptions",s.DdM(11,he)),s.xp6(1),s.Q6J("ngbCollapse",!_.product.isActivated),s.xp6(2),s.Q6J("product",_.product))},directives:[g._L,i.JL,i.sg,m.MU,o.PC,o.O5,R.gD,i.JJ,i.u,le.ey,o.sg,C.u,i.On,g._D,X],pipes:[o.rS],styles:[".product-card[_ngcontent-%COMP%]{padding:1.5rem;margin-bottom:1.5rem}"]}),B})();var ye=r(7622);let Me=(()=>{class B{}return B.\u0275fac=function(x){return new(x||B)},B.\u0275mod=s.oAB({type:B}),B.\u0275inj=s.cJS({providers:[],imports:[[ye.m,i.u5,g.lQ,R.LD]]}),B})();s.B6R(h.V,[o.RF,o.n9,U,ue,o.ED,g._L,C.u,i.JJ,i.On,g._D,X],[]);let Pe=(()=>{class B{}return B.\u0275fac=function(x){return new(x||B)},B.\u0275mod=s.oAB({type:B}),B.\u0275inj=s.cJS({providers:[],imports:[[o.ez,Me,ye.m]]}),B})()},9093:(pe,oe,r)=>{r.d(oe,{k:()=>B});var o=r(8966),h=r(8306),s=r(7579),i=r(1135),l=r(5698),F=r(4004),g=r(8746),C=r(1094),m=r(2498),v=r(8663),M=r(5598),e=r(701),c=r(5e3),b=r(3047),A=r(2569),q=r(2290),z=r(7751),X=r(1299),Y=r(9808),D=r(2178),L=r(2762);const Q=["productComponent"];function j(J,x){if(1&J){const _=c.EpF();c.ynx(0),c.TgZ(1,"app-stepper",11),c.NdJ("stepClicked",function(H){return c.CHM(_),c.oxw().changeStep(H)}),c.qZA(),c.BQk()}if(2&J){const _=c.oxw();c.xp6(1),c.Q6J("steps",_.servicePanelItems)("currentStep",_.currentStep)}}function N(J,x){if(1&J&&(c.TgZ(0,"div",22)(1,"div",23)(2,"span",24),c._uU(3),c.ALo(4,"uppercase"),c.qZA(),c.TgZ(5,"span",25),c._uU(6),c.qZA()()()),2&J){const _=c.oxw(2).$implicit;c.xp6(3),c.hij(" ",c.lcZ(4,2,null!=_&&null!=_.item&&_.item.licensePlate?null==_||null==_.item?null:_.item.licensePlate:null!=_&&null!=_.item&&_.item.chassis?null==_||null==_.item?null:_.item.chassis:null==_||null==_.item?null:_.item.serialNumber)," "),c.xp6(3),c.hij(" ",null!=_&&null!=_.item&&_.item.model?(null==_||null==_.item?null:_.item.model.description)||(null==_||null==_.item?null:_.item.model):null==_||null==_.item?null:_.item.description," ")}}const V=function(J){return{active:J}};function y(J,x){if(1&J){const _=c.EpF();c.TgZ(0,"div",34),c.NdJ("click",function(){const re=c.CHM(_).$implicit;return c.oxw(4).selectServicePlan(re)}),c.TgZ(1,"div",31),c._UZ(2,"img",32),c.qZA(),c.TgZ(3,"div",33),c._uU(4),c.qZA()()}if(2&J){const _=x.$implicit,I=c.oxw(3).$implicit;c.s9C("ngbTooltip",null==_?null:_.description),c.Q6J("ngClass",c.VKq(3,V,(null==I||null==I.selectedServicePlan?null:I.selectedServicePlan.id)==(null==_?null:_.id))),c.xp6(4),c.hij(" ",null==_?null:_.displayName," ")}}function S(J,x){if(1&J){const _=c.EpF();c.TgZ(0,"div",12)(1,"div",13)(2,"h4",26),c._uU(3,"Selecione o plano de servi\xe7os"),c.qZA(),c.TgZ(4,"div",27)(5,"div",28),c.YNc(6,y,5,5,"div",29),c.TgZ(7,"div",30),c.NdJ("click",function(){return c.CHM(_),c.oxw(3).selectCustomServicePlan()}),c.TgZ(8,"div",31),c._UZ(9,"img",32),c.qZA(),c.TgZ(10,"div",33),c._uU(11,"Personalizado"),c.qZA()()()()()()}if(2&J){const _=c.oxw(2).$implicit;c.xp6(6),c.Q6J("ngForOf",_.servicePlans),c.xp6(1),c.Q6J("ngClass",c.VKq(2,V,null===(null==_?null:_.selectedServicePlan)))}}function U(J,x){if(1&J){const _=c.EpF();c.TgZ(0,"div",13)(1,"app-product-item",38,39),c.NdJ("count",function(H){return c.CHM(_),c.oxw(4).checkIfHasAnyProduct(H)}),c.qZA()()}if(2&J){const _=x.$implicit,I=c.oxw(4);c.Q6J("@fadeInAnim",void 0),c.xp6(1),c.Q6J("product",_)("activeProducts",I.activeProducts)("equipments",I.equipments)("currentStep",I.currentStep)}}function R(J,x){1&J&&(c.TgZ(0,"div",13)(1,"h4",26),c._uU(2,"Nenhum servi\xe7o dispon\xedvel para este bem."),c.qZA()())}function le(J,x){if(1&J&&(c.TgZ(0,"div",35),c.YNc(1,U,3,5,"div",36),c.YNc(2,R,3,0,"div",37),c.ALo(3,"async"),c.qZA()),2&J){const _=c.oxw(2).$implicit,I=c.oxw();c.xp6(1),c.Q6J("ngForOf",null==_?null:_.products),c.xp6(1),c.Q6J("ngIf",!c.lcZ(3,2,I.productsCount$))}}function ne(J,x){if(1&J&&(c.ynx(0),c.TgZ(1,"div",12)(2,"div",13)(3,"div",14)(4,"div",2)(5,"div",15)(6,"span",16,17),c._uU(8),c.qZA(),c._UZ(9,"i",18),c.qZA(),c.YNc(10,N,7,4,"div",19),c.qZA()()()(),c.YNc(11,S,12,4,"div",20),c.YNc(12,le,4,4,"div",21),c.BQk()),2&J){const _=c.oxw().$implicit,I=c.oxw();c.xp6(8),c.hij("",null!=_&&_.isEquipment?"Equipamento":"Bem"," adicionado"),c.xp6(1),c.MGl("ngbTooltip","",null!=_&&_.isEquipment?"Equipamento":"Bem"," adicionado"),c.xp6(1),c.Q6J("ngIf",null==_?null:_.item),c.xp6(1),c.Q6J("ngIf",_.servicePlans.length),c.xp6(1),c.Q6J("ngIf",I.allProductsLoaded)}}function de(J,x){if(1&J&&(c.ynx(0),c.YNc(1,ne,13,5,"ng-container",5),c.BQk()),2&J){const _=x.$implicit,I=c.oxw();c.xp6(1),c.Q6J("ngIf",_.index===I.currentStep)}}function fe(J,x){1&J&&(c.TgZ(0,"div",40)(1,"div",41)(2,"span",42),c._uU(3,"Loading..."),c.qZA()()())}function he(J,x){if(1&J){const _=c.EpF();c.ynx(0),c.TgZ(1,"button",43),c.NdJ("click",function(){return c.CHM(_),c.oxw().changeStep({direction:"back"})}),c._uU(2," Voltar "),c.qZA(),c.TgZ(3,"button",44),c.NdJ("click",function(){return c.CHM(_),c.oxw().closePanel(!0)}),c._uU(4," Salvar "),c.qZA(),c.BQk()}}function ue(J,x){if(1&J){const _=c.EpF();c.TgZ(0,"button",43),c.NdJ("click",function(){return c.CHM(_),c.oxw().closePanel()}),c._uU(1," Voltar "),c.qZA(),c.TgZ(2,"button",45),c.NdJ("click",function(){return c.CHM(_),c.oxw().changeStep({direction:"forward"})}),c._uU(3," Pr\xf3ximo "),c.qZA()}}const ye=function(){return{text:"Criar proposta"}},Me=function(){return{text:"Servi\xe7os"}},Pe=function(J,x){return[J,x]};let B=(()=>{class J extends m.o{constructor(_,I,H,re,ge,me,Te,Ee){super(_,Ee),this.injector=_,this.quotationService=I,this.dialogRef=H,this.loading=re,this.servicesPanelHelper=ge,this.toastr=me,this.data=Te,this.modalService=Ee,this.servicePanelItems=new Array,this.currentStep=0,this.products$=new h.y,this.productsCount$=new s.x,this.equipments=new Array,this.allProductsLoaded=!1,this.productsReceived=[],this.verifyValidForm=new i.X(null)}ngOnInit(){var _,I,H,re;this.servicesPanelHelper.servicePanelData$.next(this.data),this.loading.show(),this.onlyProductsEditing=Boolean(this.data.selectedAsset),this.onlyProductsEditing||(this.activeProducts=this.data.rawValueForm.products||[],this.equipments=null===(I=null===(_=this.data)||void 0===_?void 0:_.rawValueForm)||void 0===I?void 0:I.equipments,this.vehicle=this.data.rawValueForm,this.assetType=null===(H=this.data.assetData.asset)||void 0===H?void 0:H.assetType,this.quotationId=this.data.assetData.quotationId,this.autoType=null===(re=this.data.assetData.asset)||void 0===re?void 0:re.autoType,this.requiredEvents()),this.onlyProductsEditing&&this.quotationService[this.data.selectedAsset.autoType==v.rQ.Aggregate?"getAssetAggregate":"getAssetVehicle"](this.data.quotationId,this.data.selectedAsset.id).pipe((0,l.q)(1)).subscribe(me=>{this.activeProducts=null==me?void 0:me.products,this.equipments=null==me?void 0:me.equipments,this.vehicle=me,this.assetType=this.data.selectedAsset.assetType,this.quotationId=this.data.quotationId,this.autoType=this.data.selectedAsset.autoType,this.requiredEvents()})}requiredEvents(){this.createItems(this.vehicle),this.populateProductsOfItems(),this.populateServicePlansOfItems()}get currentItem(){return this.servicePanelItems[this.currentStep]}createItems(_){var I;this.servicePanelItems.push({index:0,label:"Bem",item:_,products:this.activeProducts,servicePlans:[],selectedServicePlan:null,isEquipment:!1}),(null==_?void 0:_.equipments)&&(null===(I=null==_?void 0:_.equipments)||void 0===I||I.forEach((H,re)=>{(null==H?void 0:H.operation)!==M.B.Remove&&this.servicePanelItems.push({index:re+1,label:`Equipamento ${re+1}`,item:H,products:this.equipments,servicePlans:[],selectedServicePlan:null,isEquipment:!0})}))}populateProductsOfItems(){if(this.assetType!=v.un.Auto)throw new Error("Tipo de bem selecionado n\xe3o possui endpoint de produtos integrado.");this.servicePanelItems.forEach(_=>{this.quotationService.getAutoTypeProducts(this.quotationId,_.isEquipment?v.rQ.Equipment:this.autoType).pipe((0,l.q)(1),(0,F.U)(I=>({isEquipment:_.isEquipment,products:I})),(0,g.x)(()=>{setTimeout(()=>{this.loading.hide()},2e3)})).subscribe(({products:H})=>{_.products=H,this.allProductsLoaded=!0})})}populateServicePlansOfItems(){this.quotationService.getServicePlans(this.quotationId,this.assetType).pipe((0,l.q)(1)).subscribe(_=>{this.servicePanelItems.forEach(I=>{I.servicePlans=_})})}closePanel(_=!1){if(!_||!this.checkIfProductsIsValid()&&this.checkIfAnyProductIsActive())this.onlyProductsEditing||this.itemPreparationToSaveInForm(_),this.onlyProductsEditing&&this.specifItemPreparationToSave(_);else{const I=this.checkIfAnyProductIsActive()?"Verifique se todos os servi\xe7os selecionados est\xe3o com valores corretos!":"Selecione ao menos um servi\xe7o para cada equipamento ou remova o equipamento que n\xe3o possui nenhum servi\xe7o dispon\xedvel!";this.toastr.show(I,"Erro",{toastClass:"error-toast"})}}checkIfHasAnyProduct(_){setTimeout(()=>this.productsCount$.next(_),500)}itemPreparationToSaveInForm(_){_&&this.servicesPanelHelper.prepareItemToSaveInForm(this.servicePanelItems,this.data),Boolean(_)?this.dialogRef.close(this.servicePanelItems):this.dialogRef.close()}specifItemPreparationToSave(_){_&&this.servicesPanelHelper.specifItemPreparationToSave(this.servicePanelItems,this.vehicle),Boolean(_)?this.dialogRef.close({asset:this.vehicle,category:this.data.selectedAsset.assetType}):this.dialogRef.close()}checkIfProductsIsValid(){return this.servicePanelItems.some(_=>{var I;return null===(I=_.products)||void 0===I?void 0:I.some(H=>H.isActivated&&H.items&&(!H.item||"00000000-0000-0000-0000-000000000000"==H.item))})}checkIfAnyProductIsActive(){return this.servicePanelItems.every(_=>{var I;return null===(I=_.products)||void 0===I?void 0:I.some(H=>H.isActivated)})}calculateRangeValues(_){var I,H;if((null===(I=this.data.assetData.asset)||void 0===I?void 0:I.assetType)==v.un.Auto&&Object.values(v.rQ).includes(null===(H=this.data.assetData.asset)||void 0===H?void 0:H.autoType)){const re=this.data.rawValueForm;let ge=re.fipeValue*re.coverageRate/100+re.truckBodyValue+re.additionalAxleValue;return ge>_&&(ge=_),ge}return _}selectServicePlan(_){this.currentItem.selectedServicePlan=_,this.selectServicePlanProducts(_)}selectCustomServicePlan(){this.currentItem.selectedServicePlan=null}selectServicePlanProducts(_){let I=new Set(_.products.map(me=>{let Te=Object.assign({},me);return Te.selectorType=new M.b(Te),Te})),H=new Set(this.currentItem.products.map(me=>me.id)),re=new Set([...H].filter(me=>I.has(me))),ge=new Set([...H].filter(me=>!I.has(me)));this.activateProductsWhenServicePlanSelected(re),this.deactivateProductsWhenServicePlanSelected(ge)}activateProductsWhenServicePlanSelected(_){Array.from(_).forEach(H=>{this.currentItem.products.find(ge=>ge.id===H)})}deactivateProductsWhenServicePlanSelected(_){Array.from(_).forEach(H=>{this.currentItem.products.find(ge=>ge.id===H)})}emitFormSubject(_){}get productsValues(){return this.productComponents.toArray().map(_=>_.product)}changeStep(_){_.clickedStep>=0?this.currentStep=_.clickedStep:"forward"!=_.direction?0==this.currentStep?this.closePanel():this.currentStep--:this.currentStep++}ngOnDestroy(){this.servicePanelItems=[]}}return J.\u0275fac=function(_){return new(_||J)(c.Y36(c.zs3),c.Y36(b.G),c.Y36(o.so),c.Y36(A.b),c.Y36(e.e),c.Y36(q._W),c.Y36(o.WI),c.Y36(z.FF))},J.\u0275cmp=c.Xpm({type:J,selectors:[["app-services-panel-dialog"]],viewQuery:function(_,I){if(1&_&&c.Gf(Q,5),2&_){let H;c.iGM(H=c.CRH())&&(I.productComponents=H)}},features:[c._Bn([e.e]),c.qOj],decls:13,vars:11,consts:[[1,"wrapper","px-0"],[1,"container"],[1,"d-flex","flex-column"],[3,"items","isModal","closeModal"],[1,"card","container-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["loading",""],[1,"action-buttons","d-flex","align-items-center","justify-content-end"],[4,"ngIf","ngIfElse"],["previousNextBtns",""],[3,"steps","currentStep","stepClicked"],[1,"row","mt-3"],[1,"col-lg-12"],[1,"card","product-card"],[1,"d-flex","align-items-center","mb-3"],[1,"bold-label-sm","m-0"],["labelTooltip",""],["placement","right",1,"fas","fa-info-circle","ml-3","text-gray-300",3,"ngbTooltip"],["class","card p-1 fit-content",4,"ngIf"],["class","row mt-3",4,"ngIf"],["class","row",4,"ngIf"],[1,"card","p-1","fit-content"],[1,"d-flex","align-items-center"],[1,"btn","default-cursor","border-right"],[1,"default-cursor","btn"],[1,"text-gray-500"],[1,"card","product-card","mb-3"],[1,"service-plan-cards"],["class","box-floating service-plan-card","placement","bottom",3,"ngClass","ngbTooltip","click",4,"ngFor","ngForOf"],["placement","bottom","ngbTooltip","Personalizado",1,"box-floating","service-plan-card",3,"ngClass","click"],[1,"icon-wrapper"],["src","../../../../../../assets/icons/list.svg"],[1,"label-wrapper"],["placement","bottom",1,"box-floating","service-plan-card",3,"ngClass","ngbTooltip","click"],[1,"row"],["class","col-lg-12",4,"ngFor","ngForOf"],["class","col-lg-12",4,"ngIf"],[3,"product","activeProducts","equipments","currentStep","count"],["productComponent",""],[1,"d-flex","justify-content-center","w-100","align-items-center","h-100"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"btn","btn-outline-light-atb","btn-lg",3,"click"],[1,"btn","btn-success-atb","btn-lg","ml-3",3,"click"],[1,"btn","btn-primary-atb","btn-lg","ml-3",3,"click"]],template:function(_,I){if(1&_&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-breadcrumb",3),c.NdJ("closeModal",function(){return I.dialogRef.close()}),c.qZA(),c.TgZ(4,"div",4),c.YNc(5,j,2,2,"ng-container",5),c.YNc(6,de,2,1,"ng-container",6),c.YNc(7,fe,4,0,"ng-template",null,7,c.W1O),c.TgZ(9,"div",8),c.YNc(10,he,5,0,"ng-container",9),c.YNc(11,ue,4,0,"ng-template",null,10,c.W1O),c.qZA()()()()()),2&_){const H=c.MAs(12);c.xp6(3),c.Q6J("items",c.WLB(8,Pe,c.DdM(6,ye),c.DdM(7,Me)))("isModal",!0),c.xp6(2),c.Q6J("ngIf",I.servicePanelItems.length>1),c.xp6(1),c.Q6J("ngForOf",I.servicePanelItems),c.xp6(4),c.Q6J("ngIf",I.currentStep==(null==I.servicePanelItems?null:I.servicePanelItems.length)-1)("ngIfElse",H)}},directives:[X.L,Y.O5,D.v,Y.sg,z._L,Y.mk,L.V],pipes:[Y.gd,Y.Ov],styles:[".mat-dialog-container{overflow:auto!important;padding:0}.wrapper[_ngcontent-%COMP%]{background-color:#f0f3f9;min-height:100vh;min-width:100vw;max-height:100vh;overflow-y:auto}  .cdk-overlay-pane{max-width:none!important}  .cdk-global-scrollblock{position:static;overflow:hidden!important}.container[_ngcontent-%COMP%]:first-child{padding:2rem 0}.card[_ngcontent-%COMP%]{padding:4.1rem 3.4rem}  .mat-dialog-container{padding:0;border-radius:0}.container-padding[_ngcontent-%COMP%]{padding:3rem 6rem}.mandatory-service[_ngcontent-%COMP%]{margin-left:1rem}.product-card[_ngcontent-%COMP%]{padding:1.5rem;margin-bottom:1.5rem}.mandatory-service[_ngcontent-%COMP%]:nth-of-type(1){margin-left:0}.range-value[_ngcontent-%COMP%]{color:#2195f3;margin-bottom:1rem}.info-icon[_ngcontent-%COMP%]{cursor:pointer}.info-icon[_ngcontent-%COMP%]:hover{filter:brightness(1.5)}.service-plan-cards[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:-1.5rem;padding:1rem}.service-plan-cards[_ngcontent-%COMP%]   .service-plan-card[_ngcontent-%COMP%]{margin:.725rem}.service-plan-card[_ngcontent-%COMP%]{min-height:112px;max-height:112px;min-width:112px;max-width:112px;border:1px solid #e7e7e7;display:flex;align-items:center;justify-content:center;flex-direction:column;cursor:pointer}.service-plan-card.active[_ngcontent-%COMP%]{border-color:transparent;box-shadow:0 0 0 2px #2195f3}.service-plan-card.active[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{color:#2195f3}.service-plan-card[_ngcontent-%COMP%]:not(.active):hover{box-shadow:0 6px 8px 2px #0000001a}.service-plan-card[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]{height:68px;display:flex;align-items:center;justify-content:center}.service-plan-card[_ngcontent-%COMP%]   .icon-wrapper[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:32px}.service-plan-card[_ngcontent-%COMP%]   .label-wrapper[_ngcontent-%COMP%]{height:28px;display:flex;font-size:12px;color:gray;text-align:center}@media screen and (max-width: 768px){.btn[_ngcontent-%COMP%]{min-width:auto}}@media screen and (min-width: 1200px) and (max-height: 800px){.bold-label-sm[_ngcontent-%COMP%], .btn-link[_ngcontent-%COMP%]{font-size:14px}}.default-cursor[_ngcontent-%COMP%]{cursor:auto!important}"],data:{animation:[C.bA,C.Gs]}}),J})()},3e3:(pe,oe,r)=>{r.d(oe,{v:()=>z});var o=r(449),h=r(1135),s=r(7579),i=r(5698),l=r(6367),F=r(312),g=r(8505),C=r(5e3),m=r(9808),v=r(3047),M=r(7751),e=r(6517),c=r(5214);function b(X,Y){if(1&X){const D=C.EpF();C.TgZ(0,"div",2)(1,"div",3),C._UZ(2,"img",4),C.TgZ(3,"button",5),C.NdJ("click",function(){return C.CHM(D),C.oxw().onOpenAssetsPanel()}),C._uU(4," + Adicionar "),C.qZA()()()}}function A(X,Y){if(1&X){const D=C.EpF();C.TgZ(0,"a",21),C.NdJ("click",function(){const j=C.CHM(D).$implicit;return C.oxw(2).selectedAssetType=j}),C._uU(1),C.qZA()}if(2&X){const D=Y.$implicit;C.xp6(1),C.Oqu(D)}}function q(X,Y){if(1&X){const D=C.EpF();C.TgZ(0,"div",6)(1,"div",7)(2,"div",8)(3,"div",9)(4,"div",10)(5,"button",11),C._uU(6),C.qZA(),C.TgZ(7,"div",12),C.YNc(8,A,2,1,"a",13),C.qZA(),C.TgZ(9,"button",14),C.NdJ("click",function(){return C.CHM(D),C.oxw().onOpenAssetsPanel()}),C._uU(10," + Adicionar "),C.qZA()()(),C.TgZ(11,"div",15),C._UZ(12,"img",16)(13,"input",17,18),C.qZA()(),C.TgZ(15,"div",19)(16,"atb-table",20),C.NdJ("onPaginator",function(Q){return C.CHM(D),C.oxw().setPaginator(Q)})("page",function(Q){C.CHM(D);const j=C.oxw();return j.loadTable(j.quotationId,Q.skip,Q.take)})("check",function(Q){return C.CHM(D),C.oxw().checkBox(Q)})("action",function(Q){return C.CHM(D),C.oxw().action(Q)})("click",function(Q){return C.CHM(D),C.oxw().onClick(Q)})("emitDeletedChecked",function(){return C.CHM(D),C.oxw().deleteChecked()}),C.ALo(17,"async"),C.ALo(18,"async"),C.qZA()()()()}if(2&X){const D=C.oxw();let L,Q;C.xp6(6),C.hij(" ",D.selectedAssetType," "),C.xp6(2),C.Q6J("ngForOf",D.categories),C.xp6(5),C.Q6J("ngbTypeahead",D.searchAsset),C.xp6(3),C.Q6J("spinner",D.spinnerSubject$)("dataSource",null==(L=C.lcZ(17,10,D.dataSource$))?null:L.items)("totalItems",null==(Q=C.lcZ(18,12,D.dataSource$))?null:Q.total)("actions",D.actions)("columns",D.columns)("hasCheckBox",!0)("showDeleteChecked",!0)}}let z=(()=>{class X extends l.K{constructor(D,L,Q){super(),this.datePipe=D,this.quotationService=L,this.modalService=Q,this.categories=["Ve\xedculos","Implementos","Im\xf3veis"],this.selectedAssetType=this.categories[0],this.checkedRows=new Array,this.vehicleIcons$=new h.X(null),this.length=0,this.dataSource$=new h.X(null),this.searching=!1,this.selection=new o.Ov(!0,[]),this.showOtherHeader=!1,this.spinnerSubject$=new h.X(!1),this.openServicesPanel=new s.x,this.openAssetsPanel=new s.x,this.deleteMultipleAssets=new s.x,this.loadAssetsTable$=new s.x,this.onPaginator=new s.x,this.columns=[{displayName:null,columnName:"autoType",hasInnerHtml:!0,cell:({autoType:j})=>this.setIcon(j),className:"flex-3"},{displayName:"Identificador",columnName:"licensePlate",hasInnerHtml:!0,cell:({licensePlate:j,chassis:N})=>this.licenseOrChassis(j,N),className:"flex-15"},{displayName:"Descri\xe7\xe3o",columnName:"model",hasInnerHtml:!0,cell:({model:j})=>`<div class="overflow-hidden" title=${j}>${j}</div>`},{displayName:"Data de inclus\xe3o",columnName:"creation",hasInnerHtml:!0,cell:({creation:j})=>this.convertDate(j),className:"flex-15"},{displayName:"Servi\xe7os",columnName:"productsCount",hasInnerHtml:!0,cell:j=>this.greenServiceCard(j),className:"flex-15"}],this.actions=[{iconClass:"fas fa-pen",eventName:"edit",tooltip:"Editar bem"},{iconClass:"fas fa-trash",eventName:"delete",tooltip:"Deletar bem"}],this.deleteChecked=()=>this.deleteMultipleAssets.next(this.checkedRows),this.searchAsset=j=>this.searchTableItem(j,this.quotationService,this.loadTable,"searchAssets",this.dataSource$,"Clique em criar para adicionar um bem.","Nenhum bem encontrado",[this.quotationId],()=>this.searching=!0)}set assetsSet(D){null==D||D.pipe((0,g.b)(()=>this.spinnerSubject$.next(!1))).subscribe(L=>this.dataSource$.next(L))}setPaginator(D){this.paginator=D,this.onPaginator.next(D)}loadTable(D=this.quotationId,L=0,Q=10){this.loadAssetsTable$.next({skip:L,take:Q})}checkBox(D){D.subscribe(L=>this.checkedRows=L)}onOpenAssetsPanel(){this.openAssetsPanel.next()}onClick(D){var L;D.clientX||null===(L=document.getElementById(D.id))||void 0===L||L.addEventListener("click",()=>{this.openServicesPanel.next(D)})}action(D){switch(D.action){case"edit":this.openAssetsPanel.next(D.element);break;case"delete":this.deleteAsset(D.element)}}customFunctions(){}deleteAsset(D){var L;const Q=this.modalService.open(F.z,{centered:!0});Q.componentInstance.list=["Deseja excluir o bem permanentemente?"],Q.componentInstance.title="Excluir",Q.componentInstance.type="alert",Q.componentInstance.confirmButtonText="Sim",Q.componentInstance.cancelButtonText="N\xe3o",null===(L=Q.closed)||void 0===L||L.subscribe(j=>{!0===j&&this.quotationService.deleteAssets(this.quotationId,D.id,D.autoType).pipe((0,i.q)(1)).subscribe(()=>{var N;1===(null===(N=this.dataSource$.getValue().items)||void 0===N?void 0:N.length)&&0!==this.paginator.pageIndex&&--this.paginator.pageIndex,this.loadTable(this.quotationId,10*this.paginator.pageIndex,10)})})}}return X.\u0275fac=function(D){return new(D||X)(C.Y36(m.uU),C.Y36(v.G),C.Y36(M.FF))},X.\u0275cmp=C.Xpm({type:X,selectors:[["app-assets-table"]],inputs:{assetsBS$:"assetsBS$",spinnerSubject$:["spinner","spinnerSubject$"],quotationId:"quotationId",assetsSet:"assetsSet"},outputs:{openServicesPanel:"openServicesPanel",openAssetsPanel:"openAssetsPanel",deleteMultipleAssets:"deleteMultipleAssets",loadAssetsTable$:"loadAssetsTable$",onPaginator:"onPaginator"},features:[C.qOj],decls:4,vars:6,consts:[["class","card d-flex no-assets-card",4,"ngIf"],["class","row w-100 m-0 table-card",4,"ngIf"],[1,"card","d-flex","no-assets-card"],[1,"illustration-container"],["src","../../../../../../../assets/img/add-assets-step.svg","alt","",1,"illustration"],[1,"btn","btn-outline-primary","mt-3",3,"click"],[1,"row","w-100","m-0","table-card"],[1,"col-lg-12"],[1,"table-header","row","d-flex","align-items-center"],[1,"col-4","col-lg-8"],[1,"dropdown","d-flex","align-items-center"],["type","button","id","assetTypeFilter","data-toggle","dropdown","aria-haspopup","true","aria-expanded","false",1,"btn","btn-transparent","dropdown-toggle","dropdown-filter"],["aria-labelledby","assetTypeFilter",1,"dropdown-menu"],["class","dropdown-item",3,"click",4,"ngFor","ngForOf"],[1,"btn","btn-outline-primary","ml-3","add-btn",3,"click"],[1,"col-lg-4","d-flex"],["src","../../../../../../assets/icons/search.svg","alt","",1,"search-icon"],["type","search","placeholder","Buscar","id","atb-search",1,"form-control","search-input",3,"ngbTypeahead"],["input",""],[1,"table-container"],[3,"spinner","dataSource","totalItems","actions","columns","hasCheckBox","showDeleteChecked","onPaginator","page","check","action","click","emitDeletedChecked"],[1,"dropdown-item",3,"click"]],template:function(D,L){if(1&D&&(C.YNc(0,b,5,0,"div",0),C.ALo(1,"async"),C.YNc(2,q,19,14,"div",1),C.ALo(3,"async")),2&D){let Q,j;C.Q6J("ngIf",0===(null==(Q=C.lcZ(1,2,L.dataSource$))?null:Q.total)&&!L.searching),C.xp6(2),C.Q6J("ngIf",(null==(j=C.lcZ(3,4,L.dataSource$))?null:j.total)>0||L.searching)}},directives:[m.O5,m.sg,M.dR,e.oH,c.a],pipes:[m.Ov],styles:["[_nghost-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{margin-top:13px}.mat-paginator-container[_ngcontent-%COMP%]{box-shadow:0 -12px 20px 12px #dbdbdb91}.mat-cell[_ngcontent-%COMP%], .mat-footer-cell[_ngcontent-%COMP%]{font-size:13px}.form-control#category-select[_ngcontent-%COMP%]{font-weight:bolder;font-size:14px}mat-row[_ngcontent-%COMP%]:hover{background-color:#0683f90d}mat-row[_ngcontent-%COMP%]:hover   .services-badge[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background:#3cc13b}.icon-row[_ngcontent-%COMP%]:hover{filter:brightness(.9)}a.action-link[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:12px}  .mat-sort-header-button{color:#0683f9!important;font-size:14px;font-weight:500}.badge[_ngcontent-%COMP%]{background:#0683f9;border-radius:4px;height:16px;width:16px;display:flex;align-items:center;justify-content:center;color:#fff}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0}.add-btn[_ngcontent-%COMP%]{height:35px;min-height:35px;font-size:14px}.services-badge[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;cursor:pointer}.services-badge[_ngcontent-%COMP%]   .services[_ngcontent-%COMP%]{background:linear-gradient(0deg,rgba(255,255,255,.7),rgba(255,255,255,.7)),#3cc13b;border-top-left-radius:4px;border-bottom-left-radius:4px;width:88px;height:24px;color:#3cc13b;font-size:12px;display:flex;align-items:center;justify-content:center}.services-badge[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{background:#9bdf9b;border-radius:0 4px 4px 0;color:#fff;height:24px;width:24px;display:flex;align-items:center;justify-content:center}.services-badge[_ngcontent-%COMP%]   .icon.active[_ngcontent-%COMP%]{background:#3cc13b}.w-10[_ngcontent-%COMP%]{flex:0 0 10%;min-width:115px}.w-15[_ngcontent-%COMP%]{flex:0 0 15%}.asset-column[_ngcontent-%COMP%]{flex:0 0 25%;min-width:115px}.services-column[_ngcontent-%COMP%]{flex:0 0 15%;min-width:115px}@media screen and (min-width: 1650px){mat-table[_ngcontent-%COMP%]{min-height:calc(100vh - 32.6rem);max-height:calc(100vh - 32.6rem)}}@media screen and (max-height: 850px){mat-table[_ngcontent-%COMP%]{min-height:calc(100vh - 470px);max-height:calc(100vh - 470px)}  mat-row, mat-footer-row[_ngcontent-%COMP%]{min-height:40px!important}.mat-cell[_ngcontent-%COMP%], .mat-footer-cell[_ngcontent-%COMP%]{font-size:11px}.asset-column[_ngcontent-%COMP%]{flex:0 0 20%}.services-column[_ngcontent-%COMP%]{flex:0 0 15%}}.no-assets-card[_ngcontent-%COMP%]{min-height:410px;justify-content:center;border:none}@media screen and (min-height: 1000px){.no-assets-card[_ngcontent-%COMP%]{min-height:450px}}.illustration-container[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;justify-content:center;flex-direction:column}.table-card[_ngcontent-%COMP%]{padding:1rem 0}  .mat-column-licensePlate{flex:none;width:100px}  .mat-column-badge{max-width:65px}  .mat-column-icon{flex:none;width:40px}  .mat-column-model{min-width:280px}  .mat-checkbox-inner-container-no-side-margin{margin-top:7px!important}.dropdown-menu.show[_ngcontent-%COMP%]{width:-webkit-fit-content;width:-moz-fit-content;width:fit-content}.dropdown-item[_ngcontent-%COMP%]{cursor:pointer}"]}),X})()},2953:(pe,oe,r)=>{r.d(oe,{t:()=>g});var o=r(3325),h=r(5e3),s=r(3075),i=r(1470),l=r(6517),F=r(9808);let g=(()=>{class C{constructor(v){this.control=v,this._value="",this.disabled=!1,this.className="",this.label="",this.allowNegative=!1,this.separator=5,this.placeholder="0%",this.control.valueAccessor=this}formatData(v){return this._value=v,(0,o.E)(v)}writeValue(v){(v||""==v)&&(this._value=(0,o.s)(v))}registerOnChange(v){this.onChange=v}registerOnTouched(v){this.onTouched=v}setDisabledState(v){this.disabled=v}get invalid(){var v;return(null===(v=this.control)||void 0===v?void 0:v.invalid)||!1}get valid(){var v;return(null===(v=this.control)||void 0===v?void 0:v.valid)||!1}get touched(){var v;return(null===(v=this.control)||void 0===v?void 0:v.touched)||!1}get dirty(){var v;return(null===(v=this.control)||void 0===v?void 0:v.dirty)||!1}get showError(){if(!this.control)return!1;const{dirty:v,touched:M}=this.control;return M&&this.onTouched(),this.invalid&&v&&M||!1}}return C.\u0275fac=function(v){return new(v||C)(h.Y36(s.a5,10))},C.\u0275cmp=h.Xpm({type:C,selectors:[["app-percent-input"]],inputs:{className:"className",label:"label",allowNegative:"allowNegative",separator:"separator",placeholder:"placeholder"},decls:2,vars:11,consts:[["thousandSeparator",".","separatorLimit","100","suffix","%","type","text",1,"form-control",3,"mask","validation","allowNegativeNumbers","ngModel","disabled","placeholder","ngClass","blur","keyup"],["percent",""]],template:function(v,M){if(1&v){const e=h.EpF();h.TgZ(0,"input",0,1),h.NdJ("blur",function(){return M.onTouched()})("keyup",function(){h.CHM(e);const b=h.MAs(1);return M.onChange(M.formatData(b.value))}),h.qZA()}2&v&&(h.ekj("is-invalid",M.showError)("is-valid",M.valid&&M.touched),h.Q6J("mask","separator."+M.separator)("validation",!1)("allowNegativeNumbers",M.allowNegative)("ngModel",M._value)("disabled",M.disabled)("placeholder",M.placeholder)("ngClass",M.className))},directives:[i.hx,s.Fj,l.oH,s.JJ,s.On,F.mk],styles:[""]}),C})()},2178:(pe,oe,r)=>{r.d(oe,{v:()=>m});var o=r(5e3),h=r(9808),s=r(4834);function i(v,M){1&v&&o._UZ(0,"mat-divider",11)}const l=function(v,M){return{"active-step":v,"completed-step":M}},F=function(v){return{"active-label":v}};function g(v,M){if(1&v){const e=o.EpF();o.TgZ(0,"div",4)(1,"div",5)(2,"div",6),o.NdJ("click",function(){const A=o.CHM(e).$implicit;return o.oxw(2).onStepClicked(A.index)}),o.TgZ(3,"span",7),o._uU(4),o.qZA()(),o.TgZ(5,"div",8)(6,"span",9),o._uU(7),o.qZA()(),o.YNc(8,i,1,0,"mat-divider",10),o.qZA()()}if(2&v){const e=M.$implicit,c=M.index,b=o.oxw(2);o.xp6(2),o.Q6J("ngClass",o.WLB(5,l,b.currentStep==e.index,b.currentStep>e.index)),o.xp6(2),o.Oqu(e.index+1),o.xp6(2),o.Q6J("ngClass",o.VKq(8,F,b.currentStep==e.index)),o.xp6(1),o.Oqu(e.label),o.xp6(1),o.Q6J("ngIf",c<b.steps.length-1)}}function C(v,M){if(1&v&&(o.TgZ(0,"div",1)(1,"div",2),o.YNc(2,g,9,10,"div",3),o.qZA()()),2&v){const e=o.oxw();o.xp6(2),o.Q6J("ngForOf",e.steps)}}let m=(()=>{class v{constructor(){this.stepClicked=new o.vpe}ngOnInit(){if(this.steps.length<=1)throw new Error("Adicione pelo menos 2 steps aos stepper.")}onStepClicked(e){this.stepClicked.emit({clickedStep:e})}}return v.\u0275fac=function(e){return new(e||v)},v.\u0275cmp=o.Xpm({type:v,selectors:[["app-stepper"]],inputs:{steps:"steps",currentStep:"currentStep"},outputs:{stepClicked:"stepClicked"},decls:1,vars:1,consts:[["class","stepper",4,"ngIf"],[1,"stepper"],[1,"row"],["class","col step",4,"ngFor","ngForOf"],[1,"col","step"],[1,"d-none","d-md-flex","align-items-center","w-100"],[1,"step-circle",3,"ngClass","click"],[1,"step-number"],[1,"step-title","ml-2"],[3,"ngClass"],["class","align-self-center",4,"ngIf"],[1,"align-self-center"]],template:function(e,c){1&e&&o.YNc(0,C,3,1,"div",0),2&e&&o.Q6J("ngIf",c.steps.length>1)},directives:[h.O5,h.sg,h.mk,s.d],styles:[".stepper[_ngcontent-%COMP%]{padding-bottom:2.5rem;margin-left:14px}.stepper[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-wrap:nowrap}.stepper[_ngcontent-%COMP%]   .col[_ngcontent-%COMP%]{padding:0;max-width:300px}.step[_ngcontent-%COMP%]{height:80px;display:flex;align-items:center}.step-circle[_ngcontent-%COMP%]{min-height:50px;max-height:50px;min-width:50px;max-width:50px;border-radius:50%;background-color:#d8dbdf;border:2px solid #d8dbdf;display:flex;align-items:center;justify-content:center;cursor:pointer}.step-circle[_ngcontent-%COMP%]:hover{filter:brightness(.95)}.step-number[_ngcontent-%COMP%]{color:#fff;font-size:30px;font-weight:700}.step-title[_ngcontent-%COMP%]{color:#38455280;font-size:14px;font-weight:500}.step-title[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{white-space:nowrap}.active-step[_ngcontent-%COMP%]{transition:.6s;background-color:#2195f3;border:2px solid #2195f3}.completed-step[_ngcontent-%COMP%]{border:2px solid #7EB8E9}.mat-divider[_ngcontent-%COMP%]{height:3px;width:100%;min-width:20px;background-color:#b3b4b7;margin:0 10px}.active-label[_ngcontent-%COMP%]{color:#2195f3}@media screen and (max-height: 850px){.step[_ngcontent-%COMP%]{height:65px}}"]}),v})()},815:(pe,oe,r)=>{r.d(oe,{u:()=>m});var o=r(5e3),h=r(3075),s=r(727),i=r(4968),l=r(8372),F=r(9808);const g=["toggler"],C=function(v){return{checked:v}};let m=(()=>{class v{constructor(){this.externalId="",this._ID="",this._value=!1,this.onChange=()=>{},this.onTouched=()=>{},this.subscription=new s.w0}set id(e){this._ID=e,this.externalId=""}get id(){return this._ID}get value(){return this._value}set value(e){this._value=e,this.onChange(e),this.onTouched()}ngOnInit(){var e;this.subscription=(0,i.R)(null===(e=this.toggler)||void 0===e?void 0:e.nativeElement,"click").pipe((0,l.b)(250)).subscribe(c=>this.switch())}registerOnChange(e){this.onChange=e}writeValue(e){(!1===e||!0===e)&&(this.value=e)}registerOnTouched(e){this.onTouched=e}switch(){this.value=!this.value}ngOnDestroy(){this.subscription.unsubscribe()}}return v.\u0275fac=function(e){return new(e||v)},v.\u0275cmp=o.Xpm({type:v,selectors:[["toggler"]],viewQuery:function(e,c){if(1&e&&o.Gf(g,7),2&e){let b;o.iGM(b=o.CRH())&&(c.toggler=b.first)}},hostVars:1,hostBindings:function(e,c){2&e&&o.uIk("id",c.externalId)},inputs:{id:"id",_value:["value","_value"]},features:[o._Bn([{provide:h.JU,useExisting:(0,o.Gpc)(()=>v),multi:!0}])],decls:5,vars:6,consts:[[1,"switch",3,"ngClass"],["toggler",""],["type","checkbox",1,"switch-input",3,"value","id"],["data-on","SIM","data-off","N\xc3O",1,"switch-label"],[1,"switch-handle"]],template:function(e,c){1&e&&(o.TgZ(0,"div",0,1),o._UZ(2,"input",2)(3,"span",3)(4,"span",4),o.qZA()),2&e&&(o.Q6J("ngClass",o.VKq(4,C,c.value)),o.xp6(2),o.Q6J("value",c.value)("id",c.id),o.uIk("checked",c.value))},directives:[F.mk],styles:[".switch[_ngcontent-%COMP%]{position:relative;display:inline-block;vertical-align:top;width:88px;height:37px;padding:3px;background-color:none;cursor:pointer;overflow:visible;z-index:1;border:transparent}.switch[_ngcontent-%COMP%]:focus-within{outline:2px solid Highlight}.switch-input[_ngcontent-%COMP%]{position:absolute;top:0;left:0;opacity:0}.switch-label[_ngcontent-%COMP%]{position:relative;display:block;height:inherit;font-size:14px;font-weight:bolder;text-transform:uppercase;background:#ccc;transition:.15s ease-out;transition-property:opacity background;color:#2d2d2d;border-radius:20px}.switch-label[_ngcontent-%COMP%]:before, .switch-label[_ngcontent-%COMP%]:after{position:absolute;top:50%;margin-top:-.5em;line-height:1;transition:inherit}.switch-label[_ngcontent-%COMP%]:before{content:attr(data-off);right:11px;color:#384552}.switch-label[_ngcontent-%COMP%]:after{content:attr(data-on);left:11px;color:#fff;opacity:0}.switch-handle[_ngcontent-%COMP%]{position:absolute;top:7px;left:9px;width:29px;height:29px;background:#fff;border-radius:50%;transition:left .15s ease-out}.switch.checked[_ngcontent-%COMP%]{background-color:transparent}.checked[_ngcontent-%COMP%]   .switch-label[_ngcontent-%COMP%]{background:#4caf50;box-shadow:inset 0 1px 2px #ffffff80,inset 0 0 3px #00000026}.checked[_ngcontent-%COMP%]   .switch-label[_ngcontent-%COMP%]:before{opacity:0}.checked[_ngcontent-%COMP%]   .switch-label[_ngcontent-%COMP%]:after{opacity:1}.checked[_ngcontent-%COMP%]   .switch-handle[_ngcontent-%COMP%]{left:54px}@media screen and (max-height: 850px){.switch[_ngcontent-%COMP%]{width:85px;height:35px;padding:3px}.switch-handle[_ngcontent-%COMP%]{width:27px;height:27px}}"]}),v})()},1969:(pe,oe,r)=>{r.d(oe,{M:()=>X});var o=r(8966),h=r(1135),s=r(5698),i=r(8746),l=r(5e3),F=r(3047),g=r(1299),C=r(9808),m=r(9323),v=r(2485);function M(Y,D){if(1&Y&&l._UZ(0,"atb-historic",17),2&Y){const L=l.oxw(2);l.Q6J("events",L.historics)}}function e(Y,D){if(1&Y&&(l.ynx(0),l.YNc(1,M,1,1,"atb-historic",16),l.BQk()),2&Y){const L=l.oxw(),Q=l.MAs(18);l.xp6(1),l.Q6J("ngIf",null==L.historics?null:L.historics.length)("ngIfElse",Q)}}function c(Y,D){1&Y&&l._UZ(0,"atb-skeleton",18),2&Y&&l.Q6J("rows",3)}function b(Y,D){1&Y&&(l.TgZ(0,"span",19),l._uU(1,"Nenhum hist\xf3rico registrado."),l.qZA())}const A=function(Y){return{text:Y}},q=function(){return{text:"Hist\xf3rico"}},z=function(Y,D){return[Y,D]};let X=(()=>{class Y{constructor(L,Q,j,N){this.dialog=L,this.dialogRef=Q,this.data=j,this.quotationService=N,this.loading$=new h.X(!1)}ngOnInit(){this.loading$.next(!0),this.quotationService.proposalQuotationHistoric(this.data.id).pipe((0,s.q)(1),(0,i.x)(()=>this.loading$.next(!1))).subscribe(L=>this.historics=L)}}return Y.\u0275fac=function(L){return new(L||Y)(l.Y36(o.uw),l.Y36(o.so),l.Y36(o.WI),l.Y36(F.G))},Y.\u0275cmp=l.Xpm({type:Y,selectors:[["app-view-quotation-historic"]],decls:22,vars:14,consts:[[1,"wrapper","px-0"],[1,"container"],[1,"d-flex","flex-column"],[3,"isModal","items","closeModal"],[1,"card"],[1,"card-body","px-5","py-4"],[1,"historic-container"],[1,"text-gray-300","mb-4"],[1,"d-inline"],[1,"timeline-container","mt-4","card","p-2","py-md-4","pl-md-2","pr-md-4"],[1,"card-body"],[4,"ngIf","ngIfElse"],["loading",""],["emptyHistoric",""],[1,"d-flex","justify-content-end","mt-4"],[1,"btn","btn-outline-light-atb","btn-back",3,"click"],[3,"events",4,"ngIf","ngIfElse"],[3,"events"],["type","historic",3,"rows"],[1,"text-gray-300"]],template:function(L,Q){if(1&L&&(l.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-breadcrumb",3),l.NdJ("closeModal",function(){return Q.dialogRef.close()}),l.qZA(),l.TgZ(4,"div",4)(5,"div",5)(6,"div",6)(7,"h3",7),l._uU(8),l.TgZ(9,"h1",8),l._uU(10),l.qZA()()(),l.TgZ(11,"div",9)(12,"div",10),l.YNc(13,e,2,2,"ng-container",11),l.ALo(14,"async"),l.YNc(15,c,1,1,"ng-template",null,12,l.W1O),l.qZA(),l.YNc(17,b,2,0,"ng-template",null,13,l.W1O),l.qZA(),l.TgZ(19,"div",14)(20,"button",15),l.NdJ("click",function(){return Q.dialogRef.close()}),l._uU(21," Voltar "),l.qZA()()()()()()()),2&L){const j=l.MAs(16);l.xp6(3),l.Q6J("isModal",!0)("items",l.WLB(11,z,l.VKq(8,A,"Quotation"===Q.data.step?"Cota\xe7\xf5es criadas":"Propostas criadas"),l.DdM(10,q))),l.xp6(5),l.hij("Hist\xf3rico - ","Quotation"===Q.data.step?"Cota\xe7\xe3o":"Proposta"," "),l.xp6(2),l.Oqu(Q.data.number),l.xp6(3),l.Q6J("ngIf",!l.lcZ(14,6,Q.loading$))("ngIfElse",j)}},directives:[g.L,C.O5,m.g,v.a],pipes:[C.Ov],styles:[".mat-dialog-container{overflow:auto!important;padding:0}.wrapper[_ngcontent-%COMP%]{background-color:#f0f3f9;min-height:100vh;min-width:100vw;max-height:100vh;overflow-y:auto}  .cdk-overlay-pane{max-width:none!important}  .cdk-global-scrollblock{position:static;overflow:hidden!important}.container[_ngcontent-%COMP%]:first-child{padding:2rem 0}.historic-container[_ngcontent-%COMP%]{border-bottom:3px solid #dbeefd}.timeline-container[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{min-height:50vh;max-height:65vh;overflow:auto}.timeline-container[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}  .historic-timeline{display:block!important;width:85%;height:100%}  .historic-timeline .p-timeline-event-opposite{flex:none!important;padding:0!important;padding-right:1rem}  .historic-timeline .p-timeline-event-connector{width:3px!important;background-color:#0275d8!important}  .historic-timeline .p-timeline-event-content{margin-top:-5px!important;margin-bottom:1.5rem}.main-footer[_ngcontent-%COMP%]{border:1px solid #F7F7F7;box-shadow:0 -2px 5px #0000001a;background:white;padding:1.125rem 4.5rem 1.375rem}.spinner-loading-container[_ngcontent-%COMP%]{height:50vh}.input-loading.submit[_ngcontent-%COMP%]{font-size:1rem;right:10%;color:#fff!important;bottom:.5rem}@media (max-width: 768px){.main-footer[_ngcontent-%COMP%]{padding:1.125rem 21px 1.375rem}  .historic-timeline{width:100%!important}.btn-back[_ngcontent-%COMP%]{width:100%}}"]}),Y})()},6055:(pe,oe,r)=>{r.d(oe,{Y:()=>h});var o=r(5e3);let h=(()=>{class s{transform(l){return l<1?30*l:l.toFixed(0)}}return s.\u0275fac=function(l){return new(l||s)},s.\u0275pipe=o.Yjl({name:"periodDataPipe",type:s,pure:!0}),s})()},1042:(pe,oe,r)=>{r.d(oe,{Z:()=>e});var o,h=new Uint8Array(16);function s(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(h)}const i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,F=function l(c){return"string"==typeof c&&i.test(c)};for(var g=[],C=0;C<256;++C)g.push((C+256).toString(16).substr(1));const e=function M(c,b,A){var q=(c=c||{}).random||(c.rng||s)();if(q[6]=15&q[6]|64,q[8]=63&q[8]|128,b){A=A||0;for(var z=0;z<16;++z)b[A+z]=q[z];return b}return function m(c){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,A=(g[c[b+0]]+g[c[b+1]]+g[c[b+2]]+g[c[b+3]]+"-"+g[c[b+4]]+g[c[b+5]]+"-"+g[c[b+6]]+g[c[b+7]]+"-"+g[c[b+8]]+g[c[b+9]]+"-"+g[c[b+10]]+g[c[b+11]]+g[c[b+12]]+g[c[b+13]]+g[c[b+14]]+g[c[b+15]]).toLowerCase();if(!F(A))throw TypeError("Stringified UUID is invalid");return A}(q)}},2145:(pe,oe,r)=>{r.d(oe,{WN:()=>ee});var o=r(5e3),h=r(9808),s=r(1777),i=r(1424),l=r(845),F=r(5787),g=r(9783),C=r(5730),m=r(5921),v=r(3075),M=r(393);const e=["container"],c=["in"],b=["multiIn"],A=["multiContainer"],q=["ddBtn"],z=function(P,K){return{"p-autocomplete-dd-input":P,"p-disabled":K}};function X(P,K){if(1&P){const d=o.EpF();o.TgZ(0,"input",7,8),o.NdJ("click",function(O){return o.CHM(d),o.oxw().onInputClick(O)})("input",function(O){return o.CHM(d),o.oxw().onInput(O)})("keydown",function(O){return o.CHM(d),o.oxw().onKeydown(O)})("keyup",function(O){return o.CHM(d),o.oxw().onKeyup(O)})("focus",function(O){return o.CHM(d),o.oxw().onInputFocus(O)})("blur",function(O){return o.CHM(d),o.oxw().onInputBlur(O)})("change",function(O){return o.CHM(d),o.oxw().onInputChange(O)})("paste",function(O){return o.CHM(d),o.oxw().onInputPaste(O)}),o.qZA()}if(2&P){const d=o.oxw();o.Tol(d.inputStyleClass),o.Q6J("ngStyle",d.inputStyle)("autocomplete",d.autocomplete)("ngClass",o.WLB(20,z,d.dropdown,d.disabled))("value",d.inputFieldValue)("readonly",d.readonly)("disabled",d.disabled),o.uIk("type",d.type)("id",d.inputId)("required",d.required)("name",d.name)("autofocus",d.autofocus)("placeholder",d.placeholder)("size",d.size)("maxlength",d.maxlength)("tabindex",d.tabindex)("aria-label",d.ariaLabel)("aria-labelledby",d.ariaLabelledBy)("aria-required",d.required)}}function Y(P,K){1&P&&o.GkF(0)}function D(P,K){if(1&P&&(o.TgZ(0,"span",20),o._uU(1),o.qZA()),2&P){const d=o.oxw().$implicit,E=o.oxw(2);o.xp6(1),o.Oqu(E.resolveFieldData(d))}}function L(P,K){if(1&P){const d=o.EpF();o.TgZ(0,"span",21),o.NdJ("click",function(){o.CHM(d),o.oxw();const O=o.MAs(1);return o.oxw(2).removeItem(O)}),o.qZA()}}const Q=function(P){return{$implicit:P}};function j(P,K){if(1&P&&(o.TgZ(0,"li",15,16),o.YNc(2,Y,1,0,"ng-container",17),o.YNc(3,D,2,1,"span",18),o.YNc(4,L,1,0,"span",19),o.qZA()),2&P){const d=K.$implicit,E=o.oxw(2);o.xp6(2),o.Q6J("ngTemplateOutlet",E.selectedItemTemplate)("ngTemplateOutletContext",o.VKq(4,Q,d)),o.xp6(1),o.Q6J("ngIf",!E.selectedItemTemplate),o.xp6(1),o.Q6J("ngIf",!E.disabled&&!E.readonly)}}const N=function(P,K){return{"p-disabled":P,"p-focus":K}};function V(P,K){if(1&P){const d=o.EpF();o.TgZ(0,"ul",9,10),o.NdJ("click",function(){return o.CHM(d),o.MAs(5).focus()}),o.YNc(2,j,5,6,"li",11),o.TgZ(3,"li",12)(4,"input",13,14),o.NdJ("input",function(O){return o.CHM(d),o.oxw().onInput(O)})("click",function(O){return o.CHM(d),o.oxw().onInputClick(O)})("keydown",function(O){return o.CHM(d),o.oxw().onKeydown(O)})("keyup",function(O){return o.CHM(d),o.oxw().onKeyup(O)})("focus",function(O){return o.CHM(d),o.oxw().onInputFocus(O)})("blur",function(O){return o.CHM(d),o.oxw().onInputBlur(O)})("change",function(O){return o.CHM(d),o.oxw().onInputChange(O)})("paste",function(O){return o.CHM(d),o.oxw().onInputPaste(O)}),o.qZA()()()}if(2&P){const d=o.oxw();o.Q6J("ngClass",o.WLB(20,N,d.disabled,d.focus)),o.xp6(2),o.Q6J("ngForOf",d.value),o.xp6(2),o.Tol(d.inputStyleClass),o.Q6J("disabled",d.disabled)("readonly",d.readonly)("autocomplete",d.autocomplete)("ngStyle",d.inputStyle),o.uIk("type",d.type)("id",d.inputId)("placeholder",d.value&&d.value.length?null:d.placeholder)("tabindex",d.tabindex)("maxlength",d.maxlength)("autofocus",d.autofocus)("aria-label",d.ariaLabel)("aria-labelledby",d.ariaLabelledBy)("aria-required",d.required)("aria-controls",d.listId)("aria-expanded",d.overlayVisible)("aria-activedescendant","p-highlighted-option")}}function y(P,K){1&P&&o._UZ(0,"i",22)}function S(P,K){if(1&P){const d=o.EpF();o.TgZ(0,"button",23,24),o.NdJ("click",function(O){return o.CHM(d),o.oxw().handleDropdownClick(O)}),o.qZA()}if(2&P){const d=o.oxw();o.Q6J("icon",d.dropdownIcon)("disabled",d.disabled),o.uIk("aria-label",d.dropdownAriaLabel)("tabindex",d.tabindex)}}function U(P,K){1&P&&o.GkF(0)}function R(P,K){if(1&P&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&P){const d=o.oxw().$implicit,E=o.oxw(3);o.xp6(1),o.Oqu(E.getOptionGroupLabel(d)||"empty")}}function le(P,K){1&P&&o.GkF(0)}function ne(P,K){1&P&&o.GkF(0)}function de(P,K){if(1&P&&(o.TgZ(0,"li",32),o.YNc(1,R,2,1,"span",29),o.YNc(2,le,1,0,"ng-container",17),o.qZA(),o.YNc(3,ne,1,0,"ng-container",17)),2&P){const d=K.$implicit;o.oxw(2);const E=o.MAs(7),O=o.oxw();o.xp6(1),o.Q6J("ngIf",!O.groupTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",O.groupTemplate)("ngTemplateOutletContext",o.VKq(5,Q,d)),o.xp6(1),o.Q6J("ngTemplateOutlet",E)("ngTemplateOutletContext",o.VKq(7,Q,O.getOptionGroupChildren(d)))}}function fe(P,K){if(1&P&&(o.ynx(0),o.YNc(1,de,4,9,"ng-template",31),o.BQk()),2&P){const d=o.oxw(2);o.xp6(1),o.Q6J("ngForOf",d.suggestions)}}function he(P,K){1&P&&o.GkF(0)}function ue(P,K){if(1&P&&(o.ynx(0),o.YNc(1,he,1,0,"ng-container",17),o.BQk()),2&P){o.oxw();const d=o.MAs(7),E=o.oxw();o.xp6(1),o.Q6J("ngTemplateOutlet",d)("ngTemplateOutletContext",o.VKq(2,Q,E.suggestions))}}function ye(P,K){if(1&P&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&P){const d=o.oxw().$implicit,E=o.oxw(4);o.xp6(1),o.Oqu(E.resolveFieldData(d))}}function Me(P,K){1&P&&o.GkF(0)}const Pe=function(P){return{"p-highlight":P}},B=function(P,K){return{$implicit:P,index:K}};function J(P,K){if(1&P){const d=o.EpF();o.TgZ(0,"li",37),o.NdJ("click",function(){const te=o.CHM(d).$implicit;return o.oxw(4).selectItem(te)}),o.YNc(1,ye,2,1,"span",29),o.YNc(2,Me,1,0,"ng-container",17),o.qZA()}if(2&P){const d=K.$implicit,E=K.index,O=o.oxw(4);o.Q6J("ngClass",o.VKq(5,Pe,d===O.highlightOption))("id",O.highlightOption==d?"p-highlighted-option":""),o.xp6(1),o.Q6J("ngIf",!O.itemTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",O.itemTemplate)("ngTemplateOutletContext",o.WLB(7,B,d,E))}}function x(P,K){if(1&P&&(o.ynx(0),o.YNc(1,J,3,10,"li",36),o.BQk()),2&P){const d=o.oxw().$implicit;o.xp6(1),o.Q6J("ngForOf",d)}}function _(P,K){if(1&P&&(o.TgZ(0,"span"),o._uU(1),o.qZA()),2&P){const d=o.oxw().$implicit,E=o.oxw(5);o.xp6(1),o.Oqu(E.resolveFieldData(d))}}function I(P,K){1&P&&o.GkF(0)}const H=function(P){return{height:P}};function re(P,K){if(1&P){const d=o.EpF();o.ynx(0),o.TgZ(1,"li",41),o.NdJ("click",function(){const te=o.CHM(d).$implicit;return o.oxw(5).selectItem(te)}),o.YNc(2,_,2,1,"span",29),o.YNc(3,I,1,0,"ng-container",17),o.qZA(),o.BQk()}if(2&P){const d=K.$implicit,E=K.index,O=o.oxw(5);o.xp6(1),o.Q6J("ngClass",o.VKq(6,Pe,d===O.highlightOption))("ngStyle",o.VKq(8,H,O.itemSize+"px"))("id",O.highlightOption==d?"p-highlighted-option":""),o.xp6(1),o.Q6J("ngIf",!O.itemTemplate),o.xp6(1),o.Q6J("ngTemplateOutlet",O.itemTemplate)("ngTemplateOutletContext",o.WLB(10,B,d,E))}}function ge(P,K){if(1&P&&(o.TgZ(0,"cdk-virtual-scroll-viewport",39),o.YNc(1,re,4,13,"ng-container",40),o.qZA()),2&P){const d=o.oxw(2).$implicit,E=o.oxw(2);o.Q6J("ngStyle",o.VKq(3,H,E.scrollHeight))("itemSize",E.itemSize),o.xp6(1),o.Q6J("cdkVirtualForOf",d)}}function me(P,K){if(1&P&&o.YNc(0,ge,2,5,"cdk-virtual-scroll-viewport",38),2&P){const d=o.oxw(3);o.Q6J("ngIf",d.virtualScroll&&!d.noResults)}}function Te(P,K){if(1&P&&(o.ynx(0),o._uU(1),o.BQk()),2&P){const d=o.oxw(4);o.xp6(1),o.hij(" ",d.emptyMessageLabel," ")}}function Ee(P,K){1&P&&o.GkF(0,null,43)}function Ie(P,K){if(1&P&&(o.TgZ(0,"li",42),o.YNc(1,Te,2,1,"ng-container",33),o.YNc(2,Ee,2,0,"ng-container",27),o.qZA()),2&P){const d=o.oxw(3);o.xp6(1),o.Q6J("ngIf",!d.emptyTemplate)("ngIfElse",d.empty),o.xp6(1),o.Q6J("ngTemplateOutlet",d.emptyTemplate)}}function Oe(P,K){if(1&P&&(o.YNc(0,x,2,1,"ng-container",33),o.YNc(1,me,1,1,"ng-template",null,34,o.W1O),o.YNc(3,Ie,3,3,"li",35)),2&P){const d=o.MAs(2),E=o.oxw(2);o.Q6J("ngIf",!E.virtualScroll)("ngIfElse",d),o.xp6(3),o.Q6J("ngIf",E.noResults&&E.showEmptyMessage)}}function we(P,K){1&P&&o.GkF(0)}const Ze=function(){return["p-autocomplete-panel p-component"]},qe=function(P,K){return{showTransitionParams:P,hideTransitionParams:K}},De=function(P){return{value:"visible",params:P}},Se=function(P){return{"p-autocomplete-virtualscroll":P}};function Fe(P,K){if(1&P){const d=o.EpF();o.TgZ(0,"div",25,26),o.NdJ("click",function(O){return o.CHM(d),o.oxw().onOverlayClick(O)})("@overlayAnimation.start",function(O){return o.CHM(d),o.oxw().onOverlayAnimationStart(O)})("@overlayAnimation.done",function(O){return o.CHM(d),o.oxw().onOverlayAnimationEnd(O)}),o.YNc(2,U,1,0,"ng-container",27),o.TgZ(3,"ul",28),o.YNc(4,fe,2,1,"ng-container",29),o.YNc(5,ue,2,4,"ng-container",29),o.YNc(6,Oe,4,3,"ng-template",null,30,o.W1O),o.qZA(),o.YNc(8,we,1,0,"ng-container",27),o.qZA()}if(2&P){const d=o.oxw();o.Tol(d.panelStyleClass),o.Udp("max-height",d.virtualScroll?"auto":d.scrollHeight),o.Q6J("ngClass",o.DdM(13,Ze))("ngStyle",d.panelStyle)("@overlayAnimation",o.VKq(17,De,o.WLB(14,qe,d.showTransitionOptions,d.hideTransitionOptions))),o.xp6(2),o.Q6J("ngTemplateOutlet",d.headerTemplate),o.xp6(1),o.Q6J("ngClass",o.VKq(19,Se,d.virtualScroll)),o.uIk("id",d.listId),o.xp6(1),o.Q6J("ngIf",d.group),o.xp6(1),o.Q6J("ngIf",!d.group),o.xp6(3),o.Q6J("ngTemplateOutlet",d.footerTemplate)}}const k=function(P,K){return{"p-autocomplete p-component":!0,"p-autocomplete-dd":P,"p-autocomplete-multiple":K}},ae={provide:v.JU,useExisting:(0,o.Gpc)(()=>T),multi:!0};let T=(()=>{class P{constructor(d,E,O,te,_e,ke){this.el=d,this.renderer=E,this.cd=O,this.differs=te,this.config=_e,this.overlayService=ke,this.minLength=1,this.delay=300,this.type="text",this.autoZIndex=!0,this.baseZIndex=0,this.dropdownIcon="pi pi-chevron-down",this.unique=!0,this.completeOnFocus=!1,this.completeMethod=new o.vpe,this.onSelect=new o.vpe,this.onUnselect=new o.vpe,this.onFocus=new o.vpe,this.onBlur=new o.vpe,this.onDropdownClick=new o.vpe,this.onClear=new o.vpe,this.onKeyUp=new o.vpe,this.onShow=new o.vpe,this.onHide=new o.vpe,this.scrollHeight="200px",this.dropdownMode="blank",this.showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)",this.hideTransitionOptions=".1s linear",this.autocomplete="off",this.onModelChange=()=>{},this.onModelTouched=()=>{},this.overlayVisible=!1,this.focus=!1,this.inputFieldValue=null,this.differ=te.find([]).create(null),this.listId=(0,m.Th)()+"_list"}get suggestions(){return this._suggestions}set suggestions(d){this._suggestions=d,this.handleSuggestionsChange()}ngAfterViewChecked(){this.suggestionsUpdated&&this.overlay&&this.overlay.offsetParent&&(setTimeout(()=>{this.overlay&&this.alignOverlay()},1),this.suggestionsUpdated=!1),this.highlightOptionChanged&&(setTimeout(()=>{if(this.overlay&&this.itemsWrapper){let d=C.p.findSingle(this.overlay,"li.p-highlight");if(d&&C.p.scrollInView(this.itemsWrapper,d),this.virtualScroll&&this.viewPort){let E=this.viewPort.getRenderedRange();this.updateVirtualScrollSelectedIndex(),(E.start>this.virtualScrollSelectedIndex||E.end<this.virtualScrollSelectedIndex)&&this.viewPort.scrollToIndex(this.virtualScrollSelectedIndex)}}},1),this.highlightOptionChanged=!1)}handleSuggestionsChange(){null!=this._suggestions&&this.loading&&(this.highlightOption=null,this._suggestions.length?(this.noResults=!1,this.show(),this.suggestionsUpdated=!0,this.autoHighlight&&(this.highlightOption=this._suggestions[0])):(this.noResults=!0,this.showEmptyMessage?(this.show(),this.suggestionsUpdated=!0):this.hide()),this.loading=!1)}ngAfterContentInit(){this.templates.forEach(d=>{switch(d.getType()){case"item":default:this.itemTemplate=d.template;break;case"group":this.groupTemplate=d.template;break;case"selectedItem":this.selectedItemTemplate=d.template;break;case"header":this.headerTemplate=d.template;break;case"empty":this.emptyTemplate=d.template;break;case"footer":this.footerTemplate=d.template}})}updateVirtualScrollSelectedIndex(){this.highlightOption&&this.suggestions&&this.suggestions.length&&(this.virtualScrollSelectedIndex=this.findOptionIndex(this.highlightOption,this.suggestions))}writeValue(d){this.value=d,this.filled=this.value&&""!=this.value,this.updateInputField(),this.cd.markForCheck()}getOptionGroupChildren(d){return this.optionGroupChildren?m.gb.resolveFieldData(d,this.optionGroupChildren):d.items}getOptionGroupLabel(d){return this.optionGroupLabel?m.gb.resolveFieldData(d,this.optionGroupLabel):null!=d.label?d.label:d}registerOnChange(d){this.onModelChange=d}registerOnTouched(d){this.onModelTouched=d}setDisabledState(d){this.disabled=d,this.cd.markForCheck()}onInput(d){if(!this.inputKeyDown&&C.p.isIE())return;this.timeout&&clearTimeout(this.timeout);let E=d.target.value;!this.multiple&&!this.forceSelection&&this.onModelChange(E),0===E.length&&!this.multiple&&(this.hide(),this.onClear.emit(d),this.onModelChange(E)),E.length>=this.minLength?this.timeout=setTimeout(()=>{this.search(d,E)},this.delay):this.hide(),this.updateFilledState(),this.inputKeyDown=!1}onInputClick(d){this.documentClickListener&&(this.inputClick=!0)}search(d,E){null!=E&&(this.loading=!0,this.completeMethod.emit({originalEvent:d,query:E}))}selectItem(d,E=!0){this.forceSelectionUpdateModelTimeout&&(clearTimeout(this.forceSelectionUpdateModelTimeout),this.forceSelectionUpdateModelTimeout=null),this.multiple?(this.multiInputEL.nativeElement.value="",this.value=this.value||[],(!this.isSelected(d)||!this.unique)&&(this.value=[...this.value,d],this.onModelChange(this.value))):(this.inputEL.nativeElement.value=this.resolveFieldData(d),this.value=d,this.onModelChange(this.value)),this.onSelect.emit(d),this.updateFilledState(),E&&(this.itemClicked=!0,this.focusInput())}show(){if(this.multiInputEL||this.inputEL){let d=this.multiple?this.multiInputEL.nativeElement.ownerDocument.activeElement==this.multiInputEL.nativeElement:this.inputEL.nativeElement.ownerDocument.activeElement==this.inputEL.nativeElement;!this.overlayVisible&&d&&(this.overlayVisible=!0)}}onOverlayAnimationStart(d){switch(d.toState){case"visible":this.overlay=d.element,this.itemsWrapper=this.virtualScroll?C.p.findSingle(this.overlay,".cdk-virtual-scroll-viewport"):this.overlay,this.appendOverlay(),this.autoZIndex&&m.P9.set("overlay",this.overlay,this.baseZIndex+this.config.zIndex.overlay),this.alignOverlay(),this.bindDocumentClickListener(),this.bindDocumentResizeListener(),this.bindScrollListener(),this.onShow.emit(d);break;case"void":this.onOverlayHide()}}onOverlayAnimationEnd(d){"void"===d.toState&&this.autoZIndex&&m.P9.clear(d.element)}onOverlayClick(d){this.overlayService.add({originalEvent:d,target:this.el.nativeElement})}appendOverlay(){this.appendTo&&("body"===this.appendTo?document.body.appendChild(this.overlay):C.p.appendChild(this.overlay,this.appendTo),this.overlay.style.minWidth||(this.overlay.style.minWidth=C.p.getWidth(this.el.nativeElement.children[0])+"px"))}resolveFieldData(d){let E=this.field?m.gb.resolveFieldData(d,this.field):d;return void 0!==E?E:""}restoreOverlayAppend(){this.overlay&&this.appendTo&&this.el.nativeElement.appendChild(this.overlay)}alignOverlay(){this.appendTo?C.p.absolutePosition(this.overlay,this.multiple?this.multiContainerEL.nativeElement:this.inputEL.nativeElement):C.p.relativePosition(this.overlay,this.multiple?this.multiContainerEL.nativeElement:this.inputEL.nativeElement)}hide(){this.overlayVisible=!1,this.cd.markForCheck()}handleDropdownClick(d){if(this.overlayVisible)this.hide();else{this.focusInput();let E=this.multiple?this.multiInputEL.nativeElement.value:this.inputEL.nativeElement.value;"blank"===this.dropdownMode?this.search(d,""):"current"===this.dropdownMode&&this.search(d,E),this.onDropdownClick.emit({originalEvent:d,query:E})}}focusInput(){this.multiple?this.multiInputEL.nativeElement.focus():this.inputEL.nativeElement.focus()}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(g.ws.EMPTY_MESSAGE)}removeItem(d){let E=C.p.index(d),O=this.value[E];this.value=this.value.filter((te,_e)=>_e!=E),this.onModelChange(this.value),this.updateFilledState(),this.onUnselect.emit(O)}onKeydown(d){if(this.overlayVisible)switch(d.which){case 40:if(this.group){let O=this.findOptionGroupIndex(this.highlightOption,this.suggestions);if(-1!==O){let te=O.itemIndex+1;te<this.getOptionGroupChildren(this.suggestions[O.groupIndex]).length?(this.highlightOption=this.getOptionGroupChildren(this.suggestions[O.groupIndex])[te],this.highlightOptionChanged=!0):this.suggestions[O.groupIndex+1]&&(this.highlightOption=this.getOptionGroupChildren(this.suggestions[O.groupIndex+1])[0],this.highlightOptionChanged=!0)}else this.highlightOption=this.getOptionGroupChildren(this.suggestions[0])[0]}else{let O=this.findOptionIndex(this.highlightOption,this.suggestions);if(-1!=O){var E=O+1;E!=this.suggestions.length&&(this.highlightOption=this.suggestions[E],this.highlightOptionChanged=!0)}else this.highlightOption=this.suggestions[0]}d.preventDefault();break;case 38:if(this.group){let O=this.findOptionGroupIndex(this.highlightOption,this.suggestions);if(-1!==O){let te=O.itemIndex-1;if(te>=0)this.highlightOption=this.getOptionGroupChildren(this.suggestions[O.groupIndex])[te],this.highlightOptionChanged=!0;else if(te<0){let _e=this.suggestions[O.groupIndex-1];_e&&(this.highlightOption=this.getOptionGroupChildren(_e)[this.getOptionGroupChildren(_e).length-1],this.highlightOptionChanged=!0)}}}else{let O=this.findOptionIndex(this.highlightOption,this.suggestions);O>0&&(this.highlightOption=this.suggestions[O-1],this.highlightOptionChanged=!0)}d.preventDefault();break;case 13:this.highlightOption&&(this.selectItem(this.highlightOption),this.hide()),d.preventDefault();break;case 27:this.hide(),d.preventDefault();break;case 9:this.highlightOption&&this.selectItem(this.highlightOption),this.hide()}else 40===d.which&&this.suggestions&&this.search(d,d.target.value);if(this.multiple&&8===d.which&&this.value&&this.value.length&&!this.multiInputEL.nativeElement.value){this.value=[...this.value];const O=this.value.pop();this.onModelChange(this.value),this.updateFilledState(),this.onUnselect.emit(O)}this.inputKeyDown=!0}onKeyup(d){this.onKeyUp.emit(d)}onInputFocus(d){!this.itemClicked&&this.completeOnFocus&&this.search(d,this.multiple?this.multiInputEL.nativeElement.value:this.inputEL.nativeElement.value),this.focus=!0,this.onFocus.emit(d),this.itemClicked=!1}onInputBlur(d){this.focus=!1,this.onModelTouched(),this.onBlur.emit(d)}onInputChange(d){if(this.forceSelection){let E=!1,O=d.target.value.trim();if(this.suggestions)for(let te of this.suggestions){let _e=this.field?m.gb.resolveFieldData(te,this.field):te;if(_e&&O===_e.trim()){E=!0,this.forceSelectionUpdateModelTimeout=setTimeout(()=>{this.selectItem(te,!1)},250);break}}E||(this.multiple?this.multiInputEL.nativeElement.value="":(this.value=null,this.inputEL.nativeElement.value=""),this.onClear.emit(d),this.onModelChange(this.value),this.updateFilledState())}}onInputPaste(d){this.onKeydown(d)}isSelected(d){let E=!1;if(this.value&&this.value.length)for(let O=0;O<this.value.length;O++)if(m.gb.equals(this.value[O],d,this.dataKey)){E=!0;break}return E}findOptionIndex(d,E){let O=-1;if(E)for(let te=0;te<E.length;te++)if(m.gb.equals(d,E[te])){O=te;break}return O}findOptionGroupIndex(d,E){let O,te;if(E)for(let _e=0;_e<E.length&&(O=_e,te=this.findOptionIndex(d,this.getOptionGroupChildren(E[_e])),-1===te);_e++);return-1!==te?{groupIndex:O,itemIndex:te}:-1}updateFilledState(){this.filled=this.multiple?this.value&&this.value.length||this.multiInputEL&&this.multiInputEL.nativeElement&&""!=this.multiInputEL.nativeElement.value:this.inputFieldValue&&""!=this.inputFieldValue||this.inputEL&&this.inputEL.nativeElement&&""!=this.inputEL.nativeElement.value}updateInputField(){let d=this.resolveFieldData(this.value);this.inputFieldValue=d,this.inputEL&&this.inputEL.nativeElement&&(this.inputEL.nativeElement.value=d),this.updateFilledState()}bindDocumentClickListener(){this.documentClickListener||(this.documentClickListener=this.renderer.listen(this.el?this.el.nativeElement.ownerDocument:"document","click",E=>{3!==E.which&&(!this.inputClick&&!this.isDropdownClick(E)&&this.hide(),this.inputClick=!1,this.cd.markForCheck())}))}isDropdownClick(d){if(this.dropdown){let E=d.target;return E===this.dropdownButton.nativeElement||E.parentNode===this.dropdownButton.nativeElement}return!1}unbindDocumentClickListener(){this.documentClickListener&&(this.documentClickListener(),this.documentClickListener=null)}bindDocumentResizeListener(){this.documentResizeListener=this.onWindowResize.bind(this),window.addEventListener("resize",this.documentResizeListener)}unbindDocumentResizeListener(){this.documentResizeListener&&(window.removeEventListener("resize",this.documentResizeListener),this.documentResizeListener=null)}onWindowResize(){this.hide()}bindScrollListener(){this.scrollHandler||(this.scrollHandler=new C.V(this.containerEL.nativeElement,()=>{this.overlayVisible&&this.hide()})),this.scrollHandler.bindScrollListener()}unbindScrollListener(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()}onOverlayHide(){this.unbindDocumentClickListener(),this.unbindDocumentResizeListener(),this.unbindScrollListener(),this.overlay=null,this.onHide.emit()}ngOnDestroy(){this.forceSelectionUpdateModelTimeout&&(clearTimeout(this.forceSelectionUpdateModelTimeout),this.forceSelectionUpdateModelTimeout=null),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&m.P9.clear(this.overlay),this.restoreOverlayAppend(),this.onOverlayHide()}}return P.\u0275fac=function(d){return new(d||P)(o.Y36(o.SBq),o.Y36(o.Qsj),o.Y36(o.sBO),o.Y36(o.ZZ4),o.Y36(g.b4),o.Y36(g.F0))},P.\u0275cmp=o.Xpm({type:P,selectors:[["p-autoComplete"]],contentQueries:function(d,E,O){if(1&d&&o.Suo(O,g.jx,4),2&d){let te;o.iGM(te=o.CRH())&&(E.templates=te)}},viewQuery:function(d,E){if(1&d&&(o.Gf(e,5),o.Gf(c,5),o.Gf(b,5),o.Gf(A,5),o.Gf(q,5),o.Gf(M.N7,5)),2&d){let O;o.iGM(O=o.CRH())&&(E.containerEL=O.first),o.iGM(O=o.CRH())&&(E.inputEL=O.first),o.iGM(O=o.CRH())&&(E.multiInputEL=O.first),o.iGM(O=o.CRH())&&(E.multiContainerEL=O.first),o.iGM(O=o.CRH())&&(E.dropdownButton=O.first),o.iGM(O=o.CRH())&&(E.viewPort=O.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:4,hostBindings:function(d,E){2&d&&o.ekj("p-inputwrapper-filled",E.filled)("p-inputwrapper-focus",E.focus&&!E.disabled||E.overlayVisible)},inputs:{minLength:"minLength",delay:"delay",style:"style",panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",inputStyle:"inputStyle",inputId:"inputId",inputStyleClass:"inputStyleClass",placeholder:"placeholder",readonly:"readonly",disabled:"disabled",virtualScroll:"virtualScroll",itemSize:"itemSize",maxlength:"maxlength",name:"name",required:"required",size:"size",appendTo:"appendTo",autoHighlight:"autoHighlight",forceSelection:"forceSelection",type:"type",autoZIndex:"autoZIndex",baseZIndex:"baseZIndex",ariaLabel:"ariaLabel",dropdownAriaLabel:"dropdownAriaLabel",ariaLabelledBy:"ariaLabelledBy",dropdownIcon:"dropdownIcon",unique:"unique",group:"group",completeOnFocus:"completeOnFocus",field:"field",scrollHeight:"scrollHeight",dropdown:"dropdown",showEmptyMessage:"showEmptyMessage",dropdownMode:"dropdownMode",multiple:"multiple",tabindex:"tabindex",dataKey:"dataKey",emptyMessage:"emptyMessage",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",autofocus:"autofocus",autocomplete:"autocomplete",optionGroupChildren:"optionGroupChildren",optionGroupLabel:"optionGroupLabel",suggestions:"suggestions"},outputs:{completeMethod:"completeMethod",onSelect:"onSelect",onUnselect:"onUnselect",onFocus:"onFocus",onBlur:"onBlur",onDropdownClick:"onDropdownClick",onClear:"onClear",onKeyUp:"onKeyUp",onShow:"onShow",onHide:"onHide"},features:[o._Bn([ae])],decls:7,vars:12,consts:[[3,"ngClass","ngStyle"],["container",""],["class","p-autocomplete-input p-inputtext p-component","aria-autocomplete","list","role","searchbox",3,"ngStyle","class","autocomplete","ngClass","value","readonly","disabled","click","input","keydown","keyup","focus","blur","change","paste",4,"ngIf"],["class","p-autocomplete-multiple-container p-component p-inputtext",3,"ngClass","click",4,"ngIf"],["class","p-autocomplete-loader pi pi-spinner pi-spin",4,"ngIf"],["type","button","pButton","","class","p-autocomplete-dropdown","pRipple","",3,"icon","disabled","click",4,"ngIf"],[3,"ngClass","max-height","ngStyle","class","click",4,"ngIf"],["aria-autocomplete","list","role","searchbox",1,"p-autocomplete-input","p-inputtext","p-component",3,"ngStyle","autocomplete","ngClass","value","readonly","disabled","click","input","keydown","keyup","focus","blur","change","paste"],["in",""],[1,"p-autocomplete-multiple-container","p-component","p-inputtext",3,"ngClass","click"],["multiContainer",""],["class","p-autocomplete-token",4,"ngFor","ngForOf"],[1,"p-autocomplete-input-token"],["aria-autocomplete","list","role","searchbox","aria-haspopup","true",3,"disabled","readonly","autocomplete","ngStyle","input","click","keydown","keyup","focus","blur","change","paste"],["multiIn",""],[1,"p-autocomplete-token"],["token",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-autocomplete-token-label",4,"ngIf"],["class","p-autocomplete-token-icon pi pi-times-circle",3,"click",4,"ngIf"],[1,"p-autocomplete-token-label"],[1,"p-autocomplete-token-icon","pi","pi-times-circle",3,"click"],[1,"p-autocomplete-loader","pi","pi-spinner","pi-spin"],["type","button","pButton","","pRipple","",1,"p-autocomplete-dropdown",3,"icon","disabled","click"],["ddBtn",""],[3,"ngClass","ngStyle","click"],["panel",""],[4,"ngTemplateOutlet"],["role","listbox",1,"p-autocomplete-items",3,"ngClass"],[4,"ngIf"],["itemslist",""],["ngFor","",3,"ngForOf"],[1,"p-autocomplete-item-group"],[4,"ngIf","ngIfElse"],["virtualScrollList",""],["class","p-autocomplete-empty-message",4,"ngIf"],["role","option","class","p-autocomplete-item","pRipple","",3,"ngClass","id","click",4,"ngFor","ngForOf"],["role","option","pRipple","",1,"p-autocomplete-item",3,"ngClass","id","click"],[3,"ngStyle","itemSize",4,"ngIf"],[3,"ngStyle","itemSize"],[4,"cdkVirtualFor","cdkVirtualForOf"],["role","option","pRipple","",1,"p-autocomplete-item",3,"ngClass","ngStyle","id","click"],[1,"p-autocomplete-empty-message"],["empty",""]],template:function(d,E){1&d&&(o.TgZ(0,"span",0,1),o.YNc(2,X,2,23,"input",2),o.YNc(3,V,6,23,"ul",3),o.YNc(4,y,1,0,"i",4),o.YNc(5,S,2,4,"button",5),o.YNc(6,Fe,9,21,"div",6),o.qZA()),2&d&&(o.Tol(E.styleClass),o.Q6J("ngClass",o.WLB(9,k,E.dropdown,E.multiple))("ngStyle",E.style),o.xp6(2),o.Q6J("ngIf",!E.multiple),o.xp6(1),o.Q6J("ngIf",E.multiple),o.xp6(1),o.Q6J("ngIf",E.loading),o.xp6(1),o.Q6J("ngIf",E.dropdown),o.xp6(1),o.Q6J("ngIf",E.overlayVisible))},directives:[M.N7,h.mk,h.PC,h.O5,h.sg,h.tP,l.Hq,F.H,M.xd,M.x0],styles:[".p-autocomplete{display:inline-flex;position:relative}.p-autocomplete-loader{position:absolute;top:50%;margin-top:-.5rem}.p-autocomplete-dd .p-autocomplete-input{flex:1 1 auto;width:1%}.p-autocomplete-dd .p-autocomplete-input,.p-autocomplete-dd .p-autocomplete-multiple-container{border-top-right-radius:0;border-bottom-right-radius:0}.p-autocomplete-dd .p-autocomplete-dropdown{border-top-left-radius:0;border-bottom-left-radius:0}.p-autocomplete .p-autocomplete-panel{min-width:100%;top:0;left:0}.p-autocomplete-panel{position:absolute;overflow:auto}.p-autocomplete-items{margin:0;padding:0;list-style-type:none}.p-autocomplete-item{cursor:pointer;white-space:nowrap;position:relative;overflow:hidden}.p-autocomplete-multiple-container{margin:0;padding:0;list-style-type:none;cursor:text;overflow:hidden;display:flex;align-items:center;flex-wrap:wrap}.p-autocomplete-token{cursor:default;display:inline-flex;align-items:center;flex:0 0 auto}.p-autocomplete-token-icon{cursor:pointer}.p-autocomplete-input-token{flex:1 1 auto;display:inline-flex}.p-autocomplete-input-token input{border:0 none;outline:0 none;background-color:transparent;margin:0;padding:0;box-shadow:none;border-radius:0;width:100%}.p-fluid .p-autocomplete{display:flex}.p-fluid .p-autocomplete-dd .p-autocomplete-input{width:1%}\n"],encapsulation:2,data:{animation:[(0,s.X$)("overlayAnimation",[(0,s.eR)(":enter",[(0,s.oB)({opacity:0,transform:"scaleY(0.8)"}),(0,s.jt)("{{showTransitionParams}}")]),(0,s.eR)(":leave",[(0,s.jt)("{{hideTransitionParams}}",(0,s.oB)({opacity:0}))])])]},changeDetection:0}),P})(),ee=(()=>{class P{}return P.\u0275fac=function(d){return new(d||P)},P.\u0275mod=o.oAB({type:P}),P.\u0275inj=o.cJS({imports:[[h.ez,i.j,l.hJ,g.m8,F.T,M.Cl],g.m8,M.Cl]}),P})()}}]);