"use strict";(self.webpackChunkBemMais2=self.webpackChunkBemMais2||[]).push([[2042],{2042:(W,f,o)=>{o.r(f),o.d(f,{AuditModule:()=>X});var Z=o(7622),O=o(7022),d=o(9808);class C{static getTypeAuditory(s){switch(s){case"Authentication":return"Autentica\xe7\xe3o";case"CreateData":return"Cria\xe7\xe3o de dados";case"ViewData":return"Visualiza\xe7\xe3o de dados";case"UpdateData":return"Atualiza\xe7\xe3o de dados";case"RemoveData":return"Remo\xe7\xe3o de dados";default:return null}}}var m=o(1135),P=o(8306),h=o(8966),v=o(8746),t=o(5e3),c=o(2340),N=o(4351),g=o(4004),T=o(9646),D=o(4128),I=o(520);let b=(()=>{class i{constructor(e){this.http=e}getAll(e=0,n=10,a={}){return this.http.post(`${c.N.baseURL}/auditory/Auditory/${e}/${n}`,a)}getStatic(){return this.http.get(`${c.N.baseURL}/auditory/Auditory/static`)}getQueryItem(e){return this.getQueryItemByid(e).pipe((0,N.b)(n=>"00000000-0000-0000-0000-000000000000"==n.profileId?(0,T.of)(n):(0,D.D)({departmentName:this.getDepartmentById(n.departmentId),companyName:this.getCompanyById(n.companyId),roleName:this.getRole(n.roleId)}).pipe((0,g.U)(a=>(n.displayCompanyName=a.companyName,n.displayDepartmentName=a.departmentName,n.displayRoleName=a.roleName,n)))))}getQueryItemByid(e){return this.http.get(c.N.baseURL+`/auditory/Auditory/${e}`)}getRole(e){return this.http.get(`${c.N.baseURL}/administrative/roles/${e}`).pipe((0,g.U)(n=>n.displayName))}getCompanyById(e){return this.http.get(`${c.N.baseURL}/administrative/companies/${e}`).pipe((0,g.U)(n=>n.companyName))}getDepartmentById(e){return this.http.get(`${c.N.baseURL}/administrative/departments/${e}`).pipe((0,g.U)(n=>n.displayName))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(I.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var U=o(1299),A=o(6517);function $(i,s){1&i&&(t.TgZ(0,"div")(1,"div",7)(2,"div",8)(3,"span",9),t._uU(4,"Loading..."),t.qZA()()()())}function S(i,s){if(1&i){const e=t.EpF();t.TgZ(0,"div",10)(1,"div",11)(2,"h4"),t._uU(3,"Usu\xe1rio"),t.qZA(),t.TgZ(4,"div",12)(5,"div",13)(6,"div",14)(7,"label",15),t._uU(8,"Nome"),t.qZA(),t._UZ(9,"input",16),t.qZA(),t.TgZ(10,"div",17)(11,"label",15),t._uU(12,"Departamento"),t.qZA(),t._UZ(13,"input",16),t.qZA()(),t.TgZ(14,"div",13)(15,"div",17)(16,"label",15),t._uU(17,"Cargo"),t.qZA(),t._UZ(18,"input",16),t.qZA(),t.TgZ(19,"div",14)(20,"label",15),t._uU(21,"Companhia"),t.qZA(),t._UZ(22,"input",16),t.qZA()()()(),t.TgZ(23,"div",18)(24,"h4"),t._uU(25,"Detalhes"),t.qZA(),t.TgZ(26,"div",12)(27,"div",13)(28,"div",17)(29,"label",15),t._uU(30,"Servi\xe7o"),t.qZA(),t._UZ(31,"input",16),t.qZA(),t.TgZ(32,"div",17)(33,"label",15),t._uU(34,"Tipo"),t.qZA(),t._UZ(35,"input",16),t.qZA(),t.TgZ(36,"div",17)(37,"label",15),t._uU(38,"Data"),t.qZA(),t._UZ(39,"input",16),t.ALo(40,"date"),t.qZA()(),t.TgZ(41,"div",13)(42,"div",19)(43,"label",15),t._uU(44,"Mensagem"),t.qZA(),t._UZ(45,"input",16),t.qZA()(),t.TgZ(46,"div",13)(47,"div",19)(48,"label",15),t._uU(49,"Detalhes"),t.qZA(),t._UZ(50,"textarea",20),t.ALo(51,"json"),t.qZA()()()(),t.TgZ(52,"button",21),t.NdJ("click",function(){return t.CHM(e),t.oxw().dialogRef.close()}),t._uU(53,"Voltar"),t.qZA()()}if(2&i){const e=s.ngIf,n=t.oxw();t.xp6(9),t.Q6J("value","00000000-0000-0000-0000-000000000000"==e.profileId?"An\xf4nimo":e.displayName||null),t.xp6(4),t.Q6J("value",e.displayDepartmentName||null),t.xp6(5),t.Q6J("value",e.displayRoleName||null),t.xp6(4),t.Q6J("value",e.displayCompanyName||null),t.xp6(9),t.Q6J("value",e.serviceName+" / "+e.serviceVersion||null),t.xp6(4),t.Q6J("value",n.getTypeAuditory(e.type)||null),t.xp6(4),t.Q6J("value",t.xi3(40,9,e.sent,"dd/MMM/Y")||null),t.xp6(6),t.Q6J("value",e.message||null),t.xp6(5),t.Q6J("value",t.lcZ(51,12,e.details)||null)}}const J=function(){return{text:"Auditoria"}},_=function(){return{text:"Detalhe da auditoria"}},Q=function(i,s){return[i,s]};let j=(()=>{class i{constructor(e,n,a){this.dialogRef=e,this.itemId=n,this.auditService=a,this.spinnerSubject$=new m.X(null),this.details$=new P.y,this.spinner$=new m.X(!0)}ngOnInit(){this.details$=this.auditService.getQueryItem(this.itemId).pipe((0,v.x)(()=>this.spinner$.next(!1)))}getTypeAuditory(e){return C.getTypeAuditory(e)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.so),t.Y36(h.WI),t.Y36(b))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-audit-details-dialog"]],decls:10,vars:15,consts:[[1,"wrapper","px-0"],[1,"container"],[1,"d-flex","flex-column"],[3,"isModal","items","closeModal"],[1,"card"],[4,"ngIf"],["class","card-body",4,"ngIf"],[1,"d-flex","justify-content-center","w-100","align-items-center","spinner-container"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"],[1,"card-body"],[1,"mb-5"],[1,"card-content"],[1,"d-md-flex"],[1,"form-group","col-md-8"],["for","",1,"text-blue-300","subtitle-sm"],["disabled","","type","text",1,"form-control",3,"value"],[1,"form-group","col-md-4"],[1,"mb-3"],[1,"form-group","col-md-12"],["disabled","","name","","id","foo","rows","10",1,"form-control",3,"value"],[1,"btn","float-right","subtitle",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"app-breadcrumb",3),t.NdJ("closeModal",function(){return n.dialogRef.close()}),t.qZA(),t.TgZ(4,"div",4),t.YNc(5,$,5,0,"div",5),t.ALo(6,"async"),t.YNc(7,S,54,14,"div",6),t.ALo(8,"async"),t.ALo(9,"async"),t.qZA()()()()),2&e&&(t.xp6(3),t.Q6J("isModal",!0)("items",t.WLB(12,Q,t.DdM(10,J),t.DdM(11,_))),t.xp6(2),t.Q6J("ngIf",t.lcZ(6,4,n.spinner$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(8,6,n.details$)||!t.lcZ(9,8,n.spinner$)))},directives:[U.L,d.O5,A.HK,A.oH],pipes:[d.Ov,d.uU,d.Ts],styles:[".mat-dialog-container{overflow:auto!important;padding:0}.wrapper[_ngcontent-%COMP%]{background-color:#f0f3f9;min-height:100vh;min-width:100vw;max-height:100vh;overflow-y:auto}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child{padding:2rem 0}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .spinner-container[_ngcontent-%COMP%]{min-height:800px;position:absolute;background:white;z-index:4}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]{padding:32px 24px 24px 20px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:16px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{padding:24px 15px 15px;border:1px solid #e7e7e7;box-sizing:border-box;border-radius:6px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{color:#00000080}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{resize:none}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border:1px solid #cccccc;box-sizing:border-box;border-radius:4px;width:136px;height:40px}.wrapper[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:first-child   .card-body[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background:#ececec}.disabled[_ngcontent-%COMP%]{filter:opacity(30%)}"]}),i})();var p=o(4521);let B=(()=>{class i{constructor(e,n,a){this.dialog=e,this.router=n,this.route=a}ngOnInit(){this.itemId=this.route.snapshot.params.id,this.initDialog()}initDialog(e){this.dialogRef=this.dialog.open(j,{height:"100vh",width:"100vw",maxWidth:"none",data:this.itemId,disableClose:!0,closeOnNavigation:!0}).afterClosed().subscribe(n=>{this.router.navigate(["app/auditoria"])})}ngOnDestroy(){this.dialogRef.unsubscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h.uw),t.Y36(p.F0),t.Y36(p.gz))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-audit-details"]],decls:0,vars:0,template:function(e,n){},styles:[""]}),i})();var M=o(5698),R=o(6367),w=o(7579),Y=o(8080),L=o(2290),z=o(560),q=o(381),x=o(3075),F=o(5214);const E=[{path:"",component:(()=>{class i extends R.K{constructor(e,n,a,r,u,y,V){super(),this.navBarService=e,this.auditService=n,this.router=a,this.route=r,this.datePipe=u,this.toastr=y,this.queryBuilderController=V,this.items$=new m.X({}),this.spinnerSubject$=new m.X(!1),this.spinnerSubjectQuery$=new m.X(!1),this.page=new w.x,this.hasError=!1,this.queryCtrl={},this.queryItems={fields:{none:{name:"Nenhuma op\xe7\xe3o dispon\xedvel",type:"string"}}},this.emptyMessage="Nenhum dado encontrado",this.columns=[{displayName:"Nome",columnName:"displayName",hasInnerHtml:!0,cell:({displayName:l})=>`${l||"An\xf4nimo"}`},{displayName:"Data",columnName:"sent",dataType:"date",hasInnerHtml:!0,cell:({sent:l})=>this.convertDate(l,"dd/MMM/Y HH:mm:ss")},{displayName:"Servi\xe7o/Vers\xe3o",columnName:"serviceName",hasInnerHtml:!0,cell:l=>`${l.serviceName} ${l.serviceVersion}`},{displayName:"Tipo",columnName:"type",hasInnerHtml:!0,cell:({type:l})=>`${C.getTypeAuditory(l)}`},{displayName:"Mensagem",columnName:"message"}],this.actions=[{iconClass:"fas fa-chevron-right",eventName:"details",tooltip:"Detalhes da auditoria"}],this.navBarService.setContentTitle("Auditoria")}ngOnInit(){this.getItems(),this.getStaticItems()}getItems(e,n,a){this.auditService.getAll(e,n,a).pipe((0,M.q)(1),(0,v.x)(()=>this.spinnerSubject$.next(!1))).subscribe(r=>{this.items$.next(r)})}getStaticItems(){this.spinnerSubjectQuery$.next(!0),this.auditService.getStatic().pipe((0,M.q)(1),(0,v.x)(()=>this.spinnerSubjectQuery$.next(!1))).subscribe(e=>{this.queryItems=this.queryBuilderController.setQueryItems(e)})}setPage(e){this.page.next(e)}onAction(e){"details"===e.action&&this.router.navigate([e.element.id],{relativeTo:this.route})}onInputPaginator(e){this.submit()}submit(e=0,n=10,a=!1){var r;this.hasError=!1;let u=JSON.parse(JSON.stringify(this.queryCtrl));if(a||(this.paginator.pageIndex=0),!(null===(r=u.rules)||void 0===r?void 0:r.length))return this.getItems(e,n);try{return u.rules=this.queryBuilderController.setQueryCtrlToDatabase(u),this.spinnerSubject$.next(!0),this.getItems(e,n,u),u}catch(y){this.hasError=!0,this.spinnerSubject$.next(!1),console.error("error",y),this.toastr.error("Certifique se todos campos est\xe3o preenchidos!","Erro de valida\xe7\xe3o",{toastClass:"error-toast"})}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(Y.I),t.Y36(b),t.Y36(p.F0),t.Y36(p.gz),t.Y36(d.uU),t.Y36(L._W),t.Y36(z.n))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-audit"]],features:[t.qOj],decls:13,vars:15,consts:[[1,"wrapper","px-0","h-100","d-flex","flex-column"],[1,"card","p-4","my-4","h-100","d-flex","justify-content-between",2,"min-height","400px"],[1,"d-flex","flex-column"],[1,"text-gray-500","regular-txt","mb-4"],[3,"ngModel","config","hasError","spinner","ngModelChange"],[1,"action-buttons","mt-3","d-flex","justify-content-end"],["type","button",1,"btn","btn-lg","btn-success-atb",3,"click"],[1,"card","p-4","my-4","h-100","d-flex","justify-content-between",2,"min-height","320px"],["emptyClass","text-gray-300",3,"hasInputPaginator","dataSource","totalItems","emptyMessage","columns","actions","spinner","onPaginator","page","action","inputPaginator"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),t._uU(4,"Personalize os dados do seu relat\xf3rio"),t.qZA(),t.TgZ(5,"app-query-builder",4),t.NdJ("ngModelChange",function(r){return n.queryCtrl=r}),t.qZA()(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){return n.submit()}),t._uU(8,"Pesquisar"),t.qZA()()(),t.TgZ(9,"div",7)(10,"atb-table",8),t.NdJ("onPaginator",function(r){return n.paginator=r})("page",function(r){return n.submit(r.skip,r.take,!0)})("action",function(r){return n.onAction(r)})("inputPaginator",function(r){return n.submit(r.skip,r.take,!0)}),t.ALo(11,"async"),t.ALo(12,"async"),t.qZA()()()),2&e){let a,r;t.xp6(5),t.Q6J("ngModel",n.queryCtrl)("config",n.queryItems)("hasError",n.hasError)("spinner",n.spinnerSubjectQuery$),t.xp6(5),t.Q6J("hasInputPaginator",!0)("dataSource",null==(a=t.lcZ(11,11,n.items$))?null:a.items)("totalItems",null==(r=t.lcZ(12,13,n.items$))?null:r.total)("emptyMessage",n.emptyMessage)("columns",n.columns)("actions",n.actions)("spinner",n.spinnerSubject$)}},directives:[q._,x.JJ,x.On,F.a],pipes:[d.Ov],styles:["#directive-last{display:none!important}"]}),i})()},{path:":id",component:B,data:{title:"Detalhe da auditoria"}}];let H=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.Bz.forChild(E)],p.Bz]}),i})(),X=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[d.ez,H,O.h,Z.m]]}),i})()}}]);